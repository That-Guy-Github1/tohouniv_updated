th_set_default_danmaku_class = {
	set_global_flag = th_danmaku_class_default_$class$
}

th_set_default_danmaku_type = {
	set_global_flag = th_danmaku_creature_type_default_$type$
}

th_initialize_danmaku_definitions = {
	1 = {
		#Combat related stuff:
		# 1d4 roll on initiative
		set_variable = { which = th_danmaku_default_initiative_die_num			value = 1 }
		set_variable = { which = th_danmaku_default_initiative_die				value = 4 }
		# 1d20 hit dice
		set_variable = { which = th_danmaku_default_hit_die_num					value = 1 }
		set_variable = { which = th_danmaku_default_hit_die						value = 20 }
		# Crit damage factor, need to roll a 1d20
		set_variable = { which = th_danmaku_default_crit_damage_multiplier		value = 2 }
		set_variable = { which = th_danmaku_default_crit_die_num				value = 1 }
		set_variable = { which = th_danmaku_default_crit_die					value = 20 }
		# Amount of Actions points
		set_variable = { which = th_danmaku_default_max_action_points			value = 100 }
	
		#Rewards related stuff:
		# Gold
		set_variable = { which = th_danmaku_default_gold_gain_activated			value = 1 }		#Put to 0 to deactivate gold from winning danmaku duels
		set_variable = { which = th_danmaku_default_gold_reward_scale_active	value = 1 }		#Put to 0 to deactivate gold scaling with enemy levels
		set_variable = { which = th_danmaku_default_gold_reward_base 			value = 200 }	#How much gold you get on a base level
		set_variable = { which = th_danmaku_default_gold_reward_scale 			value = 100 }	#How much gold you get additionally per enemy level
		# Monarch Power
		set_variable = { which = th_danmaku_default_power_gain_activated		value = 1 }		#Put to 0 to deactivate monarch power from winning danmaku duels
		set_variable = { which = th_danmaku_default_power_reward_scale_active	value = 1 }		#Put to 0 to deactivate monarch power scaling with enemy levels
		set_variable = { which = th_danmaku_default_power_type					value = 0 }		#What type of power you get, 0 = randomized, 
																								#1 = ADM power, 2 = DIP power, 3 = MIL power, 4 = ALL of them
		set_variable = { which = th_danmaku_default_power_reward_base 			value = 40 }	#How much monarch power you get on a base level
		set_variable = { which = th_danmaku_default_power_reward_scale 			value = 20 }	#How much monarch power you get additionally per enemy level

		#Additional setting:
		set_variable = { which = th_danmaku_default_setting_ruler_death 		value = 0 }		#Rulers can actualy die when their live drops below 0, set to 0 to deactivate

		#Setup related stuff:
		# Default class
		th_set_default_danmaku_class = { class = warrior }
		th_set_default_danmaku_type = { type = human }
		# Basic Stats
		set_variable = { which = th_danmaku_default_max_health					value = 100 }
		set_variable = { which = th_danmaku_default_max_mana					value = 20 }
		# Regen
		set_variable = { which = th_danmaku_default_hpy							value = 10 }	#Health points per year
		set_variable = { which = th_danmaku_default_mpy							value = 1 }		#Mana points per year
		# Initiative + Hit
		set_variable = { which = th_danmaku_default_ini_bonus					value = 0 }
		set_variable = { which = th_danmaku_default_hit_bonus					value = 0 }
		# Attack
		set_variable = { which = th_danmaku_default_attack_bonus				value = 0 }		#The flat attack damage bonus
		set_variable = { which = th_danmaku_default_attack_die					value = 10 }	#The die you roll for damage
		set_variable = { which = th_danmaku_default_attack_die_num				value = 1 }		#The amount of die you roll for damage
		set_variable = { which = th_danmaku_default_crit_roll_needed			value = 20 }	#Need to roll a 20 for a critical hit
		# Defense
		set_variable = { which = th_danmaku_default_armor_class					value = 10 }
		set_variable = { which = th_danmaku_default_resistance					value = 0 }		#Damage gets reduced by so much %
		# Reward modifier
		set_variable = { which = th_danmaku_default_gold_gain					value = 0 }
		set_variable = { which = th_danmaku_default_power_gain					value = 0 }
		# Levels
		set_variable = { which = th_danmaku_default_max_level					value = 20 }
		set_variable = { which = th_danmaku_default_start_level					value = 1 }
		set_variable = { which = th_danmaku_default_start_exp					value = 0 }
		set_variable = { which = th_danmaku_default_exp_increase				value = 50 }
		set_variable = { which = th_danmaku_default_level_1_exp 				value = 100 }
		# Skill Points
		set_variable = { which = th_danmaku_default_starting_skill_points		value = 0 }
		set_variable = { which = th_danmaku_default_skill_points_per_level		value = 1 }
		set_variable = { which = th_danmaku_default_skill_points_cost			value = 1 }

		#Variables for comparison sake, do not use them for math!!
		set_variable = { which = th_danmaku_armor_class				which = th_danmaku_default_armor_class }
		set_variable = { which = th_danmaku_crit_roll_needed		which = th_danmaku_default_crit_roll_needed }
		set_variable = { which = th_danmaku_crit_multi_show			which = th_danmaku_default_crit_damage_multiplier }
		multiply_variable = { which = th_danmaku_crit_multi_show 	value = 100 }
	}
}

th_update_danmaku_health_bar = {
	set_variable = { which = th_danmaku_health_var which = th_danmaku_health }
	divide_variable = { which = th_danmaku_health_var which = th_danmaku_max_health }
	multiply_variable = { which = th_danmaku_health_var value = 100 }
}
th_update_danmaku_mana_bar = {
	set_variable = { which = th_danmaku_mana_var which = th_danmaku_mana }
	divide_variable = { which = th_danmaku_mana_var which = th_danmaku_max_mana }
	multiply_variable = { which = th_danmaku_mana_var value = 100 }
}
th_update_danmaku_exp_bar = {
	set_variable = { which = th_danmaku_exp_var which = th_danmaku_current_exp }
	divide_variable = { which = th_danmaku_exp_var which = th_danmaku_exp_threshold }
	multiply_variable = { which = th_danmaku_exp_var value = 100 }
}
th_update_danmaku_action_point_bar = {
	set_variable = { which = th_danmaku_action_points_var which = th_danmaku_action_points }
	divide_variable = { which = th_danmaku_action_points_var which = th_danmaku_max_action_points }
	multiply_variable = { which = th_danmaku_action_points_var value = 100 }
}
th_update_gold_gain_modifier = {
	set_variable = {
		which = th_danmaku_gold_gain_show
		which = th_danmaku_gold_gain
	}
	multiply_variable = {
		which = th_danmaku_gold_gain_show
		value = 100
	}
}
th_update_power_gain_modifier = {
	set_variable = {
		which = th_danmaku_power_gain_show
		which = th_danmaku_power_gain
	}
	multiply_variable = {
		which = th_danmaku_power_gain_show
		value = 100
	}
}

th_set_default_danmaku_stats = {
	1 = {
		set_variable = { which = th_danmaku_default_max_health_transfer 		which = th_danmaku_default_max_health }
		set_variable = { which = th_danmaku_default_max_mana_transfer			which = th_danmaku_default_max_mana }
		set_variable = { which = th_danmaku_default_max_action_points_transfer	which = th_danmaku_default_max_action_points }
		set_variable = { which = th_danmaku_default_hpy_transfer				which = th_danmaku_default_hpy }
		set_variable = { which = th_danmaku_default_mpy_transfer				which = th_danmaku_default_mpy }
		set_variable = { which = th_danmaku_default_ini_bonus_transfer			which = th_danmaku_default_ini_bonus }
		set_variable = { which = th_danmaku_default_hit_bonus_transfer			which = th_danmaku_default_hit_bonus }
		set_variable = { which = th_danmaku_default_attack_bonus_transfer		which = th_danmaku_default_attack_bonus }
		set_variable = { which = th_danmaku_default_attack_die_transfer			which = th_danmaku_default_attack_die }
		set_variable = { which = th_danmaku_default_attack_die_num_transfer		which = th_danmaku_default_attack_die_num }
		set_variable = { which = th_danmaku_default_crit_roll_needed_transfer	which = th_danmaku_default_crit_roll_needed }
		set_variable = { which = th_danmaku_default_armor_class_transfer		which = th_danmaku_default_armor_class }
		set_variable = { which = th_danmaku_default_resistance_transfer			which = th_danmaku_default_resistance }
		set_variable = { which = th_danmaku_default_gold_gain_transfer			which = th_danmaku_default_gold_gain }
		set_variable = { which = th_danmaku_default_power_gain_transfer			which = th_danmaku_default_power_gain }
		set_variable = { which = th_danmaku_default_start_level_transfer		which = th_danmaku_default_start_level }
		set_variable = { which = th_danmaku_default_level_1_exp_transfer		which = th_danmaku_default_level_1_exp }
		set_variable = { which = th_danmaku_default_start_exp_transfer			which = th_danmaku_default_start_exp }
		set_variable = { which = th_danmaku_default_start_skills_transfer		which = th_danmaku_default_starting_skill_points }
		PREV = {
			set_variable = { which = th_danmaku_default_max_health_transfer 		which = PREV }
			set_variable = { which = th_danmaku_default_max_mana_transfer			which = PREV }
			set_variable = { which = th_danmaku_default_max_action_points_transfer	which = PREV }
			set_variable = { which = th_danmaku_default_hpy_transfer				which = PREV }
			set_variable = { which = th_danmaku_default_mpy_transfer				which = PREV }
			set_variable = { which = th_danmaku_default_ini_bonus_transfer			which = PREV }
			set_variable = { which = th_danmaku_default_hit_bonus_transfer			which = PREV }
			set_variable = { which = th_danmaku_default_attack_bonus_transfer		which = PREV }
			set_variable = { which = th_danmaku_default_attack_die_transfer			which = PREV }
			set_variable = { which = th_danmaku_default_attack_die_num_transfer		which = PREV }
			set_variable = { which = th_danmaku_default_crit_roll_needed_transfer	which = PREV }
			set_variable = { which = th_danmaku_default_armor_class_transfer		which = PREV }
			set_variable = { which = th_danmaku_default_resistance_transfer			which = PREV }
			set_variable = { which = th_danmaku_default_gold_gain_transfer			which = PREV }
			set_variable = { which = th_danmaku_default_power_gain_transfer			which = PREV }
			set_variable = { which = th_danmaku_default_start_level_transfer		which = PREV }
			set_variable = { which = th_danmaku_default_level_1_exp_transfer		which = PREV }
			set_variable = { which = th_danmaku_default_start_exp_transfer			which = PREV }
			set_variable = { which = th_danmaku_default_start_skills_transfer		which = PREV }
			
			set_variable = { which = th_danmaku_max_health 					which = th_danmaku_default_max_health_transfer }
			set_variable = { which = th_danmaku_health 						which = th_danmaku_default_max_health_transfer }
			set_variable = { which = th_danmaku_max_mana					which = th_danmaku_default_max_mana_transfer }
			set_variable = { which = th_danmaku_mana						which = th_danmaku_default_max_mana_transfer }
			set_variable = { which = th_danmaku_max_action_points 			which = th_danmaku_default_max_action_points_transfer }
			set_variable = { which = th_danmaku_action_points 				which = th_danmaku_default_max_action_points_transfer }
			set_variable = { which = th_danmaku_hpy							which = th_danmaku_default_hpy_transfer }
			set_variable = { which = th_danmaku_mpy							which = th_danmaku_default_mpy_transfer }
			set_variable = { which = th_danmaku_ini_bonus					which = th_danmaku_default_ini_bonus_transfer }
			set_variable = { which = th_danmaku_hit_bonus					which = th_danmaku_default_hit_bonus_transfer }
			set_variable = { which = th_danmaku_attack_bonus				which = th_danmaku_default_attack_bonus_transfer }
			set_variable = { which = th_danmaku_attack_die					which = th_danmaku_default_attack_die_transfer }
			set_variable = { which = th_danmaku_attack_die_num				which = th_danmaku_default_attack_die_num_transfer }
			set_variable = { which = th_danmaku_crit_roll_needed			which = th_danmaku_default_crit_roll_needed_transfer }
			set_variable = { which = th_danmaku_armor_class					which = th_danmaku_default_armor_class_transfer }
			set_variable = { which = th_danmaku_resistance					which = th_danmaku_default_resistance_transfer }
			set_variable = { which = th_danmaku_gold_gain					which = th_danmaku_default_gold_gain_transfer }
			set_variable = { which = th_danmaku_power_gain					which = th_danmaku_default_power_gain_transfer }
			set_variable = { which = th_ruler_danmaku_level					which = th_danmaku_default_start_level_transfer }
			set_variable = { which = th_danmaku_exp_threshold				which = th_danmaku_default_level_1_exp_transfer }
			set_variable = { which = th_danmaku_current_exp					which = th_danmaku_default_start_exp_transfer }
			set_variable = { which = th_danmaku_available_skill_points		which = th_danmaku_default_start_skills_transfer }
		}
	}
	#Set all the show variables
	th_update_danmaku_health_bar = yes
	th_update_danmaku_mana_bar = yes
	th_update_danmaku_exp_bar = yes
	th_update_danmaku_action_point_bar = yes
	th_update_gold_gain_modifier = yes
	th_update_power_gain_modifier = yes
}

th_set_danmaku_creature_type_human = {}
th_set_danmaku_creature_type_fairy = {}
th_set_danmaku_creature_type_vampire = {}
th_set_danmaku_creature_type_god = {}
th_set_danmaku_creature_type_demigod = {}
th_set_danmaku_creature_type_immortal = {}
th_set_danmaku_creature_type_undead = {}
th_set_danmaku_creature_type_half_phantom = {}
th_set_danmaku_creature_type_half_youkai = {}
th_set_danmaku_creature_type_youkai = {}
th_set_danmaku_creature_type_yama = {}
th_set_danmaku_creature_type_hermit = {}
th_set_danmaku_creature_type_lunarian = {}
th_set_danmaku_creature_type_oni = {}
th_set_danmaku_creature_type_demon = {}
th_set_danmaku_creature_type_devil = {}
th_set_danmaku_creature_type_tengu = {}
th_set_danmaku_creature_type_kappa = {}
th_set_danmaku_creature_type_tsukumogami = {}
th_set_danmaku_creature_type_yamanba = {}
th_set_danmaku_creature_type_nue = {}
th_set_danmaku_creature_type_satori = {}
th_set_danmaku_creature_type_angel = {}
th_set_danmaku_creature_type_shinigami = {}
th_set_danmaku_creature_type_inchling = {}
th_set_danmaku_creature_type_doll = {}
th_set_danmaku_creature_type_robot = {}
th_set_danmaku_creature_type_celestial = {}
th_set_danmaku_creature_type = {
	hidden_effect = {
		set_ruler_flag = th_danmaku_creature_type_$type$
	}
	th_set_danmaku_creature_type_$type$ = yes
}

th_set_default_danmaku_creature_type = {
	trigger_switch = {
		on_trigger = has_global_flag
		th_danmaku_creature_type_default_human = { 			th_set_danmaku_creature_type = { type = human } }
		th_danmaku_creature_type_default_fairy = { 			th_set_danmaku_creature_type = { type = fairy } }
		th_danmaku_creature_type_default_vampire = { 		th_set_danmaku_creature_type = { type = vampire } }
		th_danmaku_creature_type_default_god = { 			th_set_danmaku_creature_type = { type = god } }
		th_danmaku_creature_type_default_demigod = { 		th_set_danmaku_creature_type = { type = demigod } }
		th_danmaku_creature_type_default_immortal = { 		th_set_danmaku_creature_type = { type = immortal } }
		th_danmaku_creature_type_default_undead = { 		th_set_danmaku_creature_type = { type = undead } }
		th_danmaku_creature_type_default_half_phantom = { 	th_set_danmaku_creature_type = { type = half_phantom } }
		th_danmaku_creature_type_default_half_youkai = { 	th_set_danmaku_creature_type = { type = half_youkai } }
		th_danmaku_creature_type_default_youkai = { 		th_set_danmaku_creature_type = { type = youkai } }
		th_danmaku_creature_type_default_yama = { 			th_set_danmaku_creature_type = { type = yama } }
		th_danmaku_creature_type_default_hermit = { 		th_set_danmaku_creature_type = { type = hermit } }
		th_danmaku_creature_type_default_lunarian = { 		th_set_danmaku_creature_type = { type = lunarian } }
		th_danmaku_creature_type_default_oni = { 			th_set_danmaku_creature_type = { type = oni } }
		th_danmaku_creature_type_default_demon = { 			th_set_danmaku_creature_type = { type = demon } }
		th_danmaku_creature_type_default_devil = { 			th_set_danmaku_creature_type = { type = devil } }
		th_danmaku_creature_type_default_tengu = { 			th_set_danmaku_creature_type = { type = tengu } }
		th_danmaku_creature_type_default_kappa = { 			th_set_danmaku_creature_type = { type = kappa } }
		th_danmaku_creature_type_default_tsukumogami = { 	th_set_danmaku_creature_type = { type = tsukumogami } }
		th_danmaku_creature_type_default_yamanba = { 		th_set_danmaku_creature_type = { type = yamanba } }
		th_danmaku_creature_type_default_nue = { 			th_set_danmaku_creature_type = { type = nue } }
		th_danmaku_creature_type_default_satori = { 		th_set_danmaku_creature_type = { type = satori } }
		th_danmaku_creature_type_default_angel = { 			th_set_danmaku_creature_type = { type = angel } }
		th_danmaku_creature_type_default_shinigami = { 		th_set_danmaku_creature_type = { type = shinigami } }
		th_danmaku_creature_type_default_inchling = { 		th_set_danmaku_creature_type = { type = inchling } }
		th_danmaku_creature_type_default_doll = { 			th_set_danmaku_creature_type = { type = doll } }
		th_danmaku_creature_type_default_robot = { 			th_set_danmaku_creature_type = { type = robot } }
	}
}
th_set_danmaku_class_barbarian = {}
th_set_danmaku_class_warrior = {}
th_set_danmaku_class_rogue = {}
th_set_danmaku_class_ranger = {}
th_set_danmaku_class_bard = {}
th_set_danmaku_class_monk = {}
th_set_danmaku_class_paladin = {}
th_set_danmaku_class_cleric = {}
th_set_danmaku_class_priest = {}
th_set_danmaku_class_druid = {}
th_set_danmaku_class_sorcerer = {}
th_set_danmaku_class_warlock = {}
th_set_danmaku_class_mage = {}
th_set_danmaku_class_artificer = {}
th_set_danmaku_class_commoner = {}
th_set_danmaku_class = {
	custom_tooltip = th_set_danmaku_class_$class$_tt
	hidden_effect = {
		set_ruler_flag = th_danmaku_class_$class$
	}
	th_set_danmaku_class_$class$ = yes
}

th_set_default_danmaku_class = {
	custom_tooltip = th_set_danmaku_class_warrior_tt
	hidden_effect = {
		set_ruler_flag = th_danmaku_class_warrior
	}
	th_set_danmaku_class_warrior = yes
}


th_set_danmaku_ruler = {
	set_ruler_flag = th_danmaku_ruler_$who$
	th_set_danmaku_ruler_$who$ = yes
}
th_set_danmaku_heir = {
	set_heir_flag = th_danmaku_ruler_$who$
}
#human, fairy, vampire, god, demigod, immortal, undead, half_phantom, half_youkai, 
#youkai, yama, hermit, lunarian, oni, demon, devil, tengu, kappa, tsukumogami, 
#yamanba, nue, satori, angel, shinigami, inchling, doll, robot, celestial

#barbarian, warrior, rogue, ranger, bard, monk, paladin, 
#cleric, priest, druid, sorcerer, warlock, mage, artificer

th_set_danmaku_ruler_reimu = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = priest }
}
th_set_danmaku_ruler_marisa = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = mage }
}
th_set_danmaku_ruler_mima = {
	th_set_danmaku_creature_type = { type = undead }
	th_set_danmaku_class = { class = sorcerer }
}
th_set_danmaku_ruler_konngara = {
	th_set_danmaku_creature_type = { type = oni }
	th_set_danmaku_class = { class = warrior }
}
th_set_danmaku_ruler_sariel = {
	th_set_danmaku_creature_type = { type = angel }
	th_set_danmaku_class = { class = cleric }
}
th_set_danmaku_ruler_rika = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = artificer }
}
th_set_danmaku_ruler_meira = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = class }
}
th_set_danmaku_ruler_kana = {
	th_set_danmaku_creature_type = { type = undead }
	th_set_danmaku_class = { class = mage }
}
th_set_danmaku_ruler_kotohime = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = ranger }
}
th_set_danmaku_ruler_ellen = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = mage }
}
th_set_danmaku_ruler_rikako = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = artificer }
}
th_set_danmaku_ruler_chiyuri = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = artificer }
}
th_set_danmaku_ruler_yumemi = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = artificer }
}
th_set_danmaku_ruler_kurumi = {
	th_set_danmaku_creature_type = { type = vampire }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_elly = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = ranger }
}
th_set_danmaku_ruler_gengetsu = {
	th_set_danmaku_creature_type = { type = demon }
	th_set_danmaku_class = { class = sorcerer }
}
th_set_danmaku_ruler_mugetsu = {
	th_set_danmaku_creature_type = { type = demon }
	th_set_danmaku_class = { class = sorcerer }
}
th_set_danmaku_ruler_yuuka = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = druid }
}
th_set_danmaku_ruler_alice = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = mage }
}
th_set_danmaku_ruler_yuki = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = mage }
}
th_set_danmaku_ruler_mai = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = mage }
}
th_set_danmaku_ruler_yumeko = {
	th_set_danmaku_creature_type = { type = demon }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_shinki = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = sorcerer }
}
th_set_danmaku_ruler_rumia = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_cirno = {
	th_set_danmaku_creature_type = { type = fairy }
	th_set_danmaku_class = { class = sorcerer }
}
th_set_danmaku_ruler_daiyousei = {
	th_set_danmaku_creature_type = { type = fairy }
	th_set_danmaku_class = { class = warrior }
}
th_set_danmaku_ruler_meiling = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = monk }
}
th_set_danmaku_ruler_koakuma = {
	th_set_danmaku_creature_type = { type = devil }
	th_set_danmaku_class = { class = warlock }
}
th_set_danmaku_ruler_patchouli = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = mage }
}
th_set_danmaku_ruler_sakuya = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_remilia = {
	th_set_danmaku_creature_type = { type = vampire }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_flandre = {
	th_set_danmaku_creature_type = { type = vampire }
	th_set_danmaku_class = { class = warlock }
}
th_set_danmaku_ruler_satsuki = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = priest }
}
th_set_danmaku_ruler_letty = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = sorcerer }
}
th_set_danmaku_ruler_chen = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_lily = {
	th_set_danmaku_creature_type = { type = fairy }
	th_set_danmaku_class = { class = cleric }
}
th_set_danmaku_ruler_prismriver = {
	th_set_danmaku_creature_type = { type = undead }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_lunasa = {
	th_set_danmaku_creature_type = { type = undead }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_merlin = {
	th_set_danmaku_creature_type = { type = undead }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_lyrica = {
	th_set_danmaku_creature_type = { type = undead }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_layla = {
	th_set_danmaku_creature_type = { type = undead }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_youmu = {
	th_set_danmaku_creature_type = { type = half_phantom }
	th_set_danmaku_class = { class = warrior }
}
th_set_danmaku_ruler_youki = {
	th_set_danmaku_creature_type = { type = half_phantom }
	th_set_danmaku_class = { class = warrior }
}
th_set_danmaku_ruler_yuyuko = {
	th_set_danmaku_creature_type = { type = undead }
	th_set_danmaku_class = { class = warlock }
}
th_set_danmaku_ruler_ran = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = ranger }
}
th_set_danmaku_ruler_yukari = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = warlock }
}
th_set_danmaku_ruler_suika = {
	th_set_danmaku_creature_type = { type = oni }
	th_set_danmaku_class = { class = barbarian }
}
th_set_danmaku_ruler_wriggle = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_mystia = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = ranger }
}
th_set_danmaku_ruler_keine = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = sorcerer }
}
th_set_danmaku_ruler_tewi = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = barbarian }
}
th_set_danmaku_ruler_reisen = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = ranger }
}
th_set_danmaku_ruler_eirin = {
	th_set_danmaku_creature_type = { type = lunarian }
	th_set_danmaku_class = { class = cleric }
}
th_set_danmaku_ruler_kaguya = {
	th_set_danmaku_creature_type = { type = immortal }
	th_set_danmaku_class = { class = sorcerer }
}
th_set_danmaku_ruler_mokou = {
	th_set_danmaku_creature_type = { type = immortal }
	th_set_danmaku_class = { class = barbarian }
}
th_set_danmaku_ruler_aya = {
	th_set_danmaku_creature_type = { type = tengu }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_medicine = {
	th_set_danmaku_creature_type = { type = doll }
	th_set_danmaku_class = { class = class }
}
th_set_danmaku_ruler_komachi = {
	th_set_danmaku_creature_type = { type = shinigami }
	th_set_danmaku_class = { class = cleric }
}
th_set_danmaku_ruler_eiki = {
	th_set_danmaku_creature_type = { type = yama }
	th_set_danmaku_class = { class = paladin }
}
th_set_danmaku_ruler_shizuha = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = druid }
}
th_set_danmaku_ruler_minoriko = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = druid }
}
th_set_danmaku_ruler_hina = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = warlock }
}
th_set_danmaku_ruler_nitori = {
	th_set_danmaku_creature_type = { type = kappa }
	th_set_danmaku_class = { class = artificer }
}
th_set_danmaku_ruler_momiji = {
	th_set_danmaku_creature_type = { type = tengu }
	th_set_danmaku_class = { class = warrior }
}
th_set_danmaku_ruler_sanae = {
	th_set_danmaku_creature_type = { type = demigod }
	th_set_danmaku_class = { class = priest }
}
th_set_danmaku_ruler_kanako = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = cleric }
}
th_set_danmaku_ruler_suwako = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = cleric }
}
th_set_danmaku_ruler_iku = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = druid }
}
th_set_danmaku_ruler_tenshi = {
	th_set_danmaku_creature_type = { type = celestial }
	th_set_danmaku_class = { class = class }
}
th_set_danmaku_ruler_kisume = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_yamame = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = warlock }
}
th_set_danmaku_ruler_parsee = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_yuugi = {
	th_set_danmaku_creature_type = { type = oni }
	th_set_danmaku_class = { class = barbarian }
}
th_set_danmaku_ruler_satori = {
	th_set_danmaku_creature_type = { type = satori }
	th_set_danmaku_class = { class = warlock }
}
th_set_danmaku_ruler_orin = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = ranger }
}
th_set_danmaku_ruler_okuu = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = barbarian }
}
th_set_danmaku_ruler_koishi = {
	th_set_danmaku_creature_type = { type = satori }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_nazrin = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = class }
}
th_set_danmaku_ruler_kogasa = {
	th_set_danmaku_creature_type = { type = tsukumogami }
	th_set_danmaku_class = { class = warrior }
}
th_set_danmaku_ruler_ichirin = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = cleric }
}
th_set_danmaku_ruler_minamitsu = {
	th_set_danmaku_creature_type = { type = undead }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_shou = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = warrior }
}
th_set_danmaku_ruler_byakuren = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = monk }
}
th_set_danmaku_ruler_nue = {
	th_set_danmaku_creature_type = { type = nue }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_hatate = {
	th_set_danmaku_creature_type = { type = tengu }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_kyouko = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_yoshika = {
	th_set_danmaku_creature_type = { type = undead }
	th_set_danmaku_class = { class = barbarian }
}
th_set_danmaku_ruler_seiga = {
	th_set_danmaku_creature_type = { type = undead }
	th_set_danmaku_class = { class = warlock }
}
th_set_danmaku_ruler_tojiko = {
	th_set_danmaku_creature_type = { type = undead }
	th_set_danmaku_class = { class = sorcerer }
}
th_set_danmaku_ruler_futo = {
	th_set_danmaku_creature_type = { type = hermit }
	th_set_danmaku_class = { class = cleric }
}
th_set_danmaku_ruler_miko = {
	th_set_danmaku_creature_type = { type = hermit }
	th_set_danmaku_class = { class = paladin }
}
th_set_danmaku_ruler_mamizou = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_kokoro = {
	th_set_danmaku_creature_type = { type = tsukumogami }
	th_set_danmaku_class = { class = warrior }
}
th_set_danmaku_ruler_wakasagihime = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = ranger }
}
th_set_danmaku_ruler_sekibanki = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = ranger }
}
th_set_danmaku_ruler_kagerou = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = barbarian }
}
th_set_danmaku_ruler_benben = {
	th_set_danmaku_creature_type = { type = tsukumogami }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_yatsuhashi = {
	th_set_danmaku_creature_type = { type = tsukumogami }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_seija = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_shinmyoumaru = {
	th_set_danmaku_creature_type = { type = inchling }
	th_set_danmaku_class = { class = warrior }
}
th_set_danmaku_ruler_raiko = {
	th_set_danmaku_creature_type = { type = tsukumogami }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_sumireko = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = sorcerer }
}
th_set_danmaku_ruler_renko = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = artificer }
}
th_set_danmaku_ruler_maribel = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = sorcerer }
}
th_set_danmaku_ruler_seiran = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = ranger }
}
th_set_danmaku_ruler_ringo = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = barbarian }
}
th_set_danmaku_ruler_doremy = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = sorcerer }
}
th_set_danmaku_ruler_sagune = {
	th_set_danmaku_creature_type = { type = lunarian }
	th_set_danmaku_class = { class = cleric }
}
th_set_danmaku_ruler_clownpiece = {
	th_set_danmaku_creature_type = { type = fairy }
	th_set_danmaku_class = { class = warlock }
}
th_set_danmaku_ruler_junko = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = cleric }
}
th_set_danmaku_ruler_hecatia = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = sorcerer }
}
th_set_danmaku_ruler_toyohime = {
	th_set_danmaku_creature_type = { type = lunarian }
	th_set_danmaku_class = { class = cleric }
}
th_set_danmaku_ruler_yorihime = {
	th_set_danmaku_creature_type = { type = lunarian }
	th_set_danmaku_class = { class = warrior }
}
th_set_danmaku_ruler_change = {
	th_set_danmaku_creature_type = { type = lunarian }
	th_set_danmaku_class = { class = warlock }
}
th_set_danmaku_ruler_reisen_moon = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = ranger }
}
th_set_danmaku_ruler_joon = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_shion = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_sunny = {
	th_set_danmaku_creature_type = { type = fairy }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_star = {
	th_set_danmaku_creature_type = { type = fairy }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_luna = {
	th_set_danmaku_creature_type = { type = fairy }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_kasen = {
	th_set_danmaku_creature_type = { type = oni }
	th_set_danmaku_class = { class = monk }
}
th_set_danmaku_ruler_larva = {
	th_set_danmaku_creature_type = { type = fairy }
	th_set_danmaku_class = { class = cleric }
}
th_set_danmaku_ruler_nemuno = {
	th_set_danmaku_creature_type = { type = yamanba }
	th_set_danmaku_class = { class = barbarian }
}
th_set_danmaku_ruler_aunn = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = cleric }
}
th_set_danmaku_ruler_narumi = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = mage }
}
th_set_danmaku_ruler_teireida = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_satonono = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_okina = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = cleric }
}
th_set_danmaku_ruler_eika = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_urumi = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = druid }
}
th_set_danmaku_ruler_kutaka = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = druid }
}
th_set_danmaku_ruler_mayumi = {
	th_set_danmaku_creature_type = { type = tsukumogami }
	th_set_danmaku_class = { class = warrior }
}
th_set_danmaku_ruler_keiki = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = cleric }
}
th_set_danmaku_ruler_yachie = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_saki = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = ranger }
}
th_set_danmaku_ruler_yuuma = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = barbarian }
}
th_set_danmaku_ruler_mike = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_takane = {
	th_set_danmaku_creature_type = { type = kappa }
	th_set_danmaku_class = { class = artificer }
}
th_set_danmaku_ruler_sannyo = {
	th_set_danmaku_creature_type = { type = yamanba }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_misumaru = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = sorcerer }
}
th_set_danmaku_ruler_tsukasa = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = ranger }
}
th_set_danmaku_ruler_megumu = {
	th_set_danmaku_creature_type = { type = tengu }
	th_set_danmaku_class = { class = warrior }
}
th_set_danmaku_ruler_chimata = {
	th_set_danmaku_creature_type = { type = god }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_momoyo = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = ranger }
}
th_set_danmaku_ruler_son = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = monk }
}
th_set_danmaku_ruler_enoko = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = ranger }
}
th_set_danmaku_ruler_chiyari = {
	th_set_danmaku_creature_type = { type = demon }
	th_set_danmaku_class = { class = rogue }
}
th_set_danmaku_ruler_hisami = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = warlock }
}
th_set_danmaku_ruler_zanmu = {
	th_set_danmaku_creature_type = { type = oni }
	th_set_danmaku_class = { class = barbarian }
}
th_set_danmaku_ruler_rinnosuke = {
	th_set_danmaku_creature_type = { type = half_youkai }
	th_set_danmaku_class = { class = warrior }
}
th_set_danmaku_ruler_tokiko = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = warrior }
}
th_set_danmaku_ruler_miyoi = {
	th_set_danmaku_creature_type = { type = youkai }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_mizuchi = {
	th_set_danmaku_creature_type = { type = undead }
	th_set_danmaku_class = { class = warlock }
}
th_set_danmaku_ruler_zun = {
	th_set_danmaku_creature_type = { type = human }
	th_set_danmaku_class = { class = bard }
}
th_set_danmaku_ruler_generic = {
	th_set_danmaku_creature_type = { type = human }
	if = {
		limit = {
			ruler_total_stats = { amount = 10 }
		}
		random_list = {
			1 = { th_set_danmaku_class = { class = ranger } }
			1 = { th_set_danmaku_class = { class = warrior } }
			1 = { th_set_danmaku_class = { class = barbarian } }
			1 = { th_set_danmaku_class = { class = bard } }
		}
	}
	else = {
		th_set_danmaku_class = { class = commoner }
	}
}

#Get the extra buffs from the danmaku modifiers
th_additional_danmaku_buff = {
	export_to_variable = {
		variable_name = th_additional_danmaku_power
		value = modifier:danmaku_power_constant
		who = ROOT
	}
	export_to_variable = {
		variable_name = th_danmaku_power_modifier
		value = modifier:danmaku_power_factor
		who = ROOT
	}
	set_variable = {
		which = th_danmaku_combat_power
		value = roll_power_gain
	}
	change_variable = {
		which = th_danmaku_power_modifier
		value = 1
	}
	if = {
		limit = {
			NOT = {
				check_variable = {
					which = th_danmaku_power_modifier
					value = 0
				}
			}
		}
		set_variable = {
			which = th_danmaku_power_modifier
			value = 0
		}
	}
	change_variable = {
		which = $fighting_variable$
		which = th_additional_danmaku_power
	}
	multiply_variable = {
		which = $fighting_variable$
		which = th_danmaku_power_modifier
	}
}

#Uses "type"
#Supports the following types:
# incident			- used for all incident related fights
# lesser_incident	- used for all smaller scope incidents related fights
# normal			- used for all the other fights
th_getruler_fighting_skill = {
	#Players Fighting Skills
	#modifiers were moved to modifier:danmaku_power_constant, which is controlled by th_additional_danmaku_buff
	set_variable = {
		which = th_current_fighting_skills_$type$
		value = $skill_boni$
	}
	export_to_variable = {
		variable_name = th_fighting_danmaku_power
		value = modifier:fighting_danmaku_power_constant
		who = ROOT
	}
	change_variable = {
		which = th_current_fighting_skills_$type$
		which = th_fighting_danmaku_power
	}
	#export_to_variable = {
	#	variable_name = th_current_military_skill
	#	value = MIL
	#	who = ROOT
	#}
	#export_to_variable = {
	#	variable_name = th_current_army_tradition_skill
	#	value = army_tradition
	#	who = ROOT
	#}
	#export_to_variable = {
	#	variable_name = th_current_religious_unity_skill
	#	value = religious_unity
	#	who = ROOT
	#}
	#export_to_variable = {
	#	variable_name = th_current_tolerance_to_the_true_faith_skill
	#	value = modifier:tolerance_own
	#	who = ROOT
	#}
	set_variable = {
		which = th_danmaku_combat_power
		value = roll_power_gain
	}

	#multiply_variable = {
	#	which = th_current_military_skill
	#	value = 100
	#}
	
	#multiply_variable = {
	#	which = th_current_army_tradition_skill
	#	value = 3
	#}
			
	#multiply_variable = {
	#	which = th_current_religious_unity_skill
	#	value = 50
	#}
			
	#multiply_variable = {
	#	which = th_current_tolerance_to_the_true_faith_skill
	#	value = 100
	#}
	
	set_variable = {
		which = th_current_fighting_skills_$type$
		value = 0
	}
	change_variable = {
		which = th_current_fighting_skills_$type$
		which = th_additional_fighting_boni
	}
	#change_variable = {
	#	which = th_current_fighting_skills_$type$
	#	which = th_current_military_skill
	#}
	#change_variable = {
	#	which = th_current_fighting_skills_$type$
	#	which = th_current_army_tradition_skill
	#}
	#change_variable = {
	#	which = th_current_fighting_skills_$type$
	#	which = th_current_religious_unity_skill
	#}
	#change_variable = {
	#	which = th_current_fighting_skills_$type$
	#	which = th_current_tolerance_to_the_true_faith_skill
	#}
	change_variable = {
		which = th_current_fighting_skills_$type$
		which = roll_power_gain
	}
	th_additional_danmaku_buff = {
		fighting_variable = th_current_fighting_skills_$type$
	}
}

th_getruler_diplomatic_skill = {
	#Players Fighting Skills
	set_variable = {
		which = th_current_diplo_skills
		value = $skill_boni$
	}
	export_to_variable = {
		variable_name = th_diplomatic_danmaku_power
		value = modifier:diplomatic_danmaku_power_constant
		who = ROOT
	}
	export_to_variable = {
		variable_name = th_diplomatic_danmaku_power_modifier
		value = modifier:diplomatic_danmaku_power_factor
		who = ROOT
	}
	change_variable = {
		which = th_current_diplo_skills
		which = th_diplomatic_danmaku_power
	}
	######
	# For subject count
	export_to_variable = {
		variable_name = th_current_subjects_skill
		value = trigger_value:num_of_subjects
		who = ROOT
	}
	multiply_variable = {
		which = th_current_subjects_skill
		value = 50
	}
	change_variable = {
		which = th_current_diplo_skills
		which = th_current_subjects_skill
	}
	#Add default buff
	th_additional_danmaku_buff = {
		fighting_variable = th_current_diplo_skills
	}
}

#Is used for danmaku fights through diplomatic action
th_danmaku_set_compare_variable = {
	set_variable = {
		which = th_current_fighting_skills_counter
		which = th_current_fighting_skills_$type$
	}
}

#Supports the following types:
# incident			- used for all incident related fights
# lesser_incident	- used for all smaller incidents related fights
# normal			- used for all the other fights
# diplomatic		- used for diplo fights only
th_defineopponent_fighting_skill = {
	#Draw Zone
	set_variable = {
		which = th_enemy_lower_border_draw_$type$
		value = 0
	}
	set_variable = {
		which = th_enemy_upper_border_draw_$type$
		value = 0
	}
	set_variable = {
		which = th_enemy_lower_border_draw_$type$
		which = $variable$
	}
	set_variable = {
		which = th_enemy_upper_border_draw_$type$
		which = $variable$
	}
			
	change_variable = {
		which = th_enemy_upper_border_draw_$type$
		value = 50
	}
	subtract_variable = {
		which = th_enemy_lower_border_draw_$type$
		value = 50
	}
			
	#Victory Zone
	set_variable = {
		which = th_enemy_border_great_victory_$type$
		value = 0
	}
	set_variable = {
		which = th_enemy_border_great_victory_$type$
		which = th_enemy_upper_border_draw_$type$
	}
			
	change_variable = {
		which = th_enemy_border_great_victory_$type$
		value = 125
	}
			
	#Defeat Zone
	set_variable = {
		which = th_enemy_border_great_defeat_$type$
		value = 0
	}
	set_variable = {
		which = th_enemy_border_great_defeat_$type$
		which = th_enemy_lower_border_draw_$type$
	}
	subtract_variable = {
		which = th_enemy_border_great_defeat_$type$
		value = 125
	}

	#Show Variable
	set_variable = {
		which = th_danmaku_duel_show_variable_$type$
		which = $variable$
	}
}

th_danmaku_incident_fight_ruler_and_opponent = {
	custom_tooltip = th_danmaku_incident_fight_ruler_and_opponent_tt
	#Player is waaaay stronger
	if = {
		limit = {
			check_variable = {
				which = th_current_fighting_skills_incident
				which = th_enemy_border_great_victory_incident
			}
			NOT = {
				check_variable = {
					which = th_enemy_upper_border_draw_incident
					which = th_current_fighting_skills_incident
				}
			}
		}
		random_list = {
			60 = {
				country_event = {
					id = th_danmaku_event.3
					days = 1
				}
			}
			40 = {
				country_event = {
					id = th_danmaku_event.2
					days = 1
				}	
			}
		}
	}
	#Player is stronger
	if = {
		limit = {
			check_variable = {
				which = th_current_fighting_skills_incident
				which = th_enemy_upper_border_draw_incident
			}
			NOT = {
				check_variable = {
					which = th_current_fighting_skills_incident
					which = th_enemy_border_great_victory_incident
				}
			}
		}
		random_list = {
			75 = {
				country_event = {
					id = th_danmaku_event.3
					days = 1
				}
			}
			15 = {
				country_event = {
					id = th_danmaku_event.2
					days = 1
				}			
			}
			10 = {
				country_event = {
					id = th_danmaku_event.4
					days = 1
				}			
			}
		}
	}
	#Opponent and Player are equal strong
	if = {
		limit = {
			check_variable = {
				which = th_current_fighting_skills_incident
				which = th_enemy_lower_border_draw_incident
			}
			NOT = {
				check_variable = {
					which = th_current_fighting_skills_incident
					which = th_enemy_upper_border_draw_incident
				}
			}
		}
		random_list = {
			65 = {
				country_event = {
					id = th_danmaku_event.4
					days = 1
				}
			}
			25 = {
				country_event = {
					id = th_danmaku_event.3
					days = 1
				}			
			}
			10 = {
				country_event = {
					id = th_danmaku_event.5
					days = 1
				}			
			}
		}
	}
	#Opponent is stronger
	if = {
		limit = {
			check_variable = {
				which = th_current_fighting_skills_incident
				which = th_enemy_border_great_defeat_incident
			}
			NOT = {
				check_variable = {
					which = th_current_fighting_skills_incident
					which = th_enemy_lower_border_draw_incident
				}
			}
		}
		random_list = {
			20 = {
				country_event = {
					id = th_danmaku_event.6
					days = 1
				}
			}
			60 = {
				country_event = {
					id = th_danmaku_event.5
					days = 1
				}			
			}
			20 = {
				country_event = {
					id = th_danmaku_event.4
					days = 1
				}			
			}
		}
	}
	#Opponent is waaaay stronger
	if = {
		limit = {
			check_variable = {
				which = th_enemy_border_great_defeat_incident
				which = th_current_fighting_skills_incident
			}
		}
		random_list = {
			50 = {
				country_event = {
					id = th_danmaku_event.6
					days = 1
				}
			}
			40 = {
				country_event = {
					id = th_danmaku_event.5
					days = 1
				}			
			}
			10 = {
				country_event = {
					id = th_danmaku_event.4
					days = 1
				}			
			}
		}
	}
}

#Use th_empty_event.1 for win/draw/lose events if you don't have any additional events following the fight
th_danmaku_lesser_incident_fight_ruler_and_opponent = {
	custom_tooltip = th_danmaku_lesser_incident_fight_ruler_and_opponent_tt
	#Player is waaaay stronger
	if = {
		limit = {
			check_variable = {
				which = th_current_fighting_skills_lesser_incident
				which = th_enemy_border_great_victory_lesser_incident
			}
			NOT = {
				check_variable = {
					which = th_enemy_upper_border_draw_lesser_incident
					which = th_current_fighting_skills_lesser_incident
				}
			}
		}
		random_list = {
			60 = {
				country_event = {
					id = th_danmaku_event.9
					days = 1
				}
			}
			40 = {
				country_event = {
					id = th_danmaku_event.8
					days = 1
				}	
			}
		}
		hidden_effect = {
			country_event = {
				id = $win_event$
				days = $days$
			}
		}
	}
	#Player is stronger
	if = {
		limit = {
			check_variable = {
				which = th_current_fighting_skills_lesser_incident
				which = th_enemy_upper_border_draw_lesser_incident
			}
			NOT = {
				check_variable = {
					which = th_current_fighting_skills_lesser_incident
					which = th_enemy_border_great_victory_lesser_incident
				}
			}
		}
		random_list = {
			75 = {
				country_event = {
					id = th_danmaku_event.9
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $win_event$
						days = $days$
					}
				}
			}
			15 = {
				country_event = {
					id = th_danmaku_event.8
					days = 1
				}	
				hidden_effect = {
					country_event = {
						id = $win_event$
						days = $days$
					}
				}		
			}
			10 = {
				country_event = {
					id = th_danmaku_event.10
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $draw_event$
						days = $days$
					}
				}
			}
		}
	}
	#Opponent and Player are equal strong
	if = {
		limit = {
			check_variable = {
				which = th_current_fighting_skills_lesser_incident
				which = th_enemy_lower_border_draw_lesser_incident
			}
			NOT = {
				check_variable = {
					which = th_current_fighting_skills_lesser_incident
					which = th_enemy_upper_border_draw_lesser_incident
				}
			}
		}
		random_list = {
			65 = {
				country_event = {
					id = th_danmaku_event.10
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $draw_event$
						days = $days$
					}
				}
			}
			25 = {
				country_event = {
					id = th_danmaku_event.9
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $win_event$
						days = $days$
					}
				}
			}
			10 = {
				country_event = {
					id = th_danmaku_event.11
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $defeat_event$
						days = $days$
					}
				}	
			}
		}
	}
	#Opponent is stronger
	if = {
		limit = {
			check_variable = {
				which = th_current_fighting_skills_lesser_incident
				which = th_enemy_border_great_defeat_lesser_incident
			}
			NOT = {
				check_variable = {
					which = th_current_fighting_skills_lesser_incident
					which = th_enemy_lower_border_draw_lesser_incident
				}
			}
		}
		random_list = {
			20 = {
				country_event = {
					id = th_danmaku_event.12
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $defeat_event$
						days = $days$
					}
				}	
			}
			60 = {
				country_event = {
					id = th_danmaku_event.11
					days = 1
				}	
				hidden_effect = {
					country_event = {
						id = $defeat_event$
						days = $days$
					}
				}			
			}
			20 = {
				country_event = {
					id = th_danmaku_event.10
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $draw_event$
						days = $days$
					}
				}
			}
		}
	}
	#Opponent is waaaay stronger
	if = {
		limit = {
			check_variable = {
				which = th_enemy_border_great_defeat_lesser_incident
				which = th_current_fighting_skills_lesser_incident
			}
		}
		random_list = {
			50 = {
				country_event = {
					id = th_danmaku_event.12
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $defeat_event$
						days = $days$
					}
				}	
			}
			40 = {
				country_event = {
					id = th_danmaku_event.11
					days = 1
				}	
				hidden_effect = {
					country_event = {
						id = $defeat_event$
						days = $days$
					}
				}			
			}
			10 = {
				country_event = {
					id = th_danmaku_event.10
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $draw_event$
						days = $days$
					}
				}
			}
		}
	}
}

#Use th_empty_event.1 for win/draw/lose events if you don't have any additional events following the fight
th_danmaku_normal_fight_ruler_and_opponent = {
	custom_tooltip = th_danmaku_normal_fight_ruler_and_opponent_tt
	#Player is waaaay stronger
	if = {
		limit = {
			check_variable = {
				which = th_current_fighting_skills_normal
				which = th_enemy_border_great_victory_normal
			}
			NOT = {
				check_variable = {
					which = th_enemy_upper_border_draw_normal
					which = th_current_fighting_skills_normal
				}
			}
		}
		random_list = {
			60 = {
				country_event = {
					id = th_danmaku_event.9
					days = 1
				}
			}
			40 = {
				country_event = {
					id = th_danmaku_event.8
					days = 1
				}	
			}
		}
		hidden_effect = {
			country_event = {
				id = $win_event$
				days = $days$
			}
		}
	}
	#Player is stronger
	if = {
		limit = {
			check_variable = {
				which = th_current_fighting_skills_normal
				which = th_enemy_upper_border_draw_normal
			}
			NOT = {
				check_variable = {
					which = th_current_fighting_skills_normal
					which = th_enemy_border_great_victory_normal
				}
			}
		}
		random_list = {
			75 = {
				country_event = {
					id = th_danmaku_event.9
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $win_event$
						days = $days$
					}
				}
			}
			15 = {
				country_event = {
					id = th_danmaku_event.8
					days = 1
				}	
				hidden_effect = {
					country_event = {
						id = $win_event$
						days = $days$
					}
				}		
			}
			10 = {
				country_event = {
					id = th_danmaku_event.10
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $draw_event$
						days = $days$
					}
				}
			}
		}
	}
	#Opponent and Player are equal strong
	if = {
		limit = {
			check_variable = {
				which = th_current_fighting_skills_normal
				which = th_enemy_lower_border_draw_normal
			}
			NOT = {
				check_variable = {
					which = th_current_fighting_skills_normal
					which = th_enemy_upper_border_draw_normal
				}
			}
		}
		random_list = {
			65 = {
				country_event = {
					id = th_danmaku_event.10
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $draw_event$
						days = $days$
					}
				}
			}
			25 = {
				country_event = {
					id = th_danmaku_event.9
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $win_event$
						days = $days$
					}
				}
			}
			10 = {
				country_event = {
					id = th_danmaku_event.11
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $defeat_event$
						days = $days$
					}
				}	
			}
		}
	}
	#Opponent is stronger
	if = {
		limit = {
			check_variable = {
				which = th_current_fighting_skills_normal
				which = th_enemy_border_great_defeat_normal
			}
			NOT = {
				check_variable = {
					which = th_current_fighting_skills_normal
					which = th_enemy_lower_border_draw_normal
				}
			}
		}
		random_list = {
			20 = {
				country_event = {
					id = th_danmaku_event.12
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $defeat_event$
						days = $days$
					}
				}	
			}
			60 = {
				country_event = {
					id = th_danmaku_event.11
					days = 1
				}	
				hidden_effect = {
					country_event = {
						id = $defeat_event$
						days = $days$
					}
				}			
			}
			20 = {
				country_event = {
					id = th_danmaku_event.10
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $draw_event$
						days = $days$
					}
				}
			}
		}
	}
	#Opponent is waaaay stronger
	if = {
		limit = {
			check_variable = {
				which = th_enemy_border_great_defeat_normal
				which = th_current_fighting_skills_normal
			}
		}
		random_list = {
			50 = {
				country_event = {
					id = th_danmaku_event.12
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $defeat_event$
						days = $days$
					}
				}	
			}
			40 = {
				country_event = {
					id = th_danmaku_event.11
					days = 1
				}	
				hidden_effect = {
					country_event = {
						id = $defeat_event$
						days = $days$
					}
				}			
			}
			10 = {
				country_event = {
					id = th_danmaku_event.10
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $draw_event$
						days = $days$
					}
				}
			}
		}
	}
}

th_danmaku_diplo_fight_ruler_and_opponent = {
	custom_tooltip = th_danmaku_diplo_fight_ruler_and_opponent_tt
	#Player is waaaay stronger
	if = {
		limit = {
			check_variable = {
				which = th_current_diplo_skills
				which = th_enemy_border_great_victory_normal
			}
			NOT = {
				check_variable = {
					which = th_enemy_upper_border_draw_normal
					which = th_current_diplo_skills
				}
			}
		}
		random_list = {
			60 = {
				country_event = {
					id = th_danmaku_event.22
					days = 1
				}
			}
			40 = {
				country_event = {
					id = th_danmaku_event.21
					days = 1
				}	
			}
		}
		hidden_effect = {
			country_event = {
				id = $win_event$
				days = $days$
			}
		}
	}
	#Player is stronger
	if = {
		limit = {
			check_variable = {
				which = th_current_diplo_skills
				which = th_enemy_upper_border_draw_normal
			}
			NOT = {
				check_variable = {
					which = th_current_diplo_skills
					which = th_enemy_border_great_victory_normal
				}
			}
		}
		random_list = {
			75 = {
				country_event = {
					id = th_danmaku_event.22
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $win_event$
						days = $days$
					}
				}
			}
			15 = {
				country_event = {
					id = th_danmaku_event.21
					days = 1
				}			
				hidden_effect = {
					country_event = {
						id = $win_event$
						days = $days$
					}
				}
			}
			10 = {
				country_event = {
					id = th_danmaku_event.23
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $draw_event$
						days = $days$
					}
				}
			}
		}
	}
	#Opponent and Player are equal strong
	if = {
		limit = {
			check_variable = {
				which = th_current_diplo_skills
				which = th_enemy_lower_border_draw_normal
			}
			NOT = {
				check_variable = {
					which = th_current_diplo_skills
					which = th_enemy_upper_border_draw_normal
				}
			}
		}
		random_list = {
			65 = {
				country_event = {
					id = th_danmaku_event.23
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $draw_event$
						days = $days$
					}
				}
			}
			25 = {
				country_event = {
					id = th_danmaku_event.22
					days = 1
				}			
				hidden_effect = {
					country_event = {
						id = $win_event$
						days = $days$
					}
				}
			}
			10 = {
				country_event = {
					id = th_danmaku_event.24
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $defeat_event$
						days = $days$
					}
				}
			}
		}
	}
	#Opponent is stronger
	if = {
		limit = {
			check_variable = {
				which = th_current_diplo_skills
				which = th_enemy_border_great_defeat_normal
			}
			NOT = {
				check_variable = {
					which = th_enemy_lower_border_draw_normal
					which = th_enemy_border_great_defeat_normal
				}
			}
		}
		random_list = {
			20 = {
				country_event = {
					id = th_danmaku_event.25
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $defeat_event$
						days = $days$
					}
				}
			}
			60 = {
				country_event = {
					id = th_danmaku_event.24
					days = 1
				}		
				hidden_effect = {
					country_event = {
						id = $defeat_event$
						days = $days$
					}
				}	
			}
			20 = {
				country_event = {
					id = th_danmaku_event.23
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $draw_event$
						days = $days$
					}
				}
			}
		}
	}
	#Opponent is waaaay stronger
	if = {
		limit = {
			check_variable = {
				which = th_enemy_border_great_defeat_normal
				which = th_current_diplo_skills
			}
		}
		random_list = {
			50 = {
				country_event = {
					id = th_danmaku_event.25
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $defeat_event$
						days = $days$
					}
				}
			}
			40 = {
				country_event = {
					id = th_danmaku_event.24
					days = 1
				}	
				hidden_effect = {
					country_event = {
						id = $defeat_event$
						days = $days$
					}
				}		
			}
			10 = {
				country_event = {
					id = th_danmaku_event.23
					days = 1
				}
				hidden_effect = {
					country_event = {
						id = $draw_event$
						days = $days$
					}
				}
			}
		}
	}
}

#Increases the counter for the danmaku fights the country has won
th_danmaku_won_a_danmaku_fight = {
	hidden_effect = {
		if = {
			limit = { has_country_flag = th_danmaku_counts_won_danmaku_fights }
			change_variable = {
				which = th_danmaku_won_danmaku_fights
				value = 1
			}
		}
		else = {
			set_country_flag = th_danmaku_counts_won_danmaku_fights
			set_variable = {
				which = th_danmaku_won_danmaku_fights
				value = 1
			}
		}
	}
}