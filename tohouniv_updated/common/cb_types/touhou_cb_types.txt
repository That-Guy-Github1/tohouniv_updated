# INSTRUCTIONS:
# -------------
# is_triggered_only - Triggered from within the code or by event effects. DO NOT REMOVE THE STOCK ONES.
# months - The number of months this CB will be valid. Only works for triggered CBs.
# prerequisites - A condition that automatically activates a CB. Does not work for triggered CBs.
# no_opinion_hit - If yes you get no negative opinion from this
#
# ROOT = attacker
# FROM = target
#
# NOTE: The order in which the peace options are listed is the order in which the AI will normally prioritize them in peace treaties
#
# TRIGGERED - Triggered from within the code or by event effects
# --------------------------------------------------------------


# AUTOMATIC - Constantly in effect while 'prerequisites' is true
# --------------------------------------------------------------

#Fairy War
cb_touhou_fairy_war = {
	valid_for_subject = no

	prerequisites = {
		is_free_or_tributary_trigger = yes
		primary_culture = Fairy
		
		FROM = {
			NOT = { is_subject_of = ROOT }
			primary_culture = Fairy
		}
		is_neighbor_of = FROM
	}

	war_goal = superiority_fairy_war
}

#Kaguya and Mokou War
cb_touhou_eit_fuj_war = {
	valid_for_subject = no
	
	prerequisites = {
		is_free_or_tributary_trigger = yes
		OR = {
			tag = EIT
			tag = FUJ
		}
		
		FROM = {
			NOT = { is_subject_of = ROOT }
			OR = {
				tag = EIT
				tag = FUJ
			}
		}
	}
	
	war_goal = th_annexation_war_eit_fuj
}

#Kaguya and Mokou Mission War
cb_touhou_mission_eit_fuj_war = {
	valid_for_subject = no

	is_triggered_only = yes
	months = 900

	war_goal = th_superiority_war_mission_eit_fuj
}

#Enforce Religious Tributary
cb_touhou_force_religious_tributary = {
	valid_for_subject = no

	prerequisites = {
		has_country_flag = th_enable_religious_tributary_war
		FROM = { 
			is_subject = no 
			is_revolutionary = no
			is_emperor_of_china = no
			is_emperor = no
		}
		has_matching_religion = FROM
		is_revolutionary = no
	}

	war_goal = th_superiority_force_religious_tributary
}

#Religious Superiority cb
cb_touhou_religious_superiority_war = {
	valid_for_subject = no
	holy_war = yes

	prerequisites = {
		has_country_flag = th_enable_domination_war
		FROM = { 
			is_subject = no 
			is_revolutionary = no
			is_emperor_of_china = no
			is_emperor = no
			NOT = { has_country_modifier = th_pledged_to_remain_religious }
		}
		has_matching_religion = FROM
		is_revolutionary = no
	}

	attacker_disabled_po = {
		po_demand_provinces
		po_release_vassals
		po_release_annexed
		po_return_cores
		po_become_vassal
		po_become_tributary_state
		po_form_personal_union
		po_transfer_vassals
	}

	war_goal = th_religious_superiority_war
}

#War against Yama Oppression
cb_touhou_gensokyan_yama_war = {
	valid_for_subject = no
	
	prerequisites = {
		is_free_or_tributary_trigger = yes
		capital_scope = {
			continent = gensokyo_continent
		}
		FROM = {
			NOT = { alliance_with = ROOT }
			NOT = { is_subject_of = ROOT }
			has_government_attribute = enables_yama_authority
			th_hig_has_revokable_reform_active = yes
		}
	}

	attacker_disabled_po = {
		po_demand_provinces
		po_release_vassals
		po_release_annexed
		po_return_cores
		po_become_vassal
		po_subjugate_vassal
		po_become_tributary_state
		po_subjugate_tributary_state
		po_form_personal_union
		po_transfer_vassals
		po_th_atone_for_heresy
		po_th_enforce_rebellious_dominion
		po_th_force_religion_cb
		po_th_pledge_to_religion
		po_th_enforce_religious_tributary
	}
	
	war_goal = th_war_revoke_yama_reform
}

#Enforce Executor Appointment War
cb_touhou_enforce_executor_service = {
	valid_for_subject = no

	is_triggered_only = yes
	months = 120

	war_goal = th_war_enforce_executor_position
}

#Pledging to religion cb
cb_touhou_religious_pledge_war = {
	valid_for_subject = no
	holy_war = yes

	is_triggered_only = yes
	months = 1200

	war_goal = th_pledge_to_religion_war
}

#Penance for pledge breaking cb
cb_touhou_penance_war = {
	valid_for_subject = no
	holy_war = yes

	is_triggered_only = yes
	months = 1200

	war_goal = th_penance_war
}

#Personal Union War
cb_touhou_mission_personal_union_war = {
	valid_for_subject = no

	is_triggered_only = yes
	months = 240

	war_goal = take_capital_personal_union
}

#CIN punish the Fairy Slayers
cb_touhou_mission_punish_fairy_slayers = {
	valid_for_subject = no

	is_triggered_only = yes
	months = 1800

	war_goal = th_anti_fairy_slayer_war
}

#Pledging to religion cb
cb_touhou_baka_war = {
	valid_for_subject = no

	is_triggered_only = yes
	months = 36

	war_goal = th_rfc_challenge_the_baka_war
}

#LRV annexes OKI cb
cb_touhou_mission_lrv_oki_war = {
	valid_for_subject = no
	holy_war = yes

	is_triggered_only = yes
	months = 900

	war_goal = th_war_mission_lrv_oki
}

#SCR / CRD enforce dominion cb
cb_touhou_mission_scr_crd_war = {
	valid_for_subject = no

	is_triggered_only = yes
	months = 900

	war_goal = th_war_mission_scr_crd
}

#Assert dominance cb
cb_touhou_mission_dominance_war = {
	valid_for_subject = no

	is_triggered_only = yes
	months = 900

	attacker_disabled_po = {
		po_demand_provinces
		po_release_vassals
		po_release_annexed
		po_return_cores
		po_become_vassal
		po_subjugate_vassal
		po_become_tributary_state
		po_subjugate_tributary_state
		po_form_personal_union
		po_transfer_vassals
		po_th_atone_for_heresy
		po_th_enforce_rebellious_dominion
		po_th_force_religion_cb
		po_th_pledge_to_religion
		po_th_enforce_religious_tributary
	}

	war_goal = th_war_mission_assert_dominance
}

#FOM cleptomania cb
cb_magician_expansion = {
	valid_for_subject = no

	prerequisites = {
		FROM = {
			is_neighbor_of = ROOT
			any_owned_province = {
				NOT = { has_province_modifier = th_mark_of_koishi }	#Does not have the cb when all bordering provinces have already been exploited by KMJ
				any_neighbor_province = {
					owned_by = ROOT
				}
			}
		}
		OR = {
			has_government_attribute = enables_magician_expansion_cb
			has_country_flag = th_enable_magician_expansion_cb
		}
		is_revolutionary = no
	}

	war_goal = th_magician_expansion_superiority
}

#KMJ expand wandering realm cb
cb_wandering_realm_expansion = {
	valid_for_subject = no

	prerequisites = {
		is_neighbor_of = FROM
		has_government_attribute = enables_development_transfer
		is_revolutionary = no
	}

	attacker_disabled_po = {
		po_become_vassal
		po_subjugate_vassal
		po_become_tributary_state
		po_subjugate_tributary_state
		po_form_personal_union
		po_transfer_vassals
		po_th_atone_for_heresy
		po_th_enforce_rebellious_dominion
		po_th_force_religion_cb
		po_th_pledge_to_religion
		po_th_enforce_religious_tributary
	}

	war_goal = th_wandering_realm_expansion_superiority
}

#ZUN cb
cb_zun = {
	valid_for_subject = no

	prerequisites = {
		th_is_or_was_tag = {
			tag = ZUT
		}
		is_free_or_tributary_trigger = yes
	}

	war_goal = take_capital_imperial
}

# Holy War
cb_mry_crusade = {
	valid_for_subject = no
	holy_war = yes

	prerequisites = {
		NOT = { has_reform = religious_permanent_revolution_reform }
		is_neighbor_of = FROM
		NOT = { religion = FROM }
		NOT = {	has_matching_religion = FROM }
		FROM = {
			has_country_modifier = th_mry_crusade_target
		}
		is_revolutionary = no
		OR = {
			any_country = {
				mry_uses_faith_power = yes
				religion = ROOT
			}
			mry_uses_faith_power = yes
		}
	}

	war_goal = superiority_crusade
}

# Return Hecatia War
cb_return_hecatia_war = {
	valid_for_subject = no
	prerequisites = {
		has_country_flag = hig_has_return_hecatia_war_cb_flag
		OR = {
			AND = {
				NOT = { exists = HEC }
				FROM = { owns = 5327 }
			}
			FROM = { tag = HEC }
		}
	}

	attacker_disabled_po = {
		po_demand_provinces
		po_release_vassals
		po_release_annexed
		po_return_cores
		po_become_vassal
		po_subjugate_vassal
		po_become_tributary_state
		po_subjugate_tributary_state
		po_form_personal_union
		po_transfer_vassals
	}

	war_goal = th_war_return_hecatia
}

# War of Repentance
cb_repentance_war = {
	valid_for_subject = no

	prerequisites = {
		FROM = {
			th_has_been_lectured = yes
			capital_scope = {
				continent = gensokyo_continent
			}
		}
		th_has_not_been_lectured = yes
		capital_scope = {
			continent = gensokyo_continent
		}
		FROM = {
			is_neighbor_of = ROOT
			any_owned_province = {
				OR = {
					is_core = ROOT
					is_claim = ROOT
					any_neighbor_province = {
						owned_by = ROOT
					}
				}
			}
		}
		is_revolutionary = no
	}

	war_goal = th_repentance_war
}

# War of Unjustice
cb_lift_of_lecture = {
	valid_for_subject = no

	prerequisites = {
		FROM = {
			has_government_attribute = enables_yama_authority
		}
		th_has_been_lectured = yes
		capital_scope = {
			continent = gensokyo_continent
		}
		is_revolutionary = no
	}

	war_goal = th_war_of_unjustice
}

# War for Unlawful Territory
cb_war_for_unlawful_territory = {
	valid_for_subject = no

	is_triggered_only = yes
	months = 120

	attacker_disabled_po = {
		po_demand_provinces
		po_subjugate_vassal
		po_become_tributary_state
		po_subjugate_tributary_state
		po_form_personal_union
		po_transfer_vassals
		po_th_atone_for_heresy
		po_th_enforce_rebellious_dominion
		po_th_force_religion_cb
		po_th_pledge_to_religion
		po_th_enforce_religious_tributary
	}

	war_goal = th_war_for_unlawful_territory
}

# Enforce Partition War
cb_partitioning_war = {
	valid_for_subject = no

	is_triggered_only = yes
	months = 60

	attacker_disabled_po = {
		po_demand_provinces
		po_become_vassal
		po_subjugate_vassal
		po_become_tributary_state
		po_subjugate_tributary_state
		po_form_personal_union
		po_transfer_vassals
	}

	war_goal = th_war_for_partition
}

# ONI-Chireiden war
cb_former_hell_war = {
	valid_for_subject = no

	is_triggered_only = yes
	months = 240

	war_goal = th_war_former_hell
}

# Wrath of Mima
cb_mimas_wrath_war = {
	valid_for_subject = no

	prerequisites = {
		has_country_flag = mim_mima_has_returned
		is_free_or_tributary_trigger = yes
	}

	war_goal = th_mimas_wrath_war
}

# Lunarian Extermination
cb_lunarian_extermination = {
	valid_for_subject = no

	attacker_disabled_po = {
		po_become_vassal
		po_subjugate_vassal
		po_become_tributary_state
		po_subjugate_tributary_state
		po_transfer_vassals
	}

	prerequisites = {
		has_country_flag = lcu_extermination_time
		is_free_or_tributary_trigger = yes
		NOT = { culture_group_claim = FROM }
	}

	war_goal = th_lunarian_extermination
}