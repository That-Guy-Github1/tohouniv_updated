#The Demands of Tenma

#Advisor Demands
th_tenma_demands_hire_adm_advisor = {
	max_days_active = 1825
	can_select = {
		NOT = { has_country_flag = th_has_tengu_demands_instead_of_agendas }
		NOT = {
			employed_advisor = {
				category = ADM
			}
		}
	}
	selection_weight = {
		factor = 1
	}
	task_requirements = {
		employed_advisor = {
			category = ADM
		}
		is_in_deficit = no
	}
    task_completed_effect = {
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 5
		}
		add_adm_power = 25
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
}

th_tenma_demands_fire_adm_advisor = {
	max_days_active = 1825
	can_select = {
		NOT = { has_country_flag = th_has_tengu_demands_instead_of_agendas }
		employed_advisor = {
			category = ADM
		}
	}
	selection_weight = {
		factor = 1
		modifier = {
			factor = 0.5
			always = yes
		}
	}
	immediate_effect = {
		hidden_effect = {
			set_country_flag = need_to_fire_adm_advisor
		}
	}
	on_invalid = {
		clr_country_flag = need_to_fire_adm_advisor
	}
	task_requirements = {
		custom_trigger_tooltip = {
			tooltip = fire_adm_advisor_tooltip
			has_country_flag = just_fired_adm_advisor
		}
	}
    task_completed_effect = {
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 10
		}
		clr_country_flag = just_fired_adm_advisor
		clr_country_flag = need_to_fire_adm_advisor
	}
	invalid_trigger = {
		NOT = {
			employed_advisor = {
				category = ADM
			}
		}
		NOT = { has_country_flag = just_fired_adm_advisor }
	}
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
		clr_country_flag = need_to_fire_adm_advisor
    }
}

th_tenma_demands_hire_dip_advisor = {
	max_days_active = 1825
	can_select = {
		NOT = { has_country_flag = th_has_tengu_demands_instead_of_agendas }
		NOT = {
			employed_advisor = {
				category = DIP
			}
		}
	}
	selection_weight = {
		factor = 1
	}
	task_requirements = {
		employed_advisor = {
			category = DIP
		}
		is_in_deficit = no
	}
    task_completed_effect = {
		add_dip_power = 25
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 5
		}
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
}

th_tenma_demands_fire_dip_advisor = {
	max_days_active = 1825
	can_select = {
		NOT = { has_country_flag = th_has_tengu_demands_instead_of_agendas }
		employed_advisor = {
			category = DIP
		}
	}
	selection_weight = {
		factor = 1
		modifier = {
			factor = 0.5
			always = yes
		}
	}
	immediate_effect = {
		hidden_effect = {
			set_country_flag = need_to_fire_dip_advisor
		}
	}
	on_invalid = {
		clr_country_flag = need_to_fire_dip_advisor
	}
	task_requirements = {
		custom_trigger_tooltip = {
			tooltip = fire_dip_advisor_tooltip
			has_country_flag = just_fired_dip_advisor
		}
	}
    task_completed_effect = {
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 10
		}
		clr_country_flag = just_fired_dip_advisor
		clr_country_flag = need_to_fire_dip_advisor
	}
	invalid_trigger = {
		NOT = {
			employed_advisor = {
				category = DIP
			}
		}
		NOT = { has_country_flag = just_fired_dip_advisor }
	}
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
		clr_country_flag = need_to_fire_dip_advisor
    }
}

th_tenma_demands_hire_mil_advisor = {
	max_days_active = 1825
	can_select = {
		NOT = { has_country_flag = th_has_tengu_demands_instead_of_agendas }
		NOT = {
			employed_advisor = {
				category = MIL
			}
		}
	}
	selection_weight = {
		factor = 1
	}
	task_requirements = {
		employed_advisor = {
			category = MIL
		}
		is_in_deficit = no
	}
    task_completed_effect = {
		add_mil_power = 25
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 5
		}
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
}

th_tenma_demands_fire_mil_advisor = {
	max_days_active = 1825
	can_select = {
		NOT = { has_country_flag = th_has_tengu_demands_instead_of_agendas }
		employed_advisor = {
			category = MIL
		}
	}
	selection_weight = {
		factor = 1
		modifier = {
			factor = 0.5
			always = yes
		}
	}
	immediate_effect = {
		hidden_effect = {
			set_country_flag = need_to_fire_mil_advisor
		}
	}
	on_invalid = {
		clr_country_flag = need_to_fire_mil_advisor
	}
	task_requirements = {
		custom_trigger_tooltip = {
			tooltip = fire_mil_advisor_tooltip
			has_country_flag = just_fired_mil_advisor
		}
	}
    task_completed_effect = {
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 10
		}
		clr_country_flag = just_fired_mil_advisor
		clr_country_flag = need_to_fire_mil_advisor
	}
	invalid_trigger = {
		NOT = {
			employed_advisor = {
				category = MIL
			}
		}
		NOT = { has_country_flag = just_fired_mil_advisor }
	}
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
		clr_country_flag = need_to_fire_mil_advisor
    }
}

#Pay Monetary Tribute
th_tenma_demands_pay_monetary_tribute = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		is_bankrupt = no
		NOT = { num_of_loans = 10 }
	}
	provinces_to_highlight = {}
	selection_weight = {
		factor = 1
	}
	pre_effect = {}
	immediate_effect = {}
	task_requirements = {
		years_of_income = 0.5
	}
    task_completed_effect = {
		add_years_of_income = -0.5
		add_country_modifier = {
			name = th_tenma_paid_tribute
			duration = 1825
		}
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = {
		OR = {
			num_of_loans = 10
			is_bankrupt = yes
		}
	}
	on_invalid = {}
	invalid_trigger = {}
	modifier = {}
}

#Forces for Tenma's Body Guards
th_tenma_demands_send_body_guards = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		is_at_war = no
	}
	provinces_to_highlight = {}
	selection_weight = {
		factor = 1
	}
	pre_effect = {}
	immediate_effect = {}
	task_requirements = {
		manpower_percentage = 0.3
	}
    task_completed_effect = {
		add_yearly_manpower = -3
		add_years_of_income = 2
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 5
		}
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = {
		is_at_war = yes
	}
	on_invalid = {}
	invalid_trigger = {}
	modifier = {
		stability_cost_to_declare_war = 1
		manpower_recovery_speed = 0.15
	}
}

#Win Humiliation War
th_tenma_demands_win_humiliation_war = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		is_free_or_tributary_trigger = yes
		is_at_war = no
		any_rival_country = {
			NOT = { truce_with = ROOT }
		}
	}
	provinces_to_highlight = {
		is_capital_of = event_target:agenda_country
	}
	selection_weight = {
		factor = 1
	}
	pre_effect = {
		random_rival_country = {
			limit = {
				NOT = { truce_with = ROOT }
			}
			save_event_target_as = agenda_country
			capital_scope = {
				save_event_target_as = agenda_province
			}
		}
	}
	immediate_effect = {}
	task_requirements = {
		event_target:agenda_country = {
			OR = {
				humiliated_by = ROOT
				exists = no
				NOT = { is_enemy = ROOT }
			}
		}
	}
    task_completed_effect = {
		add_adm_power = 150
		add_dip_power = 150
		add_mil_power = 150
		add_power_projection = {
			type = mission_rewards_power_projection
			amount = 40
		}
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 5
		}
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = {
		event_target:agenda_country = {
			OR = {
				ROOT = { humiliated_by = PREV }
				AND = {
					NOT = { humiliated_by = ROOT }
					truce_with = ROOT
				}
			}
		}
	}
	on_invalid = {}
	invalid_trigger = {}
	modifier = {}
}

#Peace please
th_tenma_demands_restore_peace = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		is_at_war = yes
	}
	provinces_to_highlight = {}
	selection_weight = {
		factor = 1
	}
	pre_effect = {}
	immediate_effect = {}
	task_requirements = {
		is_at_war = no
	}
    task_completed_effect = {
		add_stability_or_adm_power = yes
		add_estate_loyalty = {
			estate = all
			loyalty = 20
		}
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = {
		
	}
	on_invalid = {}
	invalid_trigger = {}
	modifier = {
		war_exhaustion = 0.05
	}
}

#Spread Good Image
th_tenma_demands_spread_good_image = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		any_known_country = {
			NOT = { is_rival = root }
			ROOT = { NOT = { is_rival = prev } }
			OR = {
				is_free_or_tributary_trigger = yes
				is_subject_of = root
			}
			NOT = { war_with = root }
			NOT = { has_opinion = { who = root value = 50 } }
			has_opinion = { who = root value = -50 }
			religion_group = root
			NOT = {
				any_owned_province = {
					is_core = root
				}
			}
			NOT = {
				border_distance = {
					who = root
					distance = 200
				}
			}
		}
	}
	provinces_to_highlight = {
		is_capital_of = event_target:agenda_country
	}
	selection_weight = {
		factor = 1
		modifier = {
			factor = 1.5
			any_known_country = {
				OR = {
					army_size = root
					alliance_with = root
				}
				NOT = { is_rival = root }
				ROOT = { NOT = { is_rival = prev } }
				OR = {
					is_free_or_tributary_trigger = yes
					is_subject_of = root
				}
				NOT = { war_with = root }
				NOT = { has_opinion = { who = root value = 50 } }
				has_opinion = { who = root value = -50 }
				religion_group = root
				NOT = {
					any_owned_province = {
						is_core = root
					}
				}
				NOT = {
					border_distance = {
						who = root
						distance = 200
					}
				}
			}
		}
		modifier = {
			factor = 0.5
			NOT = { num_of_free_diplomatic_relations = 1 }
		}
	}
	pre_effect = {
		set_variable = {
			which = estate_great_tengu_relations_with_X
			value = 0
		}
		random_known_country = {
			limit = {
				NOT = { is_rival = root }
				ROOT = { NOT = { is_rival = prev } }
				OR = {
					is_free_or_tributary_trigger = yes
					is_subject_of = root
				}
				NOT = { war_with = root }
				NOT = { has_opinion = { who = root value = 50 } }
				has_opinion = { who = root value = -50 }
				religion_group = root
				NOT = {
					any_owned_province = {
						is_core = root
					}
				}
				NOT = {
					border_distance = {
						who = root
						distance = 200
					}
				}
			}
			save_event_target_as = agenda_country
		}
		random_known_country = {
			limit = {
				OR = {
					army_size = root
					alliance_with = root
				}
				NOT = { is_rival = root }
				ROOT = { NOT = { is_rival = prev } }
				OR = {
					is_free_or_tributary_trigger = yes
					is_subject_of = root
				}
				NOT = { war_with = root }
				NOT = { has_opinion = { who = root value = 50 } }
				has_opinion = { who = root value = -50 }
				religion_group = root
				NOT = {
					any_owned_province = {
						is_core = root
					}
				}
				NOT = {
					border_distance = {
						who = root
						distance = 200
					}
				}
			}
			save_event_target_as = agenda_country
		}
		if = {
			limit = {
				event_target:agenda_country = {
					NOT = { has_opinion = { who = root value = 0 } }
				}
			}
			set_variable = {
				which = estate_great_tengu_relations_with_X
				value = 1
			}
		}
		else = {
			set_variable = {
				which = estate_great_tengu_relations_with_X
				value = 2
			}
		}
	}
	immediate_effect = {}
	task_requirements = {
		if = {
			limit = {
				check_variable = {
					which = estate_great_tengu_relations_with_X
					value = 2
				}
			}
			event_target:agenda_country = {
				has_opinion = {
					who = root
					value = 100
				}
			}
		}
		else = {
			event_target:agenda_country = {
				has_opinion = {
					who = root
					value = 50
				}
			}
		}
	}
    task_completed_effect = {
		FROM = {
			ROOT = {
				add_favors = {
					who = PREV
					amount = 15
				}
			}
		}
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 5
		}
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = {
		event_target:agenda_country = {
			OR = {
				NOT = { num_of_cities = 1 }
				war_with = root
				NOT = { has_opinion = { who = root value = -100 } }
			}
		}
	}
	on_invalid = {}
	invalid_trigger = {}
	modifier = {}
}

#Sell Newspaper
th_tenma_demands_sell_newspaper = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		has_government_attribute = enables_tengu_newspaper
		any_known_country = {
			NOT = { is_rival = ROOT }
			NOT = { is_enemy = ROOT }
			NOT = { war_with = ROOT }
			OR = {
				NOT = { has_country_flag = th_received_newspaper_from_@ROOT }
				had_country_flag = {
					flag = th_received_newspaper_from_@ROOT
					days = 3650
				}
			}
			is_free_or_tributary_trigger = yes
			is_bankrupt = no
			monthly_income = ROOT
		}
		any_owned_province = {
			trade_goods = paper
			NOT = { has_province_modifier = th_is_selling_exclusive_newspaper }
		}
	}
	provinces_to_highlight = {
		is_capital_of = event_target:agenda_country
	}
	selection_weight = {
		factor = 1
	}
	pre_effect = {
		random_known_country = {
			limit = {
				NOT = { is_rival = ROOT }
				NOT = { is_enemy = ROOT }
				NOT = { war_with = ROOT }
				OR = {
					NOT = { has_country_flag = th_received_newspaper_from_@ROOT }
					had_country_flag = {
						flag = th_received_newspaper_from_@ROOT
						days = 3650
					}
				}
				is_free_or_tributary_trigger = yes
				is_bankrupt = no
				monthly_income = ROOT
			}
			save_event_target_as = agenda_country
		}
	}
	immediate_effect = {}
	task_requirements = {
		custom_trigger_tooltip = {
			tooltip = th_tenma_demands_sell_newspaper_tt
			event_target:agenda_country = {
				has_country_flag = th_received_newspaper_from_@ROOT
				NOT = {
					had_country_flag = {
						flag = th_received_newspaper_from_@ROOT
						days = 3650
					}
				}
			}
		}
	}
    task_completed_effect = {
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 5
		}
		add_estate_loyalty = {
			estate = estate_crow_tengu
			loyalty = 20
		}
		add_mercantilism = 1
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = {
		event_target:agenda_country = {
			OR = {
				exists = no
				war_with = ROOT
				is_subject_other_than_tributary_trigger = yes
			}
		}
	}
	on_invalid = {}
	invalid_trigger = {}
	modifier = {}
}

#Buy off Newspaper
th_tenma_demands_buy_newspaper = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		any_known_country = {
			NOT = { is_rival = ROOT }
			NOT = { is_enemy = ROOT }
			NOT = { war_with = ROOT }
			OR = {
				alliance_with = ROOT
				total_development = ROOT
			}
			OR = {
				NOT = { has_country_flag = th_got_its_newspaper_bought_by_@ROOT }
				had_country_flag = {
					flag = th_got_its_newspaper_bought_by_@ROOT
					days = 3650
				}
			}
			is_free_or_tributary_trigger = yes
		}
	}
	provinces_to_highlight = {
		is_capital_of = event_target:agenda_country
	}
	selection_weight = {
		factor = 1
	}
	pre_effect = {
		random_known_country = {
			limit = {
				NOT = { is_rival = ROOT }
				NOT = { is_enemy = ROOT }
				NOT = { war_with = ROOT }
				OR = {
					alliance_with = ROOT
					total_development = ROOT
				}
				OR = {
					NOT = { has_country_flag = th_got_its_newspaper_bought_by_@ROOT }
					had_country_flag = {
						flag = th_got_its_newspaper_bought_by_@ROOT
						days = 3650
					}
				}
				is_free_or_tributary_trigger = yes
			}
			save_event_target_as = agenda_country
		}
	}
	immediate_effect = {}
	task_requirements = {
		event_target:agenda_country = {
			custom_trigger_tooltip = {
				tooltip = th_tenma_demands_buy_newspaper_tt
				has_country_flag = th_got_its_newspaper_bought_by_@ROOT
				NOT = {
					had_country_flag = {
						flag = th_got_its_newspaper_bought_by_@ROOT
						days = 3650
					}
				}
			}
		}
	}
    task_completed_effect = {
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 5
		}
		add_estate_loyalty = {
			estate = estate_crow_tengu
			loyalty = 20
		}
		add_mercantilism = 1
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = {
		event_target:agenda_country = {
			OR = {
				exists = no
				war_with = ROOT
				is_subject_other_than_tributary_trigger = yes
			}
		}
	}
	on_invalid = {}
	invalid_trigger = {}
	modifier = {}
}

#Improve our Prestige
th_tenma_demands_gain_prestige = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		NOT = { prestige = 50 }
	}
	provinces_to_highlight = {}
	selection_weight = {
		factor = 1
	}
	pre_effect = {
		set_variable = {
			which = estate_great_tengu_improve_prestige_var
			value = 0
		}
		if = {
			limit = {
				NOT = {
					prestige = -10
				}
			}
			set_variable = {
				which = estate_great_tengu_improve_prestige_var
				value = 1
			}
		}
		else_if = {
			limit = {
				NOT = {
					prestige = 15
				}
			}
			set_variable = {
				which = estate_great_tengu_improve_prestige_var
				value = 2
			}
		}
		else = {
			set_variable = {
				which = estate_great_tengu_improve_prestige_var
				value = 3
			}
		}
	}
	immediate_effect = {}
	task_requirements = {
		if = {
			limit = {
				check_variable = {
					which = estate_great_tengu_improve_prestige_var
					value = 3
				}
			}
			prestige = 50
		}
		else_if = {
			limit = {
				check_variable = {
					which = estate_great_tengu_improve_prestige_var
					value = 2
				}
			}
			prestige = 30
		}
		else = {
			prestige = 10
		}
	}
    task_completed_effect = {
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 10
		}
		add_adm_power = 25
		add_dip_power = 25
		add_mil_power = 25
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = {}
	on_invalid = {}
	invalid_trigger = {}
	modifier = {}
}

#Project more Power
th_tenma_demands_gain_power_projection = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		NOT = { power_projection = 30 }
	}
	provinces_to_highlight = {}
	selection_weight = {
		factor = 1
	}
	pre_effect = {}
	immediate_effect = {}
	task_requirements = {
		power_projection = 30
	}
    task_completed_effect = {
		random_list = {
			1 = {
				define_advisor = {
					type = theologian
					skill = 2
					cost_multiplier = 0.25
				}
			}
			1 = {
				define_advisor = {
					type = statesman
					skill = 2
					cost_multiplier = 0.25
				}
			}
			1 = {
				define_advisor = {
					type = grand_captain
					skill = 2
					cost_multiplier = 0.25
				}
			}
		}
		add_estate_loyalty = {
			estate = all
			loyalty = 10
		}
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = {
		th_is_subject_other_than_tributary_trigger = yes
	}
	on_invalid = {}
	invalid_trigger = {}
	modifier = {}
}

#Remove Crow Tengu Privileges
th_tenma_demands_remove_crow_tengu_privileges = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		has_estate = estate_crow_tengu
		estate_influence = {
			estate = estate_crow_tengu
			influence = 60
		}
		NOT = { has_disaster = estate_crow_tengu_disaster }
	}
	provinces_to_highlight = {}
	selection_weight = {
		factor = 1
	}
	pre_effect = {
		set_variable = {
			which = th_tenma_reduce_influence_var
			value = 0
		}
		if = {
			limit = {
				estate_influence = {
					estate = estate_crow_tengu
					influence = 80
				}
			}
			set_variable = {
				which = th_tenma_reduce_influence_var
				value = 1
			}
		}
		else_if = {
			limit = {
				estate_influence = {
					estate = estate_crow_tengu
					influence = 60
				}
			}
			set_variable = {
				which = th_tenma_reduce_influence_var
				value = 2
			}
		}
		else_if = {
			limit = {
				estate_influence = {
					estate = estate_crow_tengu
					influence = 40
				}
			}
			set_variable = {
				which = th_tenma_reduce_influence_var
				value = 3
			}
		}
	}
	immediate_effect = {}
	task_requirements = {
		if = {
			limit = {
				check_variable = {
					which = th_tenma_reduce_influence_var
					value = 3
				}
			}
			NOT = {
				estate_influence = {
					estate = estate_crow_tengu
					influence = 30
				}
			}
		}
		else_if = {
			limit = {
				check_variable = {
					which = th_tenma_reduce_influence_var
					value = 2
				}
			}
			NOT = {
				estate_influence = {
					estate = estate_crow_tengu
					influence = 40
				}
			}
		}
		else_if = {
			limit = {
				check_variable = {
					which = th_tenma_reduce_influence_var
					value = 1
				}
			}
			NOT = {
				estate_influence = {
					estate = estate_crow_tengu
					influence = 60
				}
			}
		}
		else = {
			NOT = {
				estate_influence = {
					estate = estate_crow_tengu
					influence = 20
				}
			}
		}
	}
    task_completed_effect = {
		add_estate_loyalty = {
			estate = all
			loyalty = 10
		}
		add_dip_power = 50
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = {
		has_disaster = estate_crow_tengu_disaster
	}
	on_invalid = {}
	invalid_trigger = {}
	modifier = {}
}

#Remove Wolf Tengu Privileges
th_tenma_demands_remove_wolf_tengu_privileges = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		has_estate = estate_wolf_tengu
		estate_influence = {
			estate = estate_wolf_tengu
			influence = 60
		}
		NOT = { has_disaster = estate_wolf_tengu_disaster }
	}
	provinces_to_highlight = {}
	selection_weight = {
		factor = 1
	}
	pre_effect = {
		set_variable = {
			which = th_tenma_reduce_influence_var
			value = 0
		}
		if = {
			limit = {
				estate_influence = {
					estate = estate_wolf_tengu
					influence = 80
				}
			}
			set_variable = {
				which = th_tenma_reduce_influence_var
				value = 1
			}
		}
		else_if = {
			limit = {
				estate_influence = {
					estate = estate_wolf_tengu
					influence = 60
				}
			}
			set_variable = {
				which = th_tenma_reduce_influence_var
				value = 2
			}
		}
		else_if = {
			limit = {
				estate_influence = {
					estate = estate_wolf_tengu
					influence = 40
				}
			}
			set_variable = {
				which = th_tenma_reduce_influence_var
				value = 3
			}
		}
	}
	immediate_effect = {}
	task_requirements = {
		if = {
			limit = {
				check_variable = {
					which = th_tenma_reduce_influence_var
					value = 3
				}
			}
			NOT = {
				estate_influence = {
					estate = estate_wolf_tengu
					influence = 30
				}
			}
		}
		else_if = {
			limit = {
				check_variable = {
					which = th_tenma_reduce_influence_var
					value = 2
				}
			}
			NOT = {
				estate_influence = {
					estate = estate_wolf_tengu
					influence = 40
				}
			}
		}
		else_if = {
			limit = {
				check_variable = {
					which = th_tenma_reduce_influence_var
					value = 1
				}
			}
			NOT = {
				estate_influence = {
					estate = estate_wolf_tengu
					influence = 60
				}
			}
		}
		else = {
			NOT = {
				estate_influence = {
					estate = estate_wolf_tengu
					influence = 20
				}
			}
		}
	}
    task_completed_effect = {
		add_estate_loyalty = {
			estate = all
			loyalty = 10
		}
		add_mil_power = 50
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = { has_disaster = estate_wolf_tengu_disaster }
	on_invalid = {}
	invalid_trigger = {}
	modifier = {}
}

#Remove Shrine Maiden Privileges
th_tenma_demands_remove_church_privileges = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		has_estate = estate_church
		estate_influence = {
			estate = estate_church
			influence = 60
		}
		NOT = { has_disaster = estate_church_disaster }
	}
	provinces_to_highlight = {}
	selection_weight = {
		factor = 1
	}
	pre_effect = {
		set_variable = {
			which = th_tenma_reduce_influence_var
			value = 0
		}
		if = {
			limit = {
				estate_influence = {
					estate = estate_church
					influence = 80
				}
			}
			set_variable = {
				which = th_tenma_reduce_influence_var
				value = 1
			}
		}
		else_if = {
			limit = {
				estate_influence = {
					estate = estate_church
					influence = 60
				}
			}
			set_variable = {
				which = th_tenma_reduce_influence_var
				value = 2
			}
		}
		else_if = {
			limit = {
				estate_influence = {
					estate = estate_church
					influence = 40
				}
			}
			set_variable = {
				which = th_tenma_reduce_influence_var
				value = 3
			}
		}
	}
	immediate_effect = {}
	task_requirements = {
		if = {
			limit = {
				check_variable = {
					which = th_tenma_reduce_influence_var
					value = 3
				}
			}
			NOT = {
				estate_influence = {
					estate = estate_church
					influence = 30
				}
			}
		}
		else_if = {
			limit = {
				check_variable = {
					which = th_tenma_reduce_influence_var
					value = 2
				}
			}
			NOT = {
				estate_influence = {
					estate = estate_church
					influence = 40
				}
			}
		}
		else_if = {
			limit = {
				check_variable = {
					which = th_tenma_reduce_influence_var
					value = 1
				}
			}
			NOT = {
				estate_influence = {
					estate = estate_church
					influence = 60
				}
			}
		}
		else = {
			NOT = {
				estate_influence = {
					estate = estate_church
					influence = 20
				}
			}
		}
	}
    task_completed_effect = {
		add_estate_loyalty = {
			estate = all
			loyalty = 10
		}
		add_adm_power = 50
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = { has_disaster = estate_church_disaster }
	on_invalid = {}
	invalid_trigger = {}
	modifier = {}
}

#Add Great Tengu Privileges
th_tenma_demands_add_great_tengu_privileges = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		NOT = {
			num_of_estate_privileges = {
				estate = estate_great_tengu
				value = 2
			}
		}
	}
	provinces_to_highlight = {}
	selection_weight = {
		factor = 1
	}
	pre_effect = {
		set_variable = {
			which = th_tengu_demands_three_privileges_var
			value = 0
		}
		if = {
			limit = {
				num_of_estate_privileges = {
					estate = estate_great_tengu
					value = 1
				}
			}
			set_variable = {
				which = th_tengu_demands_three_privileges_var
				value = 2
			}
		}
		else = {
			set_variable = {
				which = th_tengu_demands_three_privileges_var
				value = 1
			}
		}
	}
	immediate_effect = {}
	task_requirements = {
		if = {
			limit = {
				check_variable = {
					which = th_tengu_demands_three_privileges_var
					value = 2
				}
			}
			num_of_estate_privileges = {
				estate = estate_great_tengu
				value = 3
			}
		}
		else = {
			num_of_estate_privileges = {
				estate = estate_great_tengu
				value = 2
			}
		}
	}
    task_completed_effect = {
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 20
		}
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = {}
	on_invalid = {}
	invalid_trigger = {}
	modifier = {}
}

#Get rid of Corruption
th_tenma_demands_get_rid_of_corruption = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		corruption = 2
	}
	provinces_to_highlight = {}
	selection_weight = {
		factor = 1
	}
	pre_effect = {}
	immediate_effect = {}
	task_requirements = {
		NOT = { corruption = 0.5 }
	}
    task_completed_effect = {
		add_estate_loyalty = {
			estate = all
			loyalty = 5
		}
		change_government_reform_progress = 25
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = {
		corruption = 5
	}
	on_invalid = {}
	invalid_trigger = {}
	modifier = {}
}

#Get rid of debt
th_tenma_demands_get_rid_of_debt = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		num_of_loans = 5
		is_bankrupt = no
		NOT = { num_of_loans = 15 }
	}
	provinces_to_highlight = {}
	selection_weight = {
		factor = 1
	}
	pre_effect = {}
	immediate_effect = {}
	task_requirements = {
		NOT = { num_of_loans = 1 }
		is_bankrupt = no
	}
    task_completed_effect = {
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 10
		}
		add_country_modifier = {
			name = th_tenma_recovering_economy
			duration = 1825
		}
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = {
		OR = {
			num_of_loans = 15
			is_bankrupt = yes
		}
	}
	on_invalid = {}
	invalid_trigger = {}
	modifier = {}
}

#Get rid of war exhaustion
th_tenma_demands_get_rid_of_war_exhaustion = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		war_exhaustion = 2
		NOT = { war_exhaustion = 10 }
	}
	provinces_to_highlight = {}
	selection_weight = {
		factor = 1
	}
	pre_effect = {}
	immediate_effect = {}
	task_requirements = {
		NOT = { war_exhaustion = 0.5 }
	}
    task_completed_effect = {
		add_yearly_manpower = 1
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 10
		}
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = {
		war_exhaustion = 10
	}
	on_invalid = {}
	invalid_trigger = {}
	modifier = {}
}

#End the Disaster
th_tenma_demands_end_the_disaster = {
	max_days_active = 1825
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		has_any_disaster = yes
	}
	provinces_to_highlight = {}
	selection_weight = {
		factor = 1
	}
	pre_effect = {}
	immediate_effect = {}
	task_requirements = {
		has_any_disaster = no
		is_bankrupt = no
	}
    task_completed_effect = {
		add_stability_or_adm_power = yes
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 30
		}
		add_legitimacy_equivalent = {
			amount = 10
			republican_tradition = 5
		}
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
	fail_if = {}
	on_invalid = {}
	invalid_trigger = {}
	modifier = {}
}

#Develop tax
th_tenma_demands_develop_x_tax = {
	max_days_active = 1825
	selection_weight = {
		factor = 1
	}
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		capital_scope = {
			is_state_core = root
		}
	}
	pre_effect = {
		random_list = {
			1 = {
				random_owned_province = {
					limit = {
						is_state_core = root
						area_for_scope_province = {
							is_capital_of = root
						}
					}
					save_event_target_as = agenda_province
				}
			}
			2 = {
				trigger = {
					any_owned_province = {
						is_state_core = root
						OR = {
							AND = {
								religion = root
								OR = {
									culture = root
									has_owner_accepted_culture = yes
								}
							}
						}
						region_for_scope_province = {
							is_capital_of = root
						}
					}
				}
				random_owned_province = {
					limit = {
						is_state_core = root
						OR = {
							AND = {
								religion = root
								OR = {
									culture = root
									has_owner_accepted_culture = yes
								}
							}
						}
						region_for_scope_province = {
							is_capital_of = root
						}
					}
					save_event_target_as = agenda_province
				}
			}
			1 = {
				random_owned_province = {
					limit = {
						is_state_core = root
					}
					save_event_target_as = agenda_province
				}
			}
		}
		event_target:agenda_province = {
			if = {
				limit = {
					check_variable = {
						which = province_adm_var
						value = 1
					}
				}
				set_variable = {
					which = province_adm_var
					value = 0
				}
			}
			export_to_variable = {
				which = province_adm_var
				value = trigger_value:base_tax
			}
			change_variable = {
				which = province_adm_var
				value = 2
			}
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_province
	}
	fail_if = {
		event_target:agenda_province = {
			NOT = { owned_by = root }
		}
	}
    task_requirements = {
		event_target:agenda_province = {
			base_tax = "province_adm_var"
		}
    }
    task_completed_effect = {
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 5
		}
		event_target:agenda_province = {
			add_province_modifier = {
				name = th_tenma_local_bureaucrats
				duration = 9125
			}
		}
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
}
#Develop production
th_tenma_demands_develop_x_production = {
	max_days_active = 1825
	selection_weight = {
		factor = 1
	}
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		capital_scope = {
			is_state_core = root
		}
	}
	pre_effect = {
		random_list = {
			1 = {
				random_owned_province = {
					limit = {
						is_state_core = root
						area_for_scope_province = {
							is_capital_of = root
						}
					}
					save_event_target_as = agenda_province
				}
			}
			2 = {
				trigger = {
					any_owned_province = {
						is_state_core = root
						OR = {
							AND = {
								religion = root
								OR = {
									culture = root
									has_owner_accepted_culture = yes
								}
							}
						}
						region_for_scope_province = {
							is_capital_of = root
						}
					}
				}
				random_owned_province = {
					limit = {
						is_state_core = root
						OR = {
							AND = {
								religion = root
								OR = {
									culture = root
									has_owner_accepted_culture = yes
								}
							}
						}
						region_for_scope_province = {
							is_capital_of = root
						}
					}
					save_event_target_as = agenda_province
				}
			}
			1 = {
				random_owned_province = {
					limit = {
						is_state_core = root
					}
					save_event_target_as = agenda_province
				}
			}
		}
		event_target:agenda_province = {
			if = {
				limit = {
					check_variable = {
						which = province_dip_var
						value = 1
					}
				}
				set_variable = {
					which = province_dip_var
					value = 0
				}
			}
			export_to_variable = {
				which = province_dip_var
				value = trigger_value:base_production
			}
			change_variable = {
				which = province_dip_var
				value = 2
			}
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_province
	}
	fail_if = {
		event_target:agenda_province = {
			NOT = { owned_by = root }
		}
	}
    task_requirements = {
		event_target:agenda_province = {
			base_production = "province_dip_var"
		}
    }
    task_completed_effect = {
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 5
		}
		event_target:agenda_province = {
			add_province_modifier = {
				name = th_tenma_local_craftsmen
				duration = 9125
			}
		}
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
}
#Develop manpower
th_tenma_demands_develop_x_manpower = {
	max_days_active = 1825
	selection_weight = {
		factor = 1
	}
	can_select = {
		has_country_flag = th_has_tengu_demands_instead_of_agendas
		capital_scope = {
			is_state_core = root
		}
	}
	pre_effect = {
		random_list = {
			1 = {
				random_owned_province = {
					limit = {
						is_state_core = root
						area_for_scope_province = {
							is_capital_of = root
						}
					}
					save_event_target_as = agenda_province
				}
			}
			2 = {
				trigger = {
					any_owned_province = {
						is_state_core = root
						OR = {
							AND = {
								religion = root
								OR = {
									culture = root
									has_owner_accepted_culture = yes
								}
							}
						}
						region_for_scope_province = {
							is_capital_of = root
						}
					}
				}
				random_owned_province = {
					limit = {
						is_state_core = root
						OR = {
							AND = {
								religion = root
								OR = {
									culture = root
									has_owner_accepted_culture = yes
								}
							}
						}
						region_for_scope_province = {
							is_capital_of = root
						}
					}
					save_event_target_as = agenda_province
				}
			}
			1 = {
				random_owned_province = {
					limit = {
						is_state_core = root
					}
					save_event_target_as = agenda_province
				}
			}
		}
		event_target:agenda_province = {
			if = {
				limit = {
					check_variable = {
						which = province_mil_var
						value = 1
					}
				}
				set_variable = {
					which = province_mil_var
					value = 0
				}
			}
			export_to_variable = {
				which = province_mil_var
				value = trigger_value:base_manpower
			}
			change_variable = {
				which = province_mil_var
				value = 2
			}
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_province
	}
	fail_if = {
		event_target:agenda_province = {
			NOT = { owned_by = root }
		}
	}
    task_requirements = {
		event_target:agenda_province = {
			base_manpower = "province_mil_var"
		}
    }
    task_completed_effect = {
		add_estate_loyalty = {
			estate = estate_great_tengu
			loyalty = 5
		}
		event_target:agenda_province = {
			add_province_modifier = {
				name = th_tenma_local_soldier_household
				duration = 9125
			}
		}
    }
    failing_effect = {
		if = {
			limit = {
				ai = no
			}
			add_estate_loyalty_modifier = {
				estate = estate_great_tengu
				desc = EST_VAL_AGENDA_DENIED
				loyalty = -10
				duration = 3650
			}
			add_estate_loyalty = {
				estate = estate_great_tengu
				loyalty = -15
			}
			reduce_stability_or_adm_power = yes
		}
    }
}