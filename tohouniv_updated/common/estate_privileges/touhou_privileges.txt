#All scopes are country scope
#All parameters are optional

# estate_privilege = {
# 	is_valid = { triggers }						#Conditions for whether it is possible for the country to have this privilege (it will not display on the list if they are false, and will be revoked if it has already been granted)
# 	can_select = { triggers } 					#Conditions for whether the country is allowed to select the privilege (with conditions for why not displayed)
# 	on_granted = { effects } 					#Effects executed immediately upon the privilege being taken
# 	can_revoke = { triggers } 					#Conditions for whether the country can revoke the privilege
# 	on_revoked = { effects } 					#Effects executed upon the privilege being revoked by the country
# 	on_invalid = { effects } 					#Effects executed upon the privilege being removed due to invalidity (is_valid becomes false or the estate is removed)
# 	penalties = { modifiers } 					#Negative modifiers granted while the privilege is active (creates different tooltip to benefits)
# 	conditional_modifier = { 					#Modifier that are applied if the specified conditions are true.
# 		trigger = { triggers }
# 		modifier = { modifiers }
# 		is_bad = yes/no							#Specifies whether the modifier should be listed as positive or negative in the tooltips.
# 	}
# 	modifier_by_land_ownership = { modifiers } 	#Multiplies the modifier by the % of land owned by the estate.
# 	mechanics = { mechanics } 					#Special mechanics the privilege enables
# 	cooldown_years = int 						#Time limit before which the privilege cannot be revoked
# 	on_cooldown_expires = { effects }			#Effect executed once the specified cooldown_years timer has run down
#	ai_will_do									#If above ESTATE_PRIVILEGE_GRANT_THRESHOLD define, AI will try to apply. If below ESTATE_PRIVILEGE_REVOKE_THRESHOLD, AI will try to revoke.
# }

th_estate_church_flexible_deities = {
	icon = privilege_switch_hindu_deity
	max_absolutism = -5
	influence = 0.1
	is_valid = {
		OR = {
			religion = th_hakureishinto
			religion = th_moriyashinto
		}
		has_dlc = "Wealth of Nations"
	}
	can_select = {
		estate_influence = {
			estate = estate_church
			influence = 40
		}
	}
	on_granted = {
		custom_tooltip = th_estate_clerigy_flexible_deities_effect_tooltip
	}
	on_revoked = {
		custom_tooltip = th_estate_clerigy_flexible_deities_revoke_tooltip
	}
	penalties = {
	}
	benefits = {
	}
	ai_will_do = {
		factor = 0
	}
}

th_estate_church_force_conversion = {
	icon = privilege_recruit_inouisitor
	max_absolutism = -5
	influence = 0.05
	loyalty = 0.1
	is_valid = {
		has_country_flag = th_enabled_conversion_privilege_flag
	}
	can_select = {
	}
	on_granted = {
	}
	on_revoked = {
	}
	penalties = {
		tolerance_heretic = -2
		tolerance_heathen = -2
	}
	benefits = {
		enforce_religion_cost = -0.25
		tolerance_own = 1
	}
	ai_will_do = {
		factor = 0
	}
}

th_estate_church_danmaku_support = {
	icon = th_estate_church_danmaku_support
	max_absolutism = -5
	influence = 0.1
	loyalty = 0.0
	is_valid = {
		religion_group = Touhou
	}
	can_select = {
	}
	on_granted = {
		add_legitimacy = -20
		add_horde_unity = -20
		add_devotion = -20
		add_meritocracy = -10
		add_republican_tradition = -8
	}
	on_revoked = {
	}
	penalties = {
		prestige = -0.25
	}
	benefits = {
		danmaku_power_constant = 1.5
	}
	ai_will_do = {
		factor = 0
	}
}

th_estate_nobles_third_eye = {
	icon = th_privilege_third_eye
	max_absolutism = -5
	loyalty = 0.1
	influence = 0.1
	is_valid = {
		th_is_or_was_tag = {
			tag = CRD
		}
		num_of_subjects = 1
		any_subject_country = {
			NOT = { is_subject_of_type = tributary_state }
		}
		th_has_unlocked_privilege = {
			estate_privilege = th_estate_nobles_third_eye
		}
	}
	can_select = {
		legitimacy_equivalent = 75	#If Satori is not legitimate enough then why should any vassal obey her?
	}
	penalties = {
		legitimacy = -2
	}
	benefits = {
		vassal_upkeep = 0.01	#REALLY strong modifier
		diplomatic_upkeep = 2
	}
	ai_will_do = {
		factor = 1
		modifier = { #will lose it via invalid sooner or later
			factor = 10
			has_estate_privilege = th_estate_nobles_third_eye
		}
	}
}

th_estate_burghers_governmental_focus = {
	icon = th_estate_burghers_governmental_focus
	max_absolutism = -15
	influence = 0.15
	loyalty = 0.0
	is_valid = {
		OR = {
			culture_group = Gensokyan_culture
			religion_group = Touhou
		}
	}
	can_select = {
	}
	on_granted = {
	}
	on_revoked = {
	}
	penalties = {
		stability_cost_modifier = 0.3
	}
	benefits = {
		reform_progress_growth = 0.3
	}
	ai_will_do = {
		factor = 0
	}
}

th_estate_rival_kaguya_subsidize_eientei = {
	icon = privilege_take_money
	max_absolutism = -25
	influence = 0
	loyalty = 0.15
	is_valid = {
		has_reform = Gensokyan_mokou_states_reform
		NOT = { has_country_flag = th_disable_rival_privilege }
	}
	can_select = {
	}
	on_granted = {
	}
	on_revoked = {
	}
	penalties = {
		global_tax_modifier = -0.2
	}
	benefits = {
	}
	ai_will_do = {
		factor = 0
	}	
}

th_estate_rival_kaguya_satisfy_kaguya = {
	icon = th_estate_rivals_kaguya_happy
	max_absolutism = -25
	influence = 0
	loyalty = 0.15
	is_valid = {
		has_reform = Gensokyan_mokou_states_reform
		NOT = { has_country_flag = th_disable_rival_privilege }
	}
	can_select = {
	}
	on_granted = {
	}
	on_revoked = {
	}
	penalties = {
		advisor_pool = -1
		advisor_cost = 0.25
	}
	benefits = {
	}
	ai_will_do = {
		factor = 0
	}	
}

th_estate_rival_mokou_allow_more_human = {
	icon = privilege_get_unrest
	max_absolutism = -25
	influence = 0
	loyalty = 0.15
	is_valid = {
		has_reform = Gensokyan_kaguya_states_reform
		NOT = { has_country_flag = th_disable_rival_privilege }
	}
	can_select = {
	}
	on_granted = {
	}
	on_revoked = {
	}
	penalties = {
		global_unrest = 2
	}
	benefits = {
	}
	ai_will_do = {
		factor = 0
	}	
}

th_estate_rival_mokou_satisfy_mokou = {
	icon = th_estate_rivals_mokou_happy
	max_absolutism = -25
	influence = 0
	loyalty = 0.15
	is_valid = {
		has_reform = Gensokyan_kaguya_states_reform
		NOT = { has_country_flag = th_disable_rival_privilege }
	}
	can_select = {
	}
	on_granted = {
	}
	on_revoked = {
	}
	penalties = {
		manpower_recovery_speed = -0.15
	}
	benefits = {
	}
	ai_will_do = {
		factor = 0
	}	
}

th_estate_rival_allow_house_visits = {
	icon = th_estate_rivals_housevisits
	max_absolutism = -5
	influence = 0.05
	loyalty = 0.0
	is_valid = {
		OR = {
			has_reform = Gensokyan_kaguya_states_reform
			has_reform = Gensokyan_mokou_states_reform
		}
		NOT = { has_country_flag = th_disable_rival_privilege }
	}
	can_select = {
	}
	on_granted = {
		custom_tooltip = th_estate_rival_allow_house_visits_at
		hidden_effect = { set_country_flag = th_estate_rivals_allow_unannounced_visits }
	}
	on_revoked = {
		custom_tooltip = th_estate_rival_allow_house_visits_bt
		hidden_effect = { clr_country_flag = th_estate_rivals_allow_unannounced_visits }
	}
	on_invalid = {
		custom_tooltip = th_estate_rival_allow_house_visits_bt
		hidden_effect = { clr_country_flag = th_estate_rivals_allow_unannounced_visits }
	}
	penalties = {
	}
	benefits = {
	}
	ai_will_do = {
		factor = 0
	}
}

th_estate_burghers_arctic_development = {
	icon = privilege_dev_cost
	land_share = 10
	max_absolutism = -5
	loyalty = 0.1
	influence = 0.05
	is_valid = {
		th_has_unlocked_privilege = {
			estate_privilege = th_estate_burghers_arctic_development
		}
	}
	can_select = {
	}
	on_granted = {
		mkn_enable_winter_adaptability = yes
		mkn_enable_winter_afinity = yes
	}
	on_revoked = {
		mkn_disable_winter_adaptability = yes
		mkn_disable_winter_afinity = yes
	}

	modifier_by_land_ownership = {
	}
	penalties = {
		all_power_cost = 0.01
	}
	benefits = {

	}
	ai_will_do = {
		factor = 100
	}
}

th_estate_nobles_unorganized_shinigami_authority = {
	icon = privilege_dev_cost
	land_share = 0
	max_absolutism = -20
	loyalty = 0.1
	influence = -0.05
	is_valid = {
		NOT = { has_country_flag = hig_has_dealt_with_slacking_komachi }
		NOT = { has_country_flag = hig_deactivated_unorganized_shinigami_authority }
	}
	can_select = {
		tag = HIG
		if = {
			limit = {
				ai = yes
				was_player = no
			}
			NOT = { is_year = 1460 }
		}
	}
	can_revoke = {
		estate_loyalty = {
			estate = estate_nobles
			loyalty = 65
		}
	}
	on_granted = {
	}
	on_revoked = {
		add_stability = -1
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -20
		}
		hidden_effect = {
			set_country_flag = hig_deactivated_unorganized_shinigami_authority
		}
	}
	on_invalid = {
		hidden_effect = {
			set_country_flag = hig_deactivated_unorganized_shinigami_authority
		}
	}

	modifier_by_land_ownership = {
	}
	penalties = {
		yama_authority_influence = -0.25
		yama_authority_modifier = -0.1
		development_cost = 0.1
		trade_efficiency = -0.2
	}
	benefits = {
	}
	mechanics = {
	}

	ai_will_do = {
		factor = 0
	}
}

th_estate_nobles_lack_of_overseers = {
	icon = privilege_dev_cost
	land_share = 0
	max_absolutism = -20
	loyalty = 0.1
	influence = -0.05
	is_valid = {
		NOT = { has_country_flag = hig_has_dealt_with_slacking_komachi }
		NOT = { has_country_flag = hig_deactivated_lack_of_overseers }
	}
	can_select = {
		tag = HIG
		if = {
			limit = {
				ai = yes
				was_player = no
			}
			NOT = { is_year = 1460 }
		}
	}
	can_revoke = {
		estate_loyalty = {
			estate = estate_nobles
			loyalty = 65
		}
	}
	on_granted = {
		custom_tooltip = th_estate_nobles_lack_of_overseers_granted_tt
	}
	on_revoked = {
		custom_tooltip = th_estate_nobles_lack_of_overseers_revoked_rt
		add_stability = -1
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -20
		}
		hidden_effect = {
			set_country_flag = hig_deactivated_lack_of_overseers
		}
	}
	on_invalid = {
		hidden_effect = {
			set_country_flag = hig_deactivated_lack_of_overseers
		}
	}

	on_granted_province = {
		if = {
			limit = {
				OR = {
					area = Land_of_the_dead
					area = Eastern_higan
					area = Higan_southern_coast
				}
			}
			add_local_autonomy = 50
			add_province_modifier = {
				name = hig_slacking_shinigami
				duration = -1
			}
		}
	}
	on_revoked_province = {
		if = {
			limit = {
				has_province_modifier = hig_slacking_shinigami
			}
			remove_province_modifier = hig_slacking_shinigami
			add_local_autonomy = -100
		}
	}
	on_invalid_province = {
		if = {
			limit = {
				has_province_modifier = hig_slacking_shinigami
			}
			remove_province_modifier = hig_slacking_shinigami
			add_local_autonomy = -100
		}
	}

	modifier_by_land_ownership = {
	}
	penalties = {
	}
	benefits = {
	}
	mechanics = {
	}

	ai_will_do = {
		factor = 0
	}
}

th_estate_nobles_slacking_shinigami = {
	icon = privilege_dev_cost
	land_share = 15
	max_absolutism = -60
	loyalty = 0.15
	influence = 0.4
	is_valid = {
		NOT = { has_country_flag = hig_has_dealt_with_slacking_komachi }
		NOT = { has_country_flag = hig_deactivated_slacking_shinigami }
	}
	can_select = {
		tag = HIG
		if = {
			limit = {
				ai = yes
				was_player = no
			}
			NOT = { is_year = 1475 }
		}
	}
	can_revoke = {
		custom_trigger_tooltip = {
			tooltip = th_estate_nobles_slacking_shinigami_tt
			has_country_flag = hig_has_dealt_with_slacking_komachi
		}
	}
	on_granted = {
		th_disable_subject_annexations = yes
	}
	on_revoked = {
		th_enable_subject_annexations = yes
		hidden_effect = {
			set_country_flag = hig_deactivated_slacking_shinigami
		}
	}
	on_invalid = {
		hidden_effect = {
			set_country_flag = hig_deactivated_slacking_shinigami
		}
	}
	on_invalid = {
		th_enable_subject_annexations = yes
	}

	modifier_by_land_ownership = {
	}
	penalties = {
		manpower_recovery_speed = -0.25
		all_power_cost = 0.05
		diplomats = -1
		diplomatic_upkeep = -1
	}
	benefits = {
	}
	mechanics = {
		exempt_from_seize_land
	}

	ai_will_do = {
		factor = 0
	}
}