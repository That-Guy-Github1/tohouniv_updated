#Yama Reforms

#First reform tier
th_estate_yama_establish_lecturing = {
	icon = privilege_dev_cost
	land_share = 0
	max_absolutism = 0
	loyalty = -0.05
	influence = -0.05
	is_valid = {
		NOT = { has_country_flag = hig_passed_first_reform_finisher }
	}
	can_select = {
		estate_loyalty = {
			estate = estate_yama
			loyalty = 80
		}
	}
	on_granted = {
		hig_enable_lecturing = yes
		hidden_effect = {
			add_estate_loyalty = {
				estate = estate_yama
				loyalty = -80
			}
			every_known_country = {
				limit = {
					ai = no
					knows_country = ROOT
				}
				country_event = {
					id = th_yama_authority_event.1001
				}
			}
		}
	}
	on_revoked = {
		hig_disable_lecturing = yes
	}
	on_invalid = {
		hig_disable_lecturing = yes
	}
	penalties = {
	}
	benefits = {
	}
	#modifier_by_land_ownership = {
	#}
	#conditional_modifier = {
	#	trigger = { }
	#	modifier = { }
	#}
	#mechanics = {		
	#}
	#cooldown_years = x
	#on_cooldown_expires = {
	#}
	#can_revoke = { triggers }
	
	ai_will_do = {
		factor = 100
	}
}

th_estate_yama_regulate_conquest = {
	icon = privilege_dev_cost
	land_share = 0
	max_absolutism = 0
	loyalty = -0.05
	influence = -0.05
	is_valid = {
		NOT = { has_country_flag = hig_passed_first_reform_finisher }
	}
	can_select = {
		estate_loyalty = {
			estate = estate_yama
			loyalty = 80
		}
	}
	on_granted = {
		hig_enable_enforce_gensokyan_peace = yes
		hidden_effect = {
			add_estate_loyalty = {
				estate = estate_yama
				loyalty = -80
			}
			every_known_country = {
				limit = {
					ai = no
					knows_country = ROOT
				}
				country_event = {
					id = th_yama_authority_event.1002
				}
			}
		}
	}
	on_revoked = {
		hig_disable_enforce_gensokyan_peace = yes
	}
	on_invalid = {
		hig_disable_enforce_gensokyan_peace = yes
	}
	penalties = {
	}
	benefits = {
	}
	#modifier_by_land_ownership = {
	#}
	#conditional_modifier = {
	#	trigger = { }
	#	modifier = { }
	#}
	#mechanics = {		
	#}
	#cooldown_years = x
	#on_cooldown_expires = {
	#}
	#can_revoke = { triggers }
	
	ai_will_do = {
		factor = 100
	}
}

th_estate_yama_enforce_peace = {
	icon = privilege_dev_cost
	land_share = 0
	max_absolutism = 0
	loyalty = -0.05
	influence = -0.05
	is_valid = {
		NOT = { has_country_flag = hig_passed_first_reform_finisher }
	}
	can_select = {
		estate_loyalty = {
			estate = estate_yama
			loyalty = 80
		}
	}
	on_granted = {
		hig_enable_demand_unlawful_territory = yes
		hidden_effect = {
			add_estate_loyalty = {
				estate = estate_yama
				loyalty = -80
			}
			every_known_country = {
				limit = {
					ai = no
					knows_country = ROOT
				}
				country_event = {
					id = th_yama_authority_event.1003
				}
			}
		}
	}
	on_revoked = {
		hig_disable_demand_unlawful_territory = yes
	}
	on_invalid = {
		hig_disable_demand_unlawful_territory = yes
	}
	penalties = {
	}
	benefits = {
	}
	#modifier_by_land_ownership = {
	#}
	#conditional_modifier = {
	#	trigger = { }
	#	modifier = { }
	#}
	#mechanics = {		
	#}
	#cooldown_years = x
	#on_cooldown_expires = {
	#}
	#can_revoke = { triggers }
	
	ai_will_do = {
		factor = 100
	}
}

th_estate_yama_internal_higan_reform = {
	icon = privilege_dev_cost
	land_share = 0
	max_absolutism = 0
	loyalty = 0.15
	influence = -0.05
	is_valid = {
		NOT = { has_country_flag = hig_passed_first_reform_finisher }
	}
	can_select = {
		estate_loyalty = {
			estate = estate_yama
			loyalty = 80
		}
	}
	on_granted = {
		hig_enable_judge_deceased_rulers = yes
		hidden_effect = {
			add_estate_loyalty = {
				estate = estate_yama
				loyalty = -80
			}
			every_known_country = {
				limit = {
					ai = no
					knows_country = ROOT
				}
				country_event = {
					id = th_yama_authority_event.1004
				}
			}
		}
	}
	on_revoked = {
		hig_disable_judge_deceased_rulers = yes
	}
	on_invalid = {
		hig_disable_judge_deceased_rulers = yes
	}
	penalties = {
	}
	benefits = {
		legitimacy = 0.25
	}
	#modifier_by_land_ownership = {
	#}
	#conditional_modifier = {
	#	trigger = { }
	#	modifier = { }
	#}
	#mechanics = {		
	#}
	#cooldown_years = x
	#on_cooldown_expires = {
	#}
	#can_revoke = { triggers }
	
	ai_will_do = {
		factor = 100
	}
}

th_estate_yama_gensokyan_edict = {	#Finisher of the first reform tier
	icon = th_privilege_third_eye
	land_share = 0
	max_absolutism = 5
	loyalty = 0.05
	influence = 0.05
	is_valid = {
		th_has_unlocked_privilege_no_tooltip = {
			estate_privilege = th_estate_yama_gensokyan_edict
		}
	}
	can_select = {}
	on_granted = {
		hig_enable_lecturing = yes
		hig_enable_enforce_gensokyan_peace = yes
		hig_enable_demand_unlawful_territory = yes
		hig_enable_judge_deceased_rulers = yes
		hidden_effect = {
			every_known_country = {
				limit = {
					ai = no
					knows_country = ROOT
				}
				country_event = {
					id = th_yama_authority_event.1005
				}
			}
		}
	}
	on_revoked = {
		add_stability = -6
		hig_disable_lecturing = yes
		hig_disable_enforce_gensokyan_peace = yes
		hig_disable_demand_unlawful_territory = yes
		hig_disable_judge_deceased_rulers = yes
	}
	on_invalid = {
		hig_disable_lecturing = yes
		hig_disable_enforce_gensokyan_peace = yes
		hig_disable_demand_unlawful_territory = yes
		hig_disable_judge_deceased_rulers = yes
	}
	penalties = {
	}
	benefits = {
		legitimacy = 0.25
	}
	#modifier_by_land_ownership = {
	#}
	#conditional_modifier = {
	#	trigger = { }
	#	modifier = { }
	#}
	#mechanics = {		
	#}
	#cooldown_years = x
	#on_cooldown_expires = {
	#}
	#can_revoke = { triggers }
	
	ai_will_do = {
		factor = 100
	}
}

#Second reform tier
th_estate_yama_appoint_executor = {
	icon = privilege_dev_cost
	land_share = 0
	max_absolutism = 0
	loyalty = -0.05
	influence = -0.05
	is_valid = {
		has_country_flag = hig_passed_first_reform_finisher
		NOT = { has_country_flag = hig_passed_second_reform_finisher }
	}
	can_select = {
		estate_loyalty = {
			estate = estate_yama
			loyalty = 80
		}
		estate_influence = {
			estate = estate_yama
			influence = 25
		}
	}
	on_granted = {
		hig_enable_appoint_executor = yes
		hidden_effect = {
			add_estate_loyalty = {
				estate = estate_yama
				loyalty = -80
			}
			every_known_country = {
				limit = {
					ai = no
					knows_country = ROOT
				}
				country_event = {
					id = th_yama_authority_event.1006
				}
			}
		}
	}
	on_revoked = {
		hig_disable_appoint_executor = yes
	}
	on_invalid = {
		hig_disable_appoint_executor = yes
	}
	penalties = {
	}
	benefits = {
	}
	#modifier_by_land_ownership = {
	#}
	#conditional_modifier = {
	#	trigger = { }
	#	modifier = { }
	#}
	#mechanics = {		
	#}
	#cooldown_years = x
	#on_cooldown_expires = {
	#}
	#can_revoke = { triggers }
	
	ai_will_do = {
		factor = 100
	}
}

th_estate_yama_reform_the_judicative = {
	icon = privilege_dev_cost
	land_share = 0
	max_absolutism = 0
	loyalty = -0.05
	influence = -0.05
	is_valid = {
		has_country_flag = hig_passed_first_reform_finisher
		NOT = { has_country_flag = hig_passed_second_reform_finisher }
	}
	can_select = {
		estate_loyalty = {
			estate = estate_yama
			loyalty = 80
		}
		estate_influence = {
			estate = estate_yama
			influence = 25
		}
	}
	on_granted = {
		hig_enable_recruit_exceptional_rulers = yes
		hidden_effect = {
			add_estate_loyalty = {
				estate = estate_yama
				loyalty = -80
			}
			every_known_country = {
				limit = {
					ai = no
					knows_country = ROOT
				}
				country_event = {
					id = th_yama_authority_event.1007
				}
			}
		}
	}
	on_revoked = {
		hig_disable_recruit_exceptional_rulers = yes
	}
	on_invalid = {
		hig_disable_recruit_exceptional_rulers = yes
	}
	penalties = {
	}
	benefits = {
		advisor_cost = -0.15
	}
	#modifier_by_land_ownership = {
	#}
	#conditional_modifier = {
	#	trigger = { }
	#	modifier = { }
	#}
	#mechanics = {		
	#}
	#cooldown_years = x
	#on_cooldown_expires = {
	#}
	#can_revoke = { triggers }
	
	ai_will_do = {
		factor = 100
	}
}

th_estate_yama_establish_laws_of_war = {
	icon = privilege_dev_cost
	land_share = 0
	max_absolutism = 0
	loyalty = 0.15
	influence = -0.05
	is_valid = {
		has_country_flag = hig_passed_first_reform_finisher
		NOT = { has_country_flag = hig_passed_second_reform_finisher }
	}
	can_select = {
		estate_loyalty = {
			estate = estate_yama
			loyalty = 80
		}
		estate_influence = {
			estate = estate_yama
			influence = 25
		}
	}
	on_granted = {
		th_remove_merc_penalty = yes
		th_unlock_mercenary_company = {
			mercenary_company = merc_th_law_enforcers_of_higan
		}
		hidden_effect = {
			add_estate_loyalty = {
				estate = estate_yama
				loyalty = -80
			}
			every_known_country = {
				limit = {
					ai = no
					knows_country = ROOT
				}
				country_event = {
					id = th_yama_authority_event.1008
				}
			}
		}
	}
	on_revoked = {
		th_add_merc_penalty = yes
		th_lock_mercenary_company = {
			mercenary_company = merc_th_law_enforcers_of_higan
		}
	}
	on_invalid = {
		th_add_merc_penalty = yes
		th_lock_mercenary_company = {
			mercenary_company = merc_th_law_enforcers_of_higan
		}
	}
	penalties = {
	}
	benefits = {
		advisor_cost = -0.15
	}
	#modifier_by_land_ownership = {
	#}
	#conditional_modifier = {
	#	trigger = { }
	#	modifier = { }
	#}
	#mechanics = {		
	#}
	#cooldown_years = x
	#on_cooldown_expires = {
	#}
	#can_revoke = { triggers }
	
	ai_will_do = {
		factor = 100
	}
}

th_estate_yama_tighten_gensokyan_defense = {	#Finisher of the second reform tier
	icon = th_privilege_third_eye
	land_share = 0
	max_absolutism = 5
	loyalty = 0.05
	influence = 0.05
	is_valid = {
		th_has_unlocked_privilege_no_tooltip = {
			estate_privilege = th_estate_yama_tighten_gensokyan_defense
		}
	}
	can_select = {}
	on_granted = {
		hig_enable_recruit_exceptional_rulers = yes
		hig_enable_appoint_executor = yes
		th_remove_merc_penalty = yes
		th_unlock_mercenary_company = {
			mercenary_company = merc_th_law_enforcers_of_higan
		}
		hidden_effect = {
			every_known_country = {
				limit = {
					ai = no
					knows_country = ROOT
				}
				country_event = {
					id = th_yama_authority_event.1009
				}
			}
		}
	}
	on_revoked = {
		add_stability = -6
		hig_disable_recruit_exceptional_rulers = yes
		hig_disable_appoint_executor = yes
		th_add_merc_penalty = yes
		th_lock_mercenary_company = {
			mercenary_company = merc_th_law_enforcers_of_higan
		}
	}
	on_invalid = {
		hig_disable_recruit_exceptional_rulers = yes
		hig_disable_appoint_executor = yes
		th_add_merc_penalty = yes
		th_lock_mercenary_company = {
			mercenary_company = merc_th_law_enforcers_of_higan
		}
	}
	penalties = {
	}
	benefits = {
		global_manpower_modifier = 0.1
	}
	#modifier_by_land_ownership = {
	#}
	#conditional_modifier = {
	#	trigger = { }
	#	modifier = { }
	#}
	#mechanics = {		
	#}
	#cooldown_years = x
	#on_cooldown_expires = {
	#}
	#can_revoke = { triggers }
	
	ai_will_do = {
		factor = 100
	}
}

#Third reform tier
th_estate_yama_centralize_gensokyan_authority = {
	icon = privilege_dev_cost
	land_share = 0
	max_absolutism = 0
	loyalty = -0.05
	influence = -0.05
	is_valid = {
		has_country_flag = hig_passed_first_reform_finisher
		has_country_flag = hig_passed_second_reform_finisher
		NOT = { has_country_flag = hig_passed_third_reform_finisher }
	}
	can_select = {
		estate_loyalty = {
			estate = estate_yama
			loyalty = 80
		}
		estate_influence = {
			estate = estate_yama
			influence = 50
		}
	}
	on_granted = {
		hig_add_authority_improvement = yes
		hidden_effect = {
			add_estate_loyalty = {
				estate = estate_yama
				loyalty = -80
			}
			every_known_country = {
				limit = {
					ai = no
					knows_country = ROOT
				}
				country_event = {
					id = th_yama_authority_event.1010
				}
			}
		}
	}
	on_revoked = {
		hig_remove_authority_improvement = yes
	}
	on_invalid = {
		hig_remove_authority_improvement = yes
	}
	penalties = {
	}
	benefits = {
	}
	#modifier_by_land_ownership = {
	#}
	#conditional_modifier = {
	#	trigger = { }
	#	modifier = { }
	#}
	#mechanics = {		
	#}
	#cooldown_years = x
	#on_cooldown_expires = {
	#}
	#can_revoke = { triggers }
	
	ai_will_do = {
		factor = 100
	}
}

th_estate_yama_expand_roles = {
	icon = privilege_dev_cost
	land_share = 0
	max_absolutism = 0
	loyalty = 0.15
	influence = -0.05
	is_valid = {
		has_country_flag = hig_passed_first_reform_finisher
		has_country_flag = hig_passed_second_reform_finisher
		NOT = { has_country_flag = hig_passed_third_reform_finisher }
	}
	can_select = {
		estate_loyalty = {
			estate = estate_yama
			loyalty = 80
		}
		estate_influence = {
			estate = estate_yama
			influence = 50
		}
	}
	on_granted = {
		hig_add_influence_improvement = yes
		hidden_effect = {
			add_estate_loyalty = {
				estate = estate_yama
				loyalty = -80
			}
			every_known_country = {
				limit = {
					ai = no
					knows_country = ROOT
				}
				country_event = {
					id = th_yama_authority_event.1011
				}
			}
		}
	}
	on_revoked = {
		hig_remove_influence_improvement = yes
	}
	on_invalid = {
		hig_remove_influence_improvement = yes
	}
	penalties = {
	}
	benefits = {
		legitimacy = 0.25
	}
	#modifier_by_land_ownership = {
	#}
	#conditional_modifier = {
	#	trigger = { }
	#	modifier = { }
	#}
	#mechanics = {		
	#}
	#cooldown_years = x
	#on_cooldown_expires = {
	#}
	#can_revoke = { triggers }
	
	ai_will_do = {
		factor = 100
	}
}

th_estate_yama_sphere_of_influence = {	#Finisher of the third reform tier
	icon = th_privilege_third_eye
	land_share = 0
	max_absolutism = 5
	loyalty = 0.05
	influence = 0.05
	is_valid = {
		th_has_unlocked_privilege_no_tooltip = {
			estate_privilege = th_estate_yama_sphere_of_influence
		}
	}
	can_select = {}
	on_granted = {
		hig_add_influence_improvement = yes
		hig_add_authority_improvement = yes
		custom_tooltip = th_estate_yama_sphere_of_influence_tt
		hidden_effect = {
			every_known_country = {
				limit = {
					ai = no
					knows_country = ROOT
					NOT = {
						capital_scope = {
							continent = gensokyo_continent
						}
					}
				}
				country_event = {
					id = th_yama_authority_event.1012
				}
			}
			every_known_country = {
				limit = {
					capital_scope = {
						continent = gensokyo_continent
					}
					NOT = { is_subject_of = ROOT }
					NOT = { is_subject_of_type = th_yama_executor }
				}
				country_event = {
					id = th_yama_authority_event.1013
				}
			}
		}
	}
	on_revoked = {
		add_stability = -6
		hig_remove_influence_improvement = yes
		hig_remove_authority_improvement = yes
	}
	on_invalid = {
		hig_remove_influence_improvement = yes
		hig_remove_authority_improvement = yes
	}
	penalties = {
	}
	benefits = {
		legitimacy = 0.25
	}
	#modifier_by_land_ownership = {
	#}
	#conditional_modifier = {
	#	trigger = { }
	#	modifier = { }
	#}
	#mechanics = {		
	#}
	#cooldown_years = x
	#on_cooldown_expires = {
	#}
	#can_revoke = { triggers }
	
	ai_will_do = {
		factor = 100
	}
}

#Fourth reform tier
th_estate_yama_eternal_peace = {
	icon = privilege_dev_cost
	land_share = 0
	max_absolutism = 0
	loyalty = -0.15
	influence = -0.25
	is_valid = {
		has_country_flag = hig_passed_first_reform_finisher
		has_country_flag = hig_passed_second_reform_finisher
		has_country_flag = hig_passed_third_reform_finisher
		NOT = { has_country_flag = hig_passed_fourth_reform_finisher }
	}
	can_select = {
		estate_loyalty = {
			estate = estate_yama
			loyalty = 80
		}
		estate_influence = {
			estate = estate_yama
			influence = 75
		}
	}
	on_granted = {
		hig_remove_penalty_from_owning_gensokyan_land = yes
		custom_tooltip = th_estate_yama_eternal_peace_tt
		hidden_effect = {
			add_estate_loyalty = {
				estate = estate_yama
				loyalty = -80
			}
			every_known_country = {
				limit = {
					ai = no
					knows_country = ROOT
					NOT = {
						capital_scope = {
							continent = gensokyo_continent
						}
					}
				}
				country_event = {
					id = th_yama_authority_event.1014
				}
			}
			every_known_country = {
				limit = {
					capital_scope = {
						continent = gensokyo_continent
					}
					NOT = { is_subject_of = ROOT }
					NOT = { is_subject_of_type = th_yama_executor }
				}
				country_event = {
					id = th_yama_authority_event.1015
				}
			}
		}
	}
	on_revoked = {
		hig_add_penalty_from_owning_gensokyan_land = yes
	}
	on_invalid = {
		hig_add_penalty_from_owning_gensokyan_land = yes
	}
	penalties = {
	}
	benefits = {
		legitimacy = 0.25
	}
	#modifier_by_land_ownership = {
	#}
	#conditional_modifier = {
	#	trigger = { }
	#	modifier = { }
	#}
	#mechanics = {		
	#}
	#cooldown_years = x
	#on_cooldown_expires = {
	#}
	#can_revoke = { triggers }
	
	ai_will_do = {
		factor = 100
	}
}

th_estate_yama_unite_gensokyo = {	#Finisher of the fourth reform tier
	icon = th_privilege_third_eye
	land_share = 0
	max_absolutism = 15
	loyalty = 0.25
	influence = 0.05
	is_valid = {
		th_has_unlocked_privilege_no_tooltip = {
			estate_privilege = th_estate_yama_unite_gensokyo
		}
	}
	can_select = {}
	on_granted = {
		if = {
			limit = { NOT = { government_rank = 3 } }
			set_government_rank = 3
		}
		hig_remove_penalty_from_owning_gensokyan_land = yes
		custom_tooltip = th_estate_yama_unite_gensokyo_tt
		hidden_effect = {
			every_known_country = {
				limit = {
					ai = no
					knows_country = ROOT
					NOT = {
						capital_scope = {
							continent = gensokyo_continent
						}
					}
				}
				country_event = {
					id = th_yama_authority_event.1016
				}
			}
			every_known_country = {
				limit = {
					capital_scope = {
						continent = gensokyo_continent
					}
				}
				country_event = {
					id = th_yama_authority_event.1017
				}
			}
		}
	}
	on_revoked = {
		add_stability = -6
		hig_add_penalty_from_owning_gensokyan_land = yes
	}
	on_invalid = {
		hig_add_penalty_from_owning_gensokyan_land = yes
	}
	penalties = {
	}
	benefits = {
		governing_capacity_modifier = 0.2
	}
	#modifier_by_land_ownership = {
	#}
	#conditional_modifier = {
	#	trigger = { }
	#	modifier = { }
	#}
	#mechanics = {		
	#}
	#cooldown_years = x
	#on_cooldown_expires = {
	#}
	#can_revoke = { triggers }
	
	ai_will_do = {
		factor = 100
	}
}