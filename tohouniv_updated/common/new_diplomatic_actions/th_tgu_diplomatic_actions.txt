###TGU NEWSPAPER ABILITIES###

#Diplo actions here are just recycled and NOT the final addition

#TGU publishes propaganda in the target country -> target loses all AE opinion of root
th_write_propaganda = {
	category = th_diplo_action
	require_acceptance = no

	is_visible = {
		has_government_attribute = enables_tengu_newspaper
		FROM = { is_free_or_tributary_trigger = yes }
	}

	is_allowed = {
		has_spy_network_in = {
			who = FROM
			value = 40
		}
		custom_trigger_tooltip = {
			tooltip = th_write_propaganda_cd_tt
			FROM = {
				OR = {
					NOT = { has_country_flag = th_read_propaganda_of_@ROOT }
					had_country_flag = {
						flag = th_read_propaganda_of_@ROOT
						days = 5475
					}
				}
			}
		}
		custom_trigger_tooltip = {
			tooltip = th_has_aggressive_expansion_modifier
			FROM = {
				has_opinion_modifier = {
					who = ROOT
					modifier = aggressive_expansion
				}
			}
		}
		if = {
			limit = {
				FROM = {
					OR = {
						has_country_flag = th_immunity_to_diplomatic_actions
						has_government_attribute = enables_yama_authority
					}
				}
			}
			custom_trigger_tooltip = {
				tooltip = th_from_is_not_immune_to_diplomatic_actions_tt
				FROM = {
					NOT = { has_country_flag = th_immunity_to_diplomatic_actions }
					NOT = { has_government_attribute = enables_yama_authority }
				}
			}
		}
	}

	on_accept = {
		FROM = {
			clr_country_flag = th_read_propaganda_of_@ROO
			set_country_flag = th_read_propaganda_of_@ROO
			remove_opinion = {
				who = ROOT
				modifier = aggressive_expansion
			}
		}
		add_spy_network_in = {
			who = FROM
			value = -40
		}
	}

	ai_will_do = {
		always = no
	}
}

th_spread_good_image = {
	category = th_diplo_action
	require_acceptance = no

	is_visible = {
		has_government_attribute = enables_tengu_newspaper
		FROM = { is_free_or_tributary_trigger = yes }
	}

	is_allowed = {
		has_spy_network_in = {
			who = FROM
			value = 30
		}
		custom_trigger_tooltip = {
			tooltip = th_spread_good_image_cd_tt
			FROM = {
				OR = {
					NOT = { has_country_flag = th_received_good_image_of_@ROOT }
					had_country_flag = {
						flag = th_received_good_image_of_@ROOT
						days = 5475
					}
				}
			}
		}
		if = {
			limit = {
				FROM = {
					OR = {
						has_country_flag = th_immunity_to_diplomatic_actions
						has_government_attribute = enables_yama_authority
					}
				}
			}
			custom_trigger_tooltip = {
				tooltip = th_from_is_not_immune_to_diplomatic_actions_tt
				FROM = {
					NOT = { has_country_flag = th_immunity_to_diplomatic_actions }
					NOT = { has_government_attribute = enables_yama_authority }
				}
			}
		}
	}

	on_accept = {
		FROM = {
			clr_country_flag = th_received_good_image_of_@ROOT
			set_country_flag = th_received_good_image_of_@ROOT
			remove_opinion = {
				who = ROOT
				modifier = caught_spy
			}
			remove_opinion = {
				who = ROOT
				modifier = declared_war_on_neighbor
			}
			add_opinion = {
				who = ROOT
				modifier = th_good_image
			}
		}
		add_spy_network_in = {
			who = FROM
			value = -30
		}
	}

	ai_will_do = {
		always = no
	}
}

th_denounce_allies = {
	category = th_diplo_action
	require_acceptance = no

	is_visible = {
		has_government_attribute = enables_tengu_newspaper
		FROM = { is_free_or_tributary_trigger = yes }
	}

	is_allowed = {
		has_spy_network_in = {
			who = FROM
			value = 25
		}
		custom_trigger_tooltip = {
			tooltip = th_spread_good_image_cd_tt
			FROM = {
				OR = {
					NOT = { has_country_flag = th_had_to_denounce_allies_by_@ROOT }
					had_country_flag = {
						flag = th_had_to_denounce_allies_by_@ROOT
						days = 5475
					}
				}
			}
		}
		if = {
			limit = {
				FROM = {
					OR = {
						has_country_flag = th_immunity_to_diplomatic_actions
						has_government_attribute = enables_yama_authority
					}
				}
			}
			custom_trigger_tooltip = {
				tooltip = th_from_is_not_immune_to_diplomatic_actions_tt
				FROM = {
					NOT = { has_country_flag = th_immunity_to_diplomatic_actions }
					NOT = { has_government_attribute = enables_yama_authority }
				}
			}
		}
	}

	on_accept = {
		FROM = {
			clr_country_flag = th_had_to_denounce_allies_by_@ROOT
			set_country_flag = th_had_to_denounce_allies_by_@ROOT
			every_ally = {
				reverse_add_opinion = {
					who = FROM
					modifier = th_ally_denouncement
				}
			}
		}
		add_spy_network_in = {
			who = FROM
			value = -25
		}
	}

	ai_will_do = {
		always = no
	}
}

th_demotivate_military = {
	category = th_diplo_action
	require_acceptance = no

	is_visible = {
		has_government_attribute = enables_tengu_newspaper
		FROM = { is_free_or_tributary_trigger = yes }
	}

	is_allowed = {
		has_spy_network_in = {
			who = FROM
			value = 25
		}
		custom_trigger_tooltip = {
			tooltip = th_spread_good_image_cd_tt
			FROM = {
				OR = {
					NOT = { has_country_flag = th_got_military_demotivated_by_@ROOT }
					had_country_flag = {
						flag = th_got_military_demotivated_by_@ROOT
						days = 5475
					}
				}
			}
		}
		if = {
			limit = {
				FROM = {
					OR = {
						has_country_flag = th_immunity_to_diplomatic_actions
						has_government_attribute = enables_yama_authority
					}
				}
			}
			custom_trigger_tooltip = {
				tooltip = th_from_is_not_immune_to_diplomatic_actions_tt
				FROM = {
					NOT = { has_country_flag = th_immunity_to_diplomatic_actions }
					NOT = { has_government_attribute = enables_yama_authority }
				}
			}
		}
		FROM = { NOT = { has_country_modifier = th_demotivated_forces } }
	}

	on_accept = {
		FROM = {
			clr_country_flag = th_got_military_demotivated_by_@ROOT
			set_country_flag = th_got_military_demotivated_by_@ROOT
			add_country_modifier = {
				name = th_demotivated_forces
				duration = 1825
			}
		}
		add_spy_network_in = {
			who = FROM
			value = -25
		}
	}

	ai_will_do = {
		always = no
	}
}

th_spread_republican_ideas = {
	category = th_diplo_action
	require_acceptance = no

	is_visible = {
		has_government_attribute = enables_tengu_newspaper
		FROM = { is_free_or_tributary_trigger = yes }
	}

	is_allowed = {
		has_spy_network_in = {
			who = FROM
			value = 20
		}
		custom_trigger_tooltip = {
			tooltip = th_spread_good_image_cd_tt
			FROM = {
				OR = {
					NOT = { has_country_flag = th_was_targeted_for_cb_by_@ROOT }
					had_country_flag = {
						flag = th_was_targeted_for_cb_by_@ROOT
						days = 5475
					}
				}
			}
		}
		if = {
			limit = {
				FROM = {
					OR = {
						has_country_flag = th_immunity_to_diplomatic_actions
						has_government_attribute = enables_yama_authority
					}
				}
			}
			custom_trigger_tooltip = {
				tooltip = th_from_is_not_immune_to_diplomatic_actions_tt
				FROM = {
					NOT = { has_country_flag = th_immunity_to_diplomatic_actions }
					NOT = { has_government_attribute = enables_yama_authority }
				}
			}
		}
	}

	on_accept = {
		FROM = {
			clr_country_flag = th_was_targeted_for_cb_by_@ROOT
			set_country_flag = th_was_targeted_for_cb_by_@ROOT
		}
		add_casus_belli = {
			target = FROM
			type = cb_vassalize_mission
		}
		add_spy_network_in = {
			who = FROM
			value = -20
		}
	}

	ai_will_do = {
		always = no
	}
}

th_sell_newspaper = {
	category = th_diplo_action
	require_acceptance = no

	is_visible = {
		has_government_attribute = enables_tengu_newspaper
		FROM = { is_free_or_tributary_trigger = yes }
	}

	is_allowed = {
		has_spy_network_in = {
			who = FROM
			value = 20
		}
		custom_trigger_tooltip = {
			tooltip = th_spread_good_image_cd_tt
			FROM = {
				OR = {
					NOT = { has_country_flag = th_was_targeted_for_cb_by_@ROOT }
					had_country_flag = {
						flag = th_was_targeted_for_cb_by_@ROOT
						days = 5475
					}
				}
			}
		}
		if = {
			limit = {
				FROM = {
					OR = {
						has_country_flag = th_immunity_to_diplomatic_actions
						has_government_attribute = enables_yama_authority
					}
				}
			}
			custom_trigger_tooltip = {
				tooltip = th_from_is_not_immune_to_diplomatic_actions_tt
				FROM = {
					NOT = { has_country_flag = th_immunity_to_diplomatic_actions }
					NOT = { has_government_attribute = enables_yama_authority }
				}
			}
		}
	}

	on_accept = {
		FROM = {
			clr_country_flag = th_was_targeted_for_cb_by_@ROOT
			set_country_flag = th_was_targeted_for_cb_by_@ROOT
		}
		add_casus_belli = {
			target = FROM
			type = cb_vassalize_mission
		}
		add_spy_network_in = {
			who = FROM
			value = -20
		}
	}

	ai_will_do = {
		always = no
	}
}

th_buyoff_newspaper = {
	category = th_diplo_action
	require_acceptance = no

	is_visible = {
		has_government_attribute = enables_tengu_newspaper
		FROM = { is_free_or_tributary_trigger = yes }
	}

	is_allowed = {
		has_spy_network_in = {
			who = FROM
			value = 20
		}
		custom_trigger_tooltip = {
			tooltip = th_spread_good_image_cd_tt
			FROM = {
				OR = {
					NOT = { has_country_flag = th_was_targeted_for_cb_by_@ROOT }
					had_country_flag = {
						flag = th_was_targeted_for_cb_by_@ROOT
						days = 5475
					}
				}
			}
		}
		if = {
			limit = {
				FROM = {
					OR = {
						has_country_flag = th_immunity_to_diplomatic_actions
						has_government_attribute = enables_yama_authority
					}
				}
			}
			custom_trigger_tooltip = {
				tooltip = th_from_is_not_immune_to_diplomatic_actions_tt
				FROM = {
					NOT = { has_country_flag = th_immunity_to_diplomatic_actions }
					NOT = { has_government_attribute = enables_yama_authority }
				}
			}
		}
	}

	on_accept = {
		FROM = {
			clr_country_flag = th_was_targeted_for_cb_by_@ROOT
			set_country_flag = th_was_targeted_for_cb_by_@ROOT
		}
		add_casus_belli = {
			target = FROM
			type = cb_vassalize_mission
		}
		add_spy_network_in = {
			who = FROM
			value = -20
		}
	}

	ai_will_do = {
		always = no
	}
}