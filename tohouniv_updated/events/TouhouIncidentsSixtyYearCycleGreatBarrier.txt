########################################
# Incident Events
########################################

namespace = th_sixty_year_cycle_incident_events
#incident = sixty_year_cycle_incident

#Sixty Year Cycle Great Barrier Incident - Set up the incident
country_event = {
	id = th_sixty_year_cycle_incident_events.0
	title = "th_sixty_year_cycle_incident_events.0.t"
	desc = none
	picture = HIGAN_eventPicture

	trigger = {
		th_incident_check_year_for_incident = { incident = sixty_year_cycle_incident year = 1550 }
		NOT = { th_incident_has_been_resolved = { incident = sixty_year_cycle_incident } }
		th_incident_can_trigger_generic_check = yes
	}
	
	fire_only_once = yes
	hidden = yes	
	
	mean_time_to_happen = {
		months = 12

		modifier = {
			factor = 0.5
			exists = HIG
		}
	}

	immediate = {
		th_incident_forbid_country_to_investigate = { who = HIG }
		th_incident_forbid_country_to_investigate = { who = SNZ }
		th_start_incident_effect = {
			incident = sixty_year_cycle_incident
		}
		gensokyo_superregion = {
			limit = {
				NOT = { has_province_modifier = th_POFV_random_flower_bed }
			}
			add_permanent_province_modifier = {
				name = th_POFV_random_flower_bed
				duration = -1
			}
		}
	}

	option = {		#Check any possible investigator country
		random_country = {
			limit = { 
				th_incident_can_become_investigator = yes
			}
			th_incident_setup_investigator = yes
			th_incident_introduction_event = {
				id = th_sixty_year_cycle_incident_events.1
			}
		}
		set_global_flag = th_POFV_random_matches_active
		ai_chance = { 
			factor = 100
		}
	}
}

#Sixty Year Cycle Great Barrier Incident - Introduction of incident
country_event = {
	id = th_sixty_year_cycle_incident_events.1
	title = "th_sixty_year_cycle_incident_events.1.t"
	desc = "th_sixty_year_cycle_incident_events.1.desc"
	picture = HIGAN_eventPicture

	is_triggered_only = yes	

	option = {		#Curious... I will investigate this phenomenon
		name = "th_sixty_year_cycle_incident_events.1.a"
		custom_tooltip = th_sixty_year_cycle_incident_events.1.a.tt
		trigger = {
			NOT = { tag = HIG }
			NOT = { was_tag = HIG }
			NOT = { tag = SNZ }
			NOT = { was_tag = SNZ }
		}
		highlight = yes	
		hidden_effect = {
			set_country_flag = th_POFV_joined_the_investigation
			set_variable = {
				which = th_POFV_personal_fight_counter
				value = 0
			}
			if = {
				limit = {
					ai = no
					NOT = { has_country_flag = th_incident_had_info }
				}
				country_event = {
					id = th_danmaku_event.1
					days = 1
				}
			}
		}

		ai_chance = {
			factor = 0
		}
	}
	
	option = {		#These flowerbeds need investigations
		name = "th_sixty_year_cycle_incident_events.1.b"
		custom_tooltip = th_sixty_year_cycle_incident_events.1.b.tt
		trigger = {
			NOT = { tag = HIG }
			NOT = { was_tag = HIG }
			NOT = { tag = SNZ }
			NOT = { was_tag = SNZ }
		}
		ai_chance = {
			factor = 100
		}
	}
	
	option = {		#Oh no... not again. Komachi must have been slacking off again
		name = "th_sixty_year_cycle_incident_events.1.c"
		trigger = {
			th_is_or_was_tag = {
				tag = HIG
			}
		}
		th_start_incident_tooltip = { incident = sixty_year_cycle_incident }
		highlight = yes	
		add_army_tradition = 15
		add_navy_tradition = 15
		add_treasury = 200

		ai_chance = {
			factor = 100
		}
	}
	
	option = {		#Oh no... not again. Eiki will be so mad...
		name = "th_sixty_year_cycle_incident_events.1.d"
		trigger = {
			th_is_or_was_tag = {
				tag = SNZ
			}
		}
		th_start_incident_tooltip = { incident = sixty_year_cycle_incident }
		highlight = yes	
		add_army_tradition = 15
		add_navy_tradition = 15
		add_treasury = 200
		add_stability = -1

		ai_chance = {
			factor = 100
		}
	}
}


#Sixty Year Cycle Great Barrier Incident - Random Encounters!
country_event = {
	id = th_sixty_year_cycle_incident_events.3
	title = none
	desc = none
	picture = HIGAN_eventPicture
	hidden = yes
	
	trigger = {
		th_current_incident = { incident = sixty_year_cycle_incident }
		has_global_flag = th_POFV_random_matches_active
		has_country_flag = th_POFV_joined_the_investigation
	}

	is_triggered_only = yes

	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		if = {
			limit = {
				is_variable_equal = {
					which = th_POFV_personal_fight_counter
					value = 5
				}
			}
			country_event = {
				id = th_sixty_year_cycle_incident_events.7
			}
		}
		else_if = {
			limit = {
				check_variable = {
					which = th_POFV_personal_fight_counter
					value = 6
				}
			}
			country_event = {
				id = th_sixty_year_cycle_incident_events.8
			}
		}
		else = {
			random_list = {
				#Stage 1 - 2 Bracket
				1 = { #Cirno
					trigger = {
						NOT = { tag = CIN }
						NOT = { was_tag = CIN }
						NOT = {
							check_variable = {
								which = th_POFV_personal_fight_counter
								value = 3
							}
						}
						NOT = { has_country_flag = th_POFV_had_cirno_fight }
					}
					set_country_flag = th_POFV_cirno_fight
					set_country_flag = th_POFV_had_cirno_fight
				}
				1 = { #Mystia
					trigger = {
						NOT = {
							check_variable = {
								which = th_POFV_personal_fight_counter
								value = 3
							}
						}
						NOT = { has_country_flag = th_POFV_had_mystia_fight }
					}
					set_country_flag = th_POFV_mystia_fight
					set_country_flag = th_POFV_had_mystia_fight
				}
				#Stage 2 - 4 bracket
				1 = { #Prismriver
					trigger = {
						NOT = { tag = PRI }
						NOT = { was_tag = PRI }
						check_variable = {
							which = th_POFV_personal_fight_counter
							value = 2
						}
						NOT = {
							check_variable = {
								which = th_POFV_personal_fight_counter
								value = 5
							}
						}
						NOT = { has_country_flag = th_POFV_had_prismriver_fight }
					}
					set_country_flag = th_POFV_prismriver_fight
					set_country_flag = th_POFV_had_prismriver_fight
				}
				1 = { #Tewi
					trigger = {
						check_variable = {
							which = th_POFV_personal_fight_counter
							value = 2
						}
						NOT = {
							check_variable = {
								which = th_POFV_personal_fight_counter
								value = 5
							}
						}
						NOT = { has_country_flag = th_POFV_had_tewi_fight }
					}
					set_country_flag = th_POFV_tewi_fight
					set_country_flag = th_POFV_had_tewi_fight
				}
				#Stage 3 - 5 bracket
				1 = { #Reisen
					trigger = {
						NOT = { tag = EIT }
						NOT = { was_tag = EIT }
						check_variable = {
							which = th_POFV_personal_fight_counter
							value = 3
						}
						NOT = {
							check_variable = {
								which = th_POFV_personal_fight_counter
								value = 6
							}
						}
						NOT = { has_country_flag = th_POFV_had_reisen_fight }
					}
					set_country_flag = th_POFV_reisen_fight
					set_country_flag = th_POFV_had_reisen_fight
				}
				1 = { #Youmu
					trigger = {
						NOT = { tag = NET }
						NOT = { was_tag = NET }
						check_variable = {
							which = th_POFV_personal_fight_counter
							value = 3
						}
						NOT = {
							check_variable = {
								which = th_POFV_personal_fight_counter
								value = 6
							}
						}
						NOT = { has_country_flag = th_POFV_had_youmu_fight }
					}
					set_country_flag = th_POFV_youmu_fight
					set_country_flag = th_POFV_had_youmu_fight
				}
				1 = { #Sakuya
					trigger = {
						NOT = { tag = SCR }
						NOT = { was_tag = SCR }
						NOT = { has_country_flag = th_POFV_had_sakuya_fight }
					}
					set_country_flag = th_POFV_sakuya_fight
					set_country_flag = th_POFV_had_sakuya_fight
				}
				1 = { #Medicine
					trigger = {
						NOT = { has_country_flag = th_POFV_had_medicine_fight }
					}
					set_country_flag = th_POFV_medicine_fight
					set_country_flag = th_POFV_had_medicine_fight
				}
				1 = { #Yuuka
					trigger = {
						NOT = { tag = SFF }
						NOT = { was_tag = SFF }
						NOT = { has_country_flag = th_POFV_had_yuuka_fight }
					}
					set_country_flag = th_POFV_yuuka_fight
					set_country_flag = th_POFV_had_yuuka_fight
				}
				1 = { #Aya
					trigger = {
						NOT = { tag = TGU }
						NOT = { was_tag = TGU }
						NOT = { has_country_flag = th_POFV_had_aya_fight }
					}
					set_country_flag = th_POFV_aya_fight
					set_country_flag = th_POFV_had_aya_fight
				}
				1 = { #Marisa
					trigger = {
						NOT = { tag = FOM }
						NOT = { was_tag = FOM }
						NOT = { has_country_flag = th_POFV_had_marisa_fight }
					}
					set_country_flag = th_POFV_marisa_fight
					set_country_flag = th_POFV_had_marisa_fight
				}
				1 = { #Reimu
					trigger = {
						NOT = { tag = HKR }
						NOT = { was_tag = HKR }
						NOT = { has_country_flag = th_POFV_had_reimu_fight }
					}
					set_country_flag = th_POFV_reimu_fight
					set_country_flag = th_POFV_had_reimu_fight
				}
				#Bonus bosses if there are more investigators
				1 = { #Lily
					trigger = {
						LIL = { has_country_flag = th_POFV_joined_the_investigation }
						NOT = { tag = LIL }
						NOT = { was_tag = LIL }
						NOT = {
							check_variable = {
								which = th_POFV_personal_fight_counter
								value = 3
							}
						}
					}
					set_country_flag = th_POFV_lily_fight
				}
			}
			country_event = {
				id = th_sixty_year_cycle_incident_events.4
			}
		}
		
		ai_chance = { 
			factor = 100
		}
	}
}

#Sixty Year Cycle Great Barrier Incident - Random Encounters!
country_event = {
	id = th_sixty_year_cycle_incident_events.4
	title = th_sixty_year_cycle_incident_events.4.t
	desc = {
		trigger = { has_country_flag = th_POFV_medicine_fight }
		desc = th_sixty_year_cycle_incident_events.4.medicine.desc
	}
	desc = {
		trigger = { has_country_flag = th_POFV_tewi_fight }
		desc = th_sixty_year_cycle_incident_events.4.tewi.desc
	}
	desc = {
		trigger = { has_country_flag = th_POFV_mystia_fight }
		desc = th_sixty_year_cycle_incident_events.4.mystia.desc
	}
	desc = {
		trigger = { has_country_flag = th_POFV_yuuka_fight }
		desc = th_sixty_year_cycle_incident_events.4.yuuka.desc
	}
	desc = {
		trigger = { has_country_flag = th_POFV_aya_fight }
		desc = th_sixty_year_cycle_incident_events.4.aya.desc
	}
	desc = {
		trigger = { has_country_flag = th_POFV_prismriver_fight }
		desc = th_sixty_year_cycle_incident_events.4.prismriver.desc
	}
	desc = {
		trigger = { has_country_flag = th_POFV_cirno_fight }
		desc = th_sixty_year_cycle_incident_events.4.cirno.desc
	}
	desc = {
		trigger = { has_country_flag = th_POFV_reisen_fight }
		desc = th_sixty_year_cycle_incident_events.4.reisen.desc
	}
	desc = {
		trigger = { has_country_flag = th_POFV_youmu_fight }
		desc = th_sixty_year_cycle_incident_events.4.youmu.desc
	}
	desc = {
		trigger = { has_country_flag = th_POFV_sakuya_fight }
		desc = th_sixty_year_cycle_incident_events.4.sakuya.desc
	}
	desc = {
		trigger = { has_country_flag = th_POFV_marisa_fight }
		desc = th_sixty_year_cycle_incident_events.4.marisa.desc
	}
	desc = {
		trigger = { has_country_flag = th_POFV_reimu_fight }
		desc = th_sixty_year_cycle_incident_events.4.reimu.desc
	}
	desc = {
		trigger = {
			NOT = { has_country_flag = th_POFV_medicine_fight }
			NOT = { has_country_flag = th_POFV_tewi_fight }
			NOT = { has_country_flag = th_POFV_mystia_fight }
			NOT = { has_country_flag = th_POFV_yuuka_fight }
			NOT = { has_country_flag = th_POFV_aya_fight }
			NOT = { has_country_flag = th_POFV_prismriver_fight }
			NOT = { has_country_flag = th_POFV_cirno_fight }
			NOT = { has_country_flag = th_POFV_reisen_fight }
			NOT = { has_country_flag = th_POFV_youmu_fight }
			NOT = { has_country_flag = th_POFV_sakuya_fight }
			NOT = { has_country_flag = th_POFV_marisa_fight }
			NOT = { has_country_flag = th_POFV_reimu_fight }
		}
		desc = th_sixty_year_cycle_incident_events.4.default.desc
	}
	picture = {
		trigger = { has_country_flag = th_POFV_medicine_fight }
		picture = MEDICINE_eventPicture
	}
	picture = {
		trigger = { has_country_flag = th_POFV_tewi_fight }
		picture = TEWI_eventPicture
	}
	picture = {
		trigger = { has_country_flag = th_POFV_mystia_fight }
		picture = MYSTIA_eventPicture
	}
	picture = {
		trigger = { has_country_flag = th_POFV_yuuka_fight }
		picture = YUUKABOSS_eventPicture
	}
	picture = {
		trigger = { has_country_flag = th_POFV_aya_fight }
		picture = AYABOSS_eventPicture
	}
	picture = {
		trigger = { has_country_flag = th_POFV_prismriver_fight }
		picture = PRISMRIVER_eventPicture
	}
	picture = {
		trigger = { has_country_flag = th_POFV_cirno_fight }
		picture = CIRNO_eventPicture
	}
	picture = {
		trigger = { has_country_flag = th_POFV_reisen_fight }
		picture = REISEN_eventPicture
	}
	picture = {
		trigger = { has_country_flag = th_POFV_youmu_fight }
		picture = YOUMU2_eventPicture
	}
	picture = {
		trigger = { has_country_flag = th_POFV_sakuya_fight }
		picture = SAKUYA_eventPicture
	}
	picture = {
		trigger = { has_country_flag = th_POFV_marisa_fight }
		picture = MARISA_eventPicture
	}
	picture = {
		trigger = { has_country_flag = th_POFV_reimu_fight }
		picture = REIMU_eventPicture
	}
	picture = {
		trigger = {
			NOT = { has_country_flag = th_POFV_medicine_fight }
			NOT = { has_country_flag = th_POFV_tewi_fight }
			NOT = { has_country_flag = th_POFV_mystia_fight }
			NOT = { has_country_flag = th_POFV_yuuka_fight }
			NOT = { has_country_flag = th_POFV_aya_fight }
			NOT = { has_country_flag = th_POFV_prismriver_fight }
			NOT = { has_country_flag = th_POFV_cirno_fight }
			NOT = { has_country_flag = th_POFV_reisen_fight }
			NOT = { has_country_flag = th_POFV_youmu_fight }
			NOT = { has_country_flag = th_POFV_sakuya_fight }
			NOT = { has_country_flag = th_POFV_marisa_fight }
			NOT = { has_country_flag = th_POFV_reimu_fight }
		}
		picture = HIGAN_eventPicture
	}
	is_triggered_only = yes
	
	option = {
		name = th_sixty_year_cycle_incident_events.4.a.tt
		
		ai_chance = { 
			factor = 100
		}
	}

	after = {
		clr_country_flag = th_POFV_medicine_fight
		clr_country_flag = th_POFV_tewi_fight
		clr_country_flag = th_POFV_mystia_fight
		clr_country_flag = th_POFV_yuuka_fight
		clr_country_flag = th_POFV_aya_fight
		clr_country_flag = th_POFV_prismriver_fight
		clr_country_flag = th_POFV_cirno_fight
		clr_country_flag = th_POFV_reisen_fight
		clr_country_flag = th_POFV_youmu_fight
		clr_country_flag = th_POFV_sakuya_fight
		clr_country_flag = th_POFV_marisa_fight
		clr_country_flag = th_POFV_reimu_fight
	}
}


#Sixty Year Cycle Great Barrier Incident - Komachi Encounter
country_event = {
	id = th_sixty_year_cycle_incident_events.7
	title = "th_sixty_year_cycle_incident_events.7.t"
	desc = "th_sixty_year_cycle_incident_events.7.desc"
	picture = KOMACHI_eventPicture
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			th_prepare_for_next_stage = yes
			th_getruler_fighting_skill = {
				skill_boni = 0
				type = incident
			}
			#Komachi's Base Fighting Skills
			set_variable = {
				which = th_SA_inci_okuus_combat_skills
				value = 1700
			}
			th_defineopponent_fighting_skill = {
				type = incident
				variable = th_SA_inci_okuus_combat_skills
			}	
		}
	}
	
	option = {		#I will have to defeat her myself
		name = "th_sixty_year_cycle_incident_events.7.a"
		custom_tooltip = th_sixty_year_cycle_incident_events.7.a.tt
		highlight = yes
		th_danmaku_incident_fight_ruler_and_opponent = yes
		
		ai_chance = { 
			factor = 100
		}
	}
}

#Sixty Year Cycle Great Barrier Incident "EXTRA" - Eiki Encounter
country_event = {
	id = th_sixty_year_cycle_incident_events.8
	title = "th_sixty_year_cycle_incident_events.8.t"
	desc = "th_sixty_year_cycle_incident_events.8.desc"
	picture = EIKIBOSS_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			th_prepare_for_next_stage = yes
			th_getruler_fighting_skill = {
				skill_boni = 0
				type = incident
			}
			#Eiki's Base Fighting Skills
			set_variable = {
				which = th_SDM_inci_flandres_combat_skills
				value = 1600
			}
			th_defineopponent_fighting_skill = {
				type = incident
				variable = th_SDM_inci_flandres_combat_skills
			}	
		}
	}
	
	option = {		#Oh no...
		name = "th_scarlet_mists_incident_events.8.a"
		custom_tooltip = th_scarlet_mists_incident_events.8.a.tt
		highlight = yes
		th_danmaku_incident_fight_ruler_and_opponent = yes
		hidden_effect = {
			country_event = {
				id = th_sixty_year_cycle_incident_events.12
				days = 90
			}
		}
		
		ai_chance = { 
			factor = 100
		}
	}
}



#Sixty Year Cycle Great Barrier Incident - Terrible Outcome because of dead ruler!
country_event = { #Nothing changes and more unrest spirits appear
	id = th_sixty_year_cycle_incident_events.16
	title = "th_sixty_year_cycle_incident_events.16.t"
	desc = "th_sixty_year_cycle_incident_events.16.desc"
	picture = HIGAN_eventPicture
	
	trigger = {
		th_incident_current_stage = {
			stage = 7
		}
		has_country_flag = th_incident_last_fight_terribly_lost
		th_incident_is_investigator = yes
		NOT = { th_incident_has_been_resolved = { incident = sixty_year_cycle_incident } }
		th_current_incident = {
			incident = sixty_year_cycle_incident
		}
		NOT = { has_country_flag = th_just_finished_incident_danmaku_fight }
	}
	
	immediate = {
		hidden_effect = { 
			th_resolve_incident = { incident = sixty_year_cycle_incident }
		}
	}
	
	mean_time_to_happen = {
		months = 12
	}
	major = yes
	
	option = {		#Well, I've done what I could.
		name = "th_sixty_year_cycle_incident_events.16.a"
		custom_tooltip = th_sixty_year_cycle_incident_events.16.a.tt
		if = {
			limit = {
				exists = MRY
			}
			MRY = {
				add_country_modifier = {
					name = th_SA_growing_moriya_influence
					duration = 1825
				}
			}
		}
		if = {
			limit = {
				exists = SCD
				SCD = { has_country_flag = crd_formed_scd }
			}
			SCD = {
				add_country_modifier = {
					name = th_SA_earth_spirits_unleashed
					duration = 1825
				}
			}
		}
		else_if = {
			limit = {
				exists = CRD
			}
			CRD = {
				add_country_modifier = {
					name = th_SA_earth_spirits_unleashed
					duration = 1825
				}
			}
		}
		add_adm_power = -100
		add_prestige = -10
		add_devotion = -10
		custom_tooltip = th_sixty_year_cycle_incident_events_hot_geysers
		hidden_effect = {
			gensokyo_superregion = {
				limit = {
					owner = {
						NOT = { tag = CRD }
						NOT = { has_country_flag = crd_formed_scd }
						NOT = { is_subject_of = CRD }
					}
				}
				add_province_modifier = {
					name = th_SA_hot_geysers
					duration = 1825
				}
			}
		}
	}
}

#Sixty Year Cycle Great Barrier Incident - Bad Outcome
country_event = { #Nothing changes and Scarlett Realm Mists grow
	id = th_sixty_year_cycle_incident_events.9
	title = "th_sixty_year_cycle_incident_events.9.t"
	desc = "th_sixty_year_cycle_incident_events.9.desc"
	picture = HIGAN_eventPicture
	
	trigger = {
		th_incident_is_investigator = yes
		NOT = { th_incident_has_been_resolved = { incident = sixty_year_cycle_incident } }
		th_incident_check_point_result = {
			value = 0
		}
		NOT = {
			th_incident_check_point_result = {
				value = 5
			}
		}
		NOT = { has_country_flag = th_incident_last_fight_terribly_lost }
		th_incident_current_stage = {
			stage = 7
		}
		th_current_incident = {
			incident = sixty_year_cycle_incident
		}
		NOT = { has_country_flag = th_just_finished_incident_danmaku_fight }
	}
	
	immediate = {
		hidden_effect = { 
			th_resolve_incident = { incident = sixty_year_cycle_incident }
		}
	}
	
	mean_time_to_happen = {
		months = 12
	}
	major = yes
	
	option = {		#Well, I've done what I could.
		name = "th_sixty_year_cycle_incident_events.9.a"
		custom_tooltip = th_sixty_year_cycle_incident_events.9.a.tt
		if = {
			limit = {
				exists = HIG
			}
			HIG = {
				add_country_modifier = {
					name = th_POFV_reorganized_the_shinigami
					duration = 1825
				}
			}
		}
		add_adm_power = -100
		add_prestige = -10
		add_devotion = -10
	}
}

#Sixty Year Cycle Great Barrier Incident - OK Outcome
country_event = { 
	id = th_sixty_year_cycle_incident_events.10
	title = "th_sixty_year_cycle_incident_events.10.t"
	desc = "th_sixty_year_cycle_incident_events.10.desc"
	picture = SHRINE_eventPicture
	
	trigger = {
		th_incident_is_investigator = yes
		NOT = { has_country_flag = th_incident_last_fight_terribly_lost }
		NOT = { th_incident_has_been_resolved = { incident = sixty_year_cycle_incident } }
		th_incident_check_point_result = {
			value = 5
		}
		NOT = {
			th_incident_check_point_result = {
				value = 10
			}
		}
		th_incident_current_stage = {
			stage = 7
		}
		th_current_incident = {
			incident = sixty_year_cycle_incident
		}
		NOT = { has_country_flag = th_just_finished_incident_danmaku_fight }
	}

	immediate = {
		hidden_effect = { 
			th_resolve_incident = { incident = sixty_year_cycle_incident }
		}
	}
	
	mean_time_to_happen = {
		months = 12
	}
	major = yes
	
	option = {		#Finally, it's over.
		name = "th_sixty_year_cycle_incident_events.10.a"
		th_solve_incident = {
			incident = sixty_year_cycle_incident
		}
		if = {
			limit = {
				OR = {
					was_tag = HKR
					tag = HKR
					was_tag = FOM
					tag = FOM
				}
			}
			add_country_modifier = {
				name = "th_POFV_inci_overcame_komachi"
				duration = 9125
			}
		}
		else = {			
			add_country_modifier = {
				name = "th_POFV_inci_overcame_komachi"
				duration = 3650
			}
		}
		add_adm_power = 100
		add_prestige = 25
		add_devotion = 10
	}
}

#Sixty Year Cycle Great Barrier Incident - Good Outcome
country_event = { #Okuu tells Reimu/Marisa about these weird gods
	id = th_sixty_year_cycle_incident_events.11
	title = "th_sixty_year_cycle_incident_events.11.t"
	desc = "th_sixty_year_cycle_incident_events.11.desc"
	picture = THFEST_eventPicture
	
	trigger = {
		th_incident_check_point_result = {
			value = 10
		}
		th_incident_is_investigator = yes
		NOT = { has_country_flag = th_incident_last_fight_terribly_lost }
		NOT = { th_incident_has_been_resolved = { incident = sixty_year_cycle_incident } }
		th_incident_current_stage = {
			stage = 7
		}
		th_current_incident = {
			incident = sixty_year_cycle_incident
		}
		NOT = { has_country_flag = th_just_finished_incident_danmaku_fight }
	}
	
	immediate = {
		hidden_effect = { 
			th_resolve_incident = { incident = sixty_year_cycle_incident }
		}
	}
	
	mean_time_to_happen = {
		months = 12
	}
	major = yes
	
	option = {		#Of course it's a Moriya Shrine conspiracy
		name = "th_sixty_year_cycle_incident_events.11.a"
		th_solve_incident = {
			incident = sixty_year_cycle_incident
		}
		custom_tooltip = th_sixty_year_cycle_incident_events.11.a.tt
		highlight = yes
		add_adm_power = -25
		add_prestige = 35
		if = {
			limit = {
				OR = {
					was_tag = HKR
					tag = HKR
				}
			}
			add_country_modifier = {
				name = "th_POFV_inci_overcame_komachi"
				duration = 9125
			}
		}
		else_if = {
			limit = {
				OR = {
					was_tag = FOM
					tag = FOM
				}
			}
			add_country_modifier = {
				name = "th_POFV_inci_overcame_komachi"
				duration = 9125
			}
		}
		else = {			
			add_country_modifier = {
				name = "th_POFV_inci_overcame_komachi"
				duration = 3650
			}
		}
		#hidden_effect = {
		#	country_event = {
		#		id = th_sixty_year_cycle_incident_events.8
		#		days = 90
		#	}
		#}
	}
	
	option = {		#The rain will stop eventually. She can stay here for awhile.
		name = "th_sixty_year_cycle_incident_events.11.b"
		th_solve_incident = {
			incident = sixty_year_cycle_incident
		}
		if = {
			limit = {
				OR = {
					was_tag = HKR
					tag = HKR
				}
			}
			add_country_modifier = {
				name = "th_POFV_inci_overcame_komachi"
				duration = 9125
			}
		}
		else_if = {
			limit = {
				OR = {
					was_tag = FOM
					tag = FOM
				}
			}
			add_country_modifier = {
				name = "th_POFV_inci_overcame_komachi"
				duration = 9125
			}
		}
		else = {			
			add_country_modifier = {
				name = "th_POFV_inci_overcame_komachi"
				duration = 3650
			}
		}
		add_adm_power = 150
		add_prestige = 25
		add_devotion = 10
	}
}

#Sixty Year Cycle Great Barrier Incident - EXTRA Outcome Good
country_event = { #Their plan succeeded nonetheless...
	id = th_sixty_year_cycle_incident_events.12
	title = "th_sixty_year_cycle_incident_events.12.t"
	desc = "th_sixty_year_cycle_incident_events.12.desc"
	picture = KANAKOSUWAKO_eventPicture
	
	is_triggered_only = yes	
	major = yes
	
	option = {		#The rain will stop eventually. She can stay here for awhile.
		name = "th_sixty_year_cycle_incident_events.12.a"	
		custom_tooltip = th_sixty_year_cycle_incident_events.12.a.tt
		th_solve_incident_extra = {
			incident = sixty_year_cycle_incident
		}
		if = {
			limit = {
				OR = {
					was_tag = HKR
					tag = HKR
				}
			}
			add_country_modifier = {
				name = "th_POFV_inci_extra"
				duration = 9125
			}
		}
		else_if = {
			limit = {
				OR = {
					was_tag = FOM
					tag = FOM
				}
			}
			add_country_modifier = {
				name = "th_POFV_inci_extra"
				duration = 9125
			}
		}
		else = {			
			add_country_modifier = {
				name = "th_POFV_inci_extra"
				duration = 3650
			}
		}
		add_adm_power = 150
		if = {
			limit = {
				has_country_flag = th_increased_donations_from_events
			}
			add_years_of_income = 3
		}
		else = {
			add_years_of_income = 2
		}
		add_prestige = 50
		add_devotion = 10
	}
}



#Sixty Year Cycle Great Barrier Incident - Random events - HIG gets buff
country_event = {
	id = th_sixty_year_cycle_incident_events.14
	title = "th_sixty_year_cycle_incident_events.14.t"
	desc = "th_sixty_year_cycle_incident_events.14.desc"
	picture = EIKIBOSS_eventPicture
	
	trigger = {
		th_is_or_was_tag = { tag = HIG }
		th_current_incident = { incident = sixty_year_cycle_incident }
	}
	
	fire_only_once = yes
	major = yes
	
	mean_time_to_happen = {
		months = 12
	}
	
	option = {	#Looks like I have to do more lecutres in the near future
		name = "th_sixty_year_cycle_incident_events.14.a"
		add_country_modifier = {
			name = th_POFV_the_lecturing
			duration = 9125
		}
	}
}

#Sixty Year Cycle Great Barrier Incident - Random Flower events - Satori demands her land back
province_event = {
	id = th_sixty_year_cycle_incident_events.19
	title = "th_sixty_year_cycle_incident_events.19.t"
	desc = "th_sixty_year_cycle_incident_events.19.desc"
	picture = FORMERHELL_eventPicture
	goto = ROOT
	trigger = {
		owner = { ai = no }
		th_current_incident = { incident = sixty_year_cycle_incident }
		NOT = { has_province_flag = chireiden_revolt }
		NOT = { local_autonomy = 1 }
		region = former_hell_region
		culture = Chireidean
		owner = {
			NOT = { th_is_or_was_tag = { tag = CRD } }
			NOT = { tag = SCD }
			is_free_or_tributary_trigger = yes
			num_of_cities = 4
		}
	}

	mean_time_to_happen = {
		months = 30
		modifier = {
			factor = 0.5
			any_neighbor_province = {
				has_province_flag = chireiden_revolt
			}
		}
		modifier = {
			factor = 0.5
			has_owner_religion = no
		}
		modifier = {
			factor = 0.5
			owner = {
				NOT = { culture_group = ROOT }
			}
		}
		modifier = {
			factor = 0.5
			owner = {
				NOT = { primary_culture = ROOT }
				NOT = { accepted_culture = ROOT }
			}
		}
		modifier = {
			factor = 0.5
			owner = { war_with = CRD }
		}
		modifier = {
			factor = 0.75
			unrest = 3
		}
		modifier = {
			factor = 0.75
			unrest = 5
		}
		modifier = {
			factor = 0.75
			unrest = 7
		}
		modifier = {
			factor = 0.75
			unrest = 9
		}
	}

	option = {
		name = "th_sixty_year_cycle_incident_events.19.a"
		set_province_flag = chireiden_revolt
		spawn_rebels = {
			type = nationalist_rebels
			size = 1
			friend = CRD
		}
		
		ai_chance = { 
			factor = 90
		}
	}
	option = {
		name = "th_sixty_year_cycle_incident_events.19.b"
		cede_province = CRD
		
		ai_chance = { 
			factor = 10
		}
	}
}

#Sixty Year Cycle Great Barrier Incident - Random Flower events - Satori demands her independence back
country_event = {
	id = th_sixty_year_cycle_incident_events.20
	title = "th_sixty_year_cycle_incident_events.20.t"
	desc = "th_sixty_year_cycle_incident_events.20.desc"
	picture = FORMERHELL_eventPicture
	
	trigger = {
		th_current_incident = { incident = sixty_year_cycle_incident }
		NOT = { has_country_flag = scr_appealed_satori }
		overlord_of = CRD
		CRD = {
			NOT = { has_country_modifier = th_SA_demands_independence }
			NOT = { has_country_modifier = th_inci_rebellious_subject }
		}
	}
	
	mean_time_to_happen = {
		months = 1
	}
	
	option = {		#Nah
		name = "th_sixty_year_cycle_incident_events.20.a"
		if = {
			limit = {
				th_is_or_was_tag = {
					tag = SCR
				}
			}
			CRD = {
				add_country_modifier = {
					name = "th_inci_rebellious_subject"
					duration = 5475
				}
			}
		}
		else = {
			CRD = {
				add_country_modifier = {
					name = "th_SA_demands_independence"
					duration = 5475
				}
			}
		}
		
		ai_chance = { 
			factor = 90
		}
	}
	
	option = {		#The satori is the stress not worth.
		name = "th_sixty_year_cycle_incident_events.20.b"
		trigger = {
			NOT = { th_is_or_was_tag = { tag = SCR } }
		}
		CRD = {
			grant_independence = yes 
		}
		
		ai_chance = { 
			factor = 10
		}
	}
}

#Sixty Year Cycle Great Barrier Incident - Random Flower events - Province gets a random flower modifier + effect (Spring/Summer/Fall/Winter) TODO
province_event = {
	id = th_sixty_year_cycle_incident_events.25
	title = none
	desc = none
	picture = HIGAN_eventPicture
	
	trigger = {
		NOT = { has_province_modifier = th_SA_wandering_vengeful_spirits }
		NOT = { has_province_modifier = th_SA_wandering_helpful_spirits }
		th_current_incident = { incident = sixty_year_cycle_incident }
		superregion = gensokyo_superregion
		NOT = { culture = Chireidean }
		owner = {
			NOT = { th_is_or_was_tag = { tag = CRD } }
			OR = {
				is_free_or_tributary_trigger = yes
				overlord = {
					NOT = { th_is_or_was_tag = { tag = CRD } }
				}
			}
		}
	}
	
	mean_time_to_happen = {
		months = 60
	}
	
	hidden = yes
	
	option = {		#A geyser popped up!
		random_list = {
			90 = {
				add_province_modifier = {
					name = th_SA_wandering_vengeful_spirits
					duration = -1
					desc = th_incident_duration_tt
				}
			}
			10 = {
				add_province_modifier = {
					name = th_SA_wandering_helpful_spirits
					duration = 1460
				}
			}
		}
		
		ai_chance = { 
			factor = 100
		}		
	}
}

#Sixty Year Cycle Great Barrier Incident - Province cleans itself
province_event = {
	id = th_sixty_year_cycle_incident_events.260
	title = none
	desc = none
	picture = SHRINE_eventPicture
	
	trigger = {
		OR = {
			has_province_modifier = th_SA_wandering_vengeful_spirits
			has_province_modifier = th_SA_wandering_helpful_spirits
		}
		OR = {
			owner = {
				OR = { 
					th_is_or_was_tag = { tag = CRD } 
					is_subject_of = CRD
				}
			}
			th_does_not_have_current_incident = { incident = sixty_year_cycle_incident }
		}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	hidden = yes
	
	option = {
		remove_province_modifier = th_SA_wandering_vengeful_spirits
		remove_province_modifier = th_SA_wandering_helpful_spirits		
		
		ai_chance = { 
			factor = 100
		}
	}		
}



#Sixty Year Cycle Great Barrier Incident - Forbid HIG, SNZ
country_event = {
	id = th_sixty_year_cycle_incident_events.271
	title = none
	desc = none
	picture = HIGAN_eventPicture

	trigger = {
		th_current_incident = { incident = sixty_year_cycle_incident }
		OR = {
			th_is_or_was_tag = { tag = HIG }
			th_is_or_was_tag = { tag = SNZ }
		}
		NOT = { has_country_flag = th_is_not_valid_for_investiagtor_role }
	}

	mean_time_to_happen = {
		days = 1
	}

	hidden = yes

	option = {
		set_country_flag = th_is_not_valid_for_investiagtor_role

		ai_chance = {
			factor = 100
		}
	}
}

#Sixty Year Cycle Great Barrier Incident - Special Case: nobody can become investigator
country_event = {
	id = th_sixty_year_cycle_incident_events.26
	title = "th_sixty_year_cycle_incident_events.26.t"
	desc = "th_sixty_year_cycle_incident_events.26.desc"
	picture = HIGAN_eventPicture
	
	trigger = {
		th_current_incident = { incident = sixty_year_cycle_incident }		
		gensokyo_superregion = {
			owner = {
				OR = {
					th_is_or_was_tag = { tag = HIG }
					is_subject_of = HIG
				}
			}
		}
		th_is_or_was_tag = { tag = HIG }
		all_country = { th_incident_can_not_become_investigator = yes }
		NOT = { th_incident_has_been_resolved = { incident = sixty_year_cycle_incident } }
	}
	
	mean_time_to_happen = {
		days = 5
	}
	
	immediate = {
		hidden_effect = { 
			th_resolve_incident = { incident = sixty_year_cycle_incident }
		}
	}
	
	major = yes
	
	option = {		#Time to resolve this issue on my own
		name = "th_sixty_year_cycle_incident_events.26.a"
		custom_tooltip = th_sixty_year_cycle_incident_events.26.a.tt					
		add_country_modifier = {
			name = "th_POFV_reorganized_the_shinigami"
			duration = 9125
		}		
	}
}

#Sixty Year Cycle Great Barrier Incident - Special Case: nobody can become investigator, but Gensokyo was NOT united by Eiki
country_event = {
	id = th_sixty_year_cycle_incident_events.27
	title = "th_sixty_year_cycle_incident_events.27.t"
	desc = "th_sixty_year_cycle_incident_events.27.desc"
	picture = HIGAN_eventPicture
	
	trigger = {
		th_current_incident = { incident = sixty_year_cycle_incident }	
		any_province = {
			superregion = gensokyo_superregion
			NOT = { owned_by = HIG }
			NOT = { owner = { is_subject_of = HIG } }
		}	
		owns = 5007
		all_country = {
			th_incident_can_not_become_investigator = yes
		}
		NOT = { th_incident_has_been_resolved = { incident = sixty_year_cycle_incident } }
	}
	
	mean_time_to_happen = {
		days = 5
	}
	
	immediate = {
		hidden_effect = { 
			th_resolve_incident = { incident = sixty_year_cycle_incident }
		}
	}
	
	major = yes
	
	option = {		#I will have to resolve it myself then
		name = "th_sixty_year_cycle_incident_events.27.a"
		trigger = {
			th_is_or_was_tag = { tag = HIG }
		}				
		add_country_modifier = {
			name = "th_POFV_reorganized_the_shinigami"
			duration = 3650
		}
	}
	option = {		#Nobody is investigating. We can only pray for mist`s gone
		name = "th_sixty_year_cycle_incident_events.27.b"
		trigger = {
			NOT = { tag = HIG }
			NOT = { was_tag = HIG }
		}
		add_stability = -2
	}
}

############################TERMINATION############################
#Sixty Year Cycle Great Barrier Incident - Bad Outcome
country_event = { #The Yamaxandu resolves the incident on her own
	id = th_sixty_year_cycle_incident_events.100
	title = "th_sixty_year_cycle_incident_events.9.t"
	desc = "th_sixty_year_cycle_incident_events.9.desc"
	picture = HIGAN_eventPicture

	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			th_resolve_incident = { incident = sixty_year_cycle_incident }
		}
	}
	major = yes
	
	option = {		#Well, I've done what I could.
		name = "th_sixty_year_cycle_incident_events.9.a"
		custom_tooltip = th_sixty_year_cycle_incident_events.9.a.tt
		if = {
			limit = {
				exists = HIG
			}
			HIG = {
				add_country_modifier = {
					name = th_POFV_reorganized_the_shinigami
					duration = 1825
				}
			}
		}
		add_adm_power = -100
		add_prestige = -10
		add_devotion = -10
	}
}

#Sixty Year Cycle Great Barrier Incident - DEBUG - Start Incident
country_event = {
	id = th_sixty_year_cycle_incident_events.1000
	title = none
	desc = none
	picture = HIGAN_eventPicture
	hidden = yes
	is_triggered_only = yes

	immediate = {
		th_incident_forbid_country_to_investigate = { who = HIG }
		th_incident_forbid_country_to_investigate = { who = SNZ }
		th_start_incident_effect = {
			incident = sixty_year_cycle_incident
		}
		gensokyo_superregion = {
			limit = {
				NOT = { has_province_modifier = th_POFV_random_flower_bed }
			}
			add_province_modifier = {
				name = th_POFV_random_flower_bed
				duration = -1
			}
		}
	}

	option = {		#Check any possible investigator country
		random_country = {
			limit = { 
				th_incident_can_become_investigator = yes
			}
			th_incident_setup_investigator = yes
			th_incident_introduction_event = {
				id = th_sixty_year_cycle_incident_events.1
			}
		}
		ai_chance = { 
			factor = 100
		}
	}
}