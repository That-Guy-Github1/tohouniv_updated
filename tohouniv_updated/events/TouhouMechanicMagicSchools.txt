namespace = th_magic_schools

#Select School Specialization at the start of each new Age
country_event = {
	id = th_magic_schools.1
	title = th_magic_schools.1.t
	desc = th_magic_schools.1.desc
	picture = MAGICALLIBRARY_eventPicture

	trigger = {
		has_government_attribute = th_has_spell_schools
		OR = {
			AND = {
				current_age = age_of_discovery
				NOT = { has_country_flag = th_not_specialized_for_age_of_discovery }
			}
			AND = {
				current_age = age_of_reformation
				NOT = { has_country_flag = th_not_specialized_for_age_of_reformation }
			}
			AND = {
				current_age = age_of_absolutism
				NOT = { has_country_flag = th_not_specialized_for_age_of_absolutism }
			}
			AND = {
				current_age = age_of_revolutions
				NOT = { has_country_flag = th_not_specialized_for_age_of_revolutions }
			}
		}
	}
	
	mean_time_to_happen = {
		months = 1
	}

	immediate = {
		hidden_effect = {
			trigger_switch = {
				on_trigger = current_age
				age_of_discovery = { set_country_flag = th_not_specialized_for_age_of_discovery }
				age_of_reformation = { set_country_flag = th_not_specialized_for_age_of_reformation }
				age_of_absolutism = { set_country_flag = th_not_specialized_for_age_of_absolutism }
				age_of_revolutions = { set_country_flag = th_not_specialized_for_age_of_revolutions }
			}
		}
	}

	option = { #Skill Conjuration
		name = "th_magic_schools.1.a"
		mim_skill_magic_school = {
			school = conjuration
		}

		ai_chance = {
			factor = 100
		}
	}

	option = { #Skill Evocation
		name = "th_magic_schools.1.b"
		mim_skill_magic_school = {
			school = evocation
		}
		
		ai_chance = {
			factor = 100
		}
	}

	option = { #Skill Divination
		name = "th_magic_schools.1.c"
		mim_skill_magic_school = {
			school = divination
		}
		
		ai_chance = {
			factor = 100
		}
	}

	option = { #Skill Transmutation
		name = "th_magic_schools.1.d"
		mim_skill_magic_school = {
			school = transmutation
		}
		
		ai_chance = {
			factor = 100
		}
	}

	option = { #Skill Enchanting
		name = "th_magic_schools.1.e"
		mim_skill_magic_school = {
			school = enchanting
		}
		
		ai_chance = {
			factor = 100
		}
	}

	option = { #Skill Abjuration
		name = "th_magic_schools.1.f"
		mim_skill_magic_school = {
			school = abjuration
		}
		
		ai_chance = {
			factor = 100
		}
	}
}

#Remove school + all associated modifier if government reform gets lost
country_event = {
	id = th_magic_schools.2
	title = none
	desc = none
	picture = MAGICALLIBRARY_eventPicture
	hidden = yes
	trigger = {
		NOT = { has_government_attribute = th_has_spell_schools }
		OR = {
			has_country_flag = th_not_specialized_for_age_of_discovery
			has_country_flag = th_not_specialized_for_age_of_reformation
			has_country_flag = th_not_specialized_for_age_of_absolutism
			has_country_flag = th_not_specialized_for_age_of_revolutions
		}
	}
	option = {
		remove_country_modifier = th_conjuration_level_1
		remove_country_modifier = th_conjuration_level_2
		remove_country_modifier = th_conjuration_level_3
		remove_country_modifier = th_conjuration_level_4
		remove_country_modifier = th_evocation_level_1
		remove_country_modifier = th_evocation_level_2
		remove_country_modifier = th_evocation_level_3
		remove_country_modifier = th_evocation_level_4
		remove_country_modifier = th_divination_level_1
		remove_country_modifier = th_divination_level_2
		remove_country_modifier = th_divination_level_3
		remove_country_modifier = th_divination_level_4
		remove_country_modifier = th_transmutation_level_1
		remove_country_modifier = th_transmutation_level_2
		remove_country_modifier = th_transmutation_level_3
		remove_country_modifier = th_transmutation_level_4
		remove_country_modifier = th_enchanting_level_1
		remove_country_modifier = th_enchanting_level_2
		remove_country_modifier = th_enchanting_level_3
		remove_country_modifier = th_enchanting_level_4
		remove_country_modifier = th_abjuration_level_1
		remove_country_modifier = th_abjuration_level_2
		remove_country_modifier = th_abjuration_level_3
		remove_country_modifier = th_abjuration_level_4
		clr_country_flag = th_not_specialized_for_age_of_discovery
		clr_country_flag = th_not_specialized_for_age_of_reformation
		clr_country_flag = th_not_specialized_for_age_of_absolutism
		clr_country_flag = th_not_specialized_for_age_of_revolutions
		set_variable = { which = th_magic_school_conjuration value = 0 }
		set_variable = { which = th_magic_school_evocation value = 0 }
		set_variable = { which = th_magic_school_divination value = 0 }
		set_variable = { which = th_magic_school_transmutation value = 0 }
		set_variable = { which = th_magic_school_enchanting value = 0 }
		set_variable = { which = th_magic_school_abjuration value = 0 }
		ai_chance = {
			factor = 1
		}
	}
}

#Info event
country_event = {
	id = th_magic_schools.100
	title = th_magic_schools.100.t
	desc = th_magic_schools.100.desc
	picture = MAGICALLIBRARY_eventPicture
	is_triggered_only = yes

	option = {
		name = th_magic_schools.100.a
	}
}