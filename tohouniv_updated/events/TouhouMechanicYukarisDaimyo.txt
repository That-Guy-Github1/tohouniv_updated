########################################
# Events for the Yukari daimyos
########################################

namespace = th_yukari_daimyo_mechanic

#Mayohiga's Daimyos - break vassalization, if Mayohiga changes government reform
country_event = {
	id = th_yukari_daimyo_mechanic.1
	title = th_yukari_daimyo_mechanic.1.t
	desc = th_yukari_daimyo_mechanic.1.desc
	picture = YUKARI_eventPicture
	
	mean_time_to_happen = {
		months = 1
	}
	
	trigger = {
		NOT = { has_government_attribute = enables_yukaris_shogunate }
		num_of_subjects = 1 
		any_subject_country = { is_subject_of_type = th_yukari_daimyo }
	}
	
	immediate = {
		hidden_effect = {
			every_subject_country = { 
				limit = { is_subject_of_type = th_yukari_daimyo } 
				country_event = { id = th_yukari_daimyo_mechanic.2 }
			}
		}
	}
	
	option = {	#Abuse what?
		name = th_yukari_daimyo_mechanic.1.a
	}
	option = {	#Worth it.
		name = th_yukari_daimyo_mechanic.1.b
	}
	option = {	#Welp, bye Daimyos.
		name = th_yukari_daimyo_mechanic.1.c
	}
	option = {	#You start to getting annoying...
		name = th_yukari_daimyo_mechanic.1.d
	}
	option = {	#Can I have my immersion back, please?
		name = th_yukari_daimyo_mechanic.1.e
	}
}

#Mayohiga's Daimyos get independent
country_event = {
	id = th_yukari_daimyo_mechanic.2
	title = th_yukari_daimyo_mechanic.2.t
	desc = th_yukari_daimyo_mechanic.2.desc
	picture = LIBERUM_VETO_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		AND = {
			is_subject = yes
			is_subject_of_type = th_yukari_daimyo
		}
		overlord = {
			NOT = { has_government_attribute = enables_yukaris_shogunate }
		}
	}
	
	option = {	#We are now masters of our own fate.
		name = th_yukari_daimyo_mechanic.2.a
		grant_independence = yes
	}
}

#Mayohiga's vassals become daimyos
country_event = {
	id = th_yukari_daimyo_mechanic.3
	title = th_yukari_daimyo_mechanic.3.t
	desc = th_yukari_daimyo_mechanic.3.desc
	picture = YUKARI_eventPicture
	
	mean_time_to_happen = {
		days = 0
	}

	hidden = yes
	
	trigger = {
		has_government_attribute = enables_yukaris_shogunate
		num_of_subjects = 1 
		OR = {
			any_subject_country = { is_subject_of_type = vassal }
			any_subject_country = { is_subject_of_type = daimyo_vassal }
		}		
	}
	immediate = {
		hidden_effect = {
			every_subject_country = { 
				limit = { 
					OR = { 
						is_subject_of_type = vassal 
						is_subject_of_type = daimyo_vassal
					}
					NOT = { is_subject_of_type = th_yukari_daimyo }
				} 
				country_event = { id = th_yukari_daimyo_mechanic.4 }
			}
		}
	}
	
	option = {
		name = th_yukari_daimyo_mechanic.3.a

		ai_chance = { 
			factor = 100
		}
	}
}

#Vassal becomes Daimyo
country_event = {
	id = th_yukari_daimyo_mechanic.4
	title = th_yukari_daimyo_mechanic.4.t
	desc = th_yukari_daimyo_mechanic.4.desc
	picture = GENSOKYOTHRONE_eventPicture
	
	is_triggered_only = yes

	hidden = yes
	
	option = {	#Long live Yukari
		name = th_yukari_daimyo_mechanic.4.a
		grant_independence = yes
		FROM = {
			create_subject = {
				subject_type = th_yukari_daimyo
				subject = ROOT
			}
		}
		
		ai_chance = { 
			factor = 100
		}
	}
}

#Daimyo becomes too powerful and wants more rights!
country_event = {
	id = th_yukari_daimyo_mechanic.5
	title = th_yukari_daimyo_mechanic.5.t
	desc = th_yukari_daimyo_mechanic.5.desc
	picture = GENSOKYOTHRONE_eventPicture

	trigger = {
		is_subject = yes
		is_subject_of_type = th_yukari_daimyo
		NOT = { has_ruler_flag = mhg_decided_to_remain_daimyo_flag }
		total_development = 300
		overlord = {
			NOT = { truce_with = ROOT }
		}
		OR = {
			NOT = { has_country_flag = mhg_had_independence_event }
			had_country_flag = {
				flag = mhg_had_independence_event
				days = 3650
			}
		}
	}

	mean_time_to_happen = {
		days = 1
	}

	immediate = {
		hidden_effect = {
			clr_country_flag = mhg_had_independence_event
			set_country_flag = mhg_had_independence_event
			overlord = {
				save_event_target_as = mhg_overlord
			}
		}
	}

	option = {	#Request for a higher position
		name = th_yukari_daimyo_mechanic.5.a
		custom_tooltip = th_yukari_daimyo_mechanic.5.a.tt
		event_target:mhg_overlord = {				
			country_event = {
				id = th_yukari_daimyo_mechanic.6
			}
		}

		ai_chance = {
			factor = 0.75
			modifier = {
				factor = 0.5
				army_size = event_target:mhg_overlord
			}
			modifier = {
				factor = 0.5
				total_development = event_target:mhg_overlord
			}
			modifier = {
				factor = 0.5
				land_morale = event_target:mhg_overlord
				mil_tech = event_target:mhg_overlord
			}
			modifier = {
				factor = 0.25
				OR = {
					NOT = { liberty_desire = 25 }
					has_opinion = {
						who = event_target:mhg_overlord
						value = 100
					}
				}
			}
		}
	}

	option = {	#We have grown too much as we could be Yukari's slave!
		name = th_yukari_daimyo_mechanic.5.b
		declare_war_with_cb = {
			casus_belli = cb_independence_war
			who = ROOT
		}

		ai_chance = {
			factor = 0.25
			modifier = {
				factor = 2
				army_size = event_target:mhg_overlord
			}
			modifier = {
				factor = 2
				total_development = event_target:mhg_overlord
			}
			modifier = {
				factor = 2
				land_morale = event_target:mhg_overlord
				mil_tech = event_target:mhg_overlord
			}
			modifier = {
				factor = 0
				OR = {
					NOT = { liberty_desire = 25 }
					has_opinion = {
						who = event_target:mhg_overlord
						value = 100
					}
				}
			}
		}
	}

	option = {	#We should stick with Mayohiga
		name = th_yukari_daimyo_mechanic.5.c
		hidden_effect = {
			set_ruler_flag = mhg_decided_to_remain_daimyo_flag
		}

		ai_chance = {
			factor = 0
		}
	}
}

#Daimyo becomes too powerful! - It asks for Promotion
country_event = {
	id = th_yukari_daimyo_mechanic.6
	title = th_yukari_daimyo_mechanic.6.t
	desc = th_yukari_daimyo_mechanic.6.desc
	picture = GENSOKYOTHRONE_eventPicture
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			set_variable = {
				which = mhg_num_of_marches
				value = 0
			}
			every_subject_country = {
				limit = {
					is_subject_of_type = th_yukari_march
				}
				ROOT = {
					change_variable = {
						which = mhg_num_of_marches
						value = 1
					}
				}
			}
			export_to_variable = {
				which = mhg_allowed_marches
				value = modifier:daimyo_capacity
			}
		}
	}
	
	option = {	#I suppose one more march is fine
		name = th_yukari_daimyo_mechanic.6.a
		hidden_effect = {
			FROM = { 
				grant_independence = yes
				country_event = {
					id = th_yukari_daimyo_mechanic.7
				}
			}
		}
		create_subject = {
			subject_type = th_yukari_march
			subject = FROM
		}
		if = {
			limit = {
				check_variable = {
					which = mhg_num_of_marches
					which = mhg_allowed_marches
				}
			}
			custom_tooltip = th_yukari_daimyo_mechanic.6.a.tt
		}
		
		ai_chance = { 
			factor = 100
			modifier = {
				factor = 0
				check_variable = {
					which = mhg_num_of_marches
					which = mhg_allowed_marches
				}
			}
		}
	}
	
	option = {	#I demand you to give some land back!
		name = th_yukari_daimyo_mechanic.6.b
		FROM = {
			country_event = {
				id = th_yukari_daimyo_mechanic.8
			}
		}
		custom_tooltip = th_yukari_daimyo_mechanic.6.b.tt
		
		ai_chance = { 
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					check_variable = {
						which = mhg_num_of_marches
						which = mhg_allowed_marches
					}
				}
			}
		}
	}
	
	option = {	#They are not worth my time
		name = th_yukari_daimyo_mechanic.6.c
		FROM = {
			grant_independence = yes
		}
		hidden_effect = {
			FROM = {
				country_event = {
					id = th_yukari_daimyo_mechanic.9
				}
			}
		}
		
		ai_chance = { 
			factor = 0
		}
	}
}

#Daimyo becomes too powerful! - We are a march now!
country_event = {
	id = th_yukari_daimyo_mechanic.7
	title = th_yukari_daimyo_mechanic.7.t
	desc = th_yukari_daimyo_mechanic.7.desc
	picture = GENSOKYOTHRONE_eventPicture
	
	is_triggered_only = yes
	
	option = {	#Nice
		name = th_yukari_daimyo_mechanic.7.a
		tooltip = {
			FROM = {
				create_subject = {
					subject_type = th_yukari_march
					subject = ROOT
				}
			}
		}
		
		ai_chance = { 
			factor = 1
		}
	}
}

#Daimyo becomes too powerful! - MHG demands land!
country_event = {
	id = th_yukari_daimyo_mechanic.8
	title = th_yukari_daimyo_mechanic.8.t
	desc = th_yukari_daimyo_mechanic.8.desc
	picture = GENSOKYOTHRONE_eventPicture
	
	is_triggered_only = yes
	
	option = {	#Fiiine
		name = th_yukari_daimyo_mechanic.8.a
		tooltip = {
			FROM = {
				create_subject = {
					subject_type = th_yukari_march
					subject = ROOT
				}
			}
		}
		
		ai_chance = { 
			factor = 1
		}
	}
	
	option = {	#I have a better suggestion: WAR!
		name = th_yukari_daimyo_mechanic.8.b
		tooltip = {
			FROM = {
				create_subject = {
					subject_type = th_yukari_march
					subject = ROOT
				}
			}
		}
		
		ai_chance = { 
			factor = 1
		}
	}
}

#Daimyo becomes too powerful! - Independence!
country_event = {
	id = th_yukari_daimyo_mechanic.9
	title = th_yukari_daimyo_mechanic.9.t
	desc = th_yukari_daimyo_mechanic.9.desc
	picture = GENSOKYOTHRONE_eventPicture
	
	is_triggered_only = yes
	
	option = {	#Nice
		name = th_yukari_daimyo_mechanic.9.a
		tooltip = {
			grant_independence = yes
		}
		
		ai_chance = { 
			factor = 1
		}
	}
}