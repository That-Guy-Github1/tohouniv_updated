########################################
# Flavor Events for Kappapolis
########################################	

namespace = flavor_kpp

# Election!
country_event = {
	id = flavor_kpp.1
	title = flavor_kpp.1.t
	picture = NITORIBOSS_eventPicture	#TODO
	
	desc = {
		trigger = {
			has_regency = no
			NOT = { has_ruler_flag = leader_has_been_pushed_out }
			OR = {
				NOT = { has_government_attribute = th_has_limited_terms }
				check_variable = {
					which = max_election_term
					which = election_term
				}
			}
		}
		desc = flavor_kpp.1.desc.a
	}
	
	desc = {
		trigger = {
			OR = {
				has_regency = yes
				has_ruler_flag = leader_has_been_pushed_out
				AND = {
					has_government_attribute = th_has_limited_terms
					NOT = {
						check_variable = {
							which = max_election_term
							which = election_term
						}
					}
				}
			}
		}
		desc = flavor_kpp.1.desc.b
	}
	
	is_triggered_only = yes
	
	trigger = {
		has_government_attribute = th_has_kappa_elections
		NOT = { has_disaster = th_kappa_guild_wars_disaster }
	}

	option = {
		name = "EVTOPTA700"	# Current ruler stays
		trigger = {
			ai = no
			has_regency = no
			NOT = { has_ruler_flag = leader_has_been_pushed_out }
			OR = {
				NOT = { has_government_attribute = th_has_limited_terms }
				check_variable = {
					which = max_election_term
					which = election_term
				}
			}
		}
		ai_chance = { 
			factor = 60
			modifier = {
				factor = 0
				NOT = { republican_tradition = 25 }
			}	
			modifier = {
				factor = 0.5
				NOT = { republican_tradition = 50 }
			}				
			modifier = {
				factor = 0.5
				NOT = { republican_tradition = 75 }
			}	
			modifier = {
				factor = 2.0
				republican_tradition = 90
			}		
		}
		custom_tooltip = remains_ruler
		if = {
			limit = { has_government_attribute = th_has_limited_terms }
			custom_tooltip = th_current_term_tt
		}
		change_adm = 1
		change_dip = 1
		change_mil = 1
		if = {
			limit = {
				has_ruler_modifier = th_elected_kappa_tinker
			}
			add_scaled_republican_tradition = -5
		}
		else = {
			add_scaled_republican_tradition = -10
		}
		random_list = {
			10 = {
				add_adm_power = 50
			}
			10 = {
				add_dip_power = 50
			}
			10 = {
				add_mil_power = 50
			}
		}
		add_karma = -5
		if = {
			limit = { has_country_modifier = kpp_overcame_anti_teamwork_disaster }
			change_innovativeness = 1
		}
		hidden_effect = {
			change_variable = {
				which = election_term
				value = 1
			}
		}
	}
	option = {
		name = "EVTOPTB700"	# An administrator type
		ai_chance = { factor = 20 }
		define_ruler = {
			mil = 1
			adm = 4
			dip = 1
			random_gender = yes # Allows random gender for republics
		}
		if = {
			limit = { 
				has_faction = mr_guilds 
			}
			add_faction_influence = {
				faction = mr_guilds
				influence = 20
			}				
		}
		add_karma = 10
		if = {
			limit = { has_country_modifier = kpp_overcame_anti_teamwork_disaster }
			change_innovativeness = 2
		}
		hidden_effect = {
			set_variable = {
				which = election_term
				value = 1
			}
		}
	}
	option = {
		name = "EVTOPTC700"	# A diplomat
		ai_chance = { factor = 20 }
		define_ruler = {
			dip = 4
			adm = 1
			mil = 1					
			random_gender = yes # Allows random gender for republics
		}
		if = {
			limit = { 
				has_faction = mr_traders 
			}
			add_faction_influence = {
				faction = mr_traders
				influence = 20
			}				
		}
		add_karma = 10		
		if = {
			limit = { has_country_modifier = kpp_overcame_anti_teamwork_disaster }
			change_innovativeness = 2
		}
		hidden_effect = {
			set_variable = {
				which = election_term
				value = 1
			}
		}
	}
	option = {
		name = "EVTOPTD700"	# A military man
		ai_chance = { factor = 20 }
		define_ruler = {
			mil = 4
			adm = 1
			dip = 1					
			random_gender = yes # Allows random gender for republics
		}
		if = {
			limit = { 
				has_faction = mr_aristocrats 
			}
			add_faction_influence = {
				faction = mr_aristocrats
				influence = 20
			}				
		}
		add_karma = 10
		if = {
			limit = { has_country_modifier = kpp_overcame_anti_teamwork_disaster }
			change_innovativeness = 2
		}
		hidden_effect = {
			set_variable = {
				which = election_term
				value = 1
			}
		}
	}

	option = { # Nepotism choice, re-electing within dynasty
		name = "EVTOPTE700"
		trigger = {
			has_government_attribute = enables_nepotism
		}
		ai_chance = { factor = 10 }
		if = {
			limit = {
				has_country_flag = strengthened_signoria_flag
			}
			custom_tooltip = strengthened_signoria_election_tt
			clr_country_flag = strengthened_signoria_flag
		}
		else = {
			add_scaled_republican_tradition = -4
		}
		define_ruler = {
			min_age = 20
			max_age = 40
			name = "lastname"
			random_gender = yes # Allows random gender for republics
		}
		if = {
			limit = { 
				has_faction = mr_aristocrats 
			}
			add_faction_influence = {
				faction = mr_aristocrats
				influence = 10
			}				
		}
		if = {
			limit = { has_country_modifier = kpp_overcame_anti_teamwork_disaster }
			change_innovativeness = 2
		}
		hidden_effect = {
			set_variable = {
				which = election_term
				value = 1
			}
		}
	}

	option = { # Nitori choice
		name = flavor_kpp.1.e
		trigger = {
			OR = {
				ai = yes
				AND = {
					has_government_attribute = th_kpp_can_elect_nitori
					th_has_not_original_ruler = yes
				}
			}
		}
		ai_chance = { factor = 100 }
		define_ruler = {
			name = "Nitori"
			dynasty = "Kawashiro"
			age = 20
			adm = 6
			dip = 5
			mil = 3
			female = yes
		}
		hidden_effect = {
			add_ruler_modifier = {
				name = th_elected_kappa_tinker
				duration = -1
			}
			add_ruler_personality = immortal_personality
			set_ruler_flag = touhou_character_ruler
			set_ruler_flag = touhou_original_ruler
			set_variable = {
				which = election_term
				value = 1
			}
		}
		if = {
			limit = { has_country_modifier = kpp_overcame_anti_teamwork_disaster }
			change_innovativeness = 1
		}
	}

	after = {
		if = {
			limit = { has_government_attribute = th_has_kappa_rebels }
			country_event = {
				id = flavor_kpp.30
			}
		}
	}
}

# Election! - Death
country_event = {
	id = flavor_kpp.2
	title = flavor_kpp.2.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = "EVTDESC701"
	
	is_triggered_only = yes
	
	trigger = {
		has_government_attribute = th_has_kappa_elections
		NOT = { has_disaster = th_kappa_guild_wars_disaster }
	}
	
	option = {
		name = "EVTOPTB700"	# An administrator type
		ai_chance = { factor = 40 }
		define_ruler = {
			mil = 1
			adm = 4
			dip = 1					
			random_gender = yes # Allows random gender for republics
		}
		if = {
			limit = { 
				has_faction = mr_guilds 
			}
			add_faction_influence = {
				faction = mr_guilds
				influence = 20
			}				
		}
		if = {
			limit = { has_country_modifier = kpp_overcame_anti_teamwork_disaster }
			change_innovativeness = 1
		}
	}
	option = {
		name = "EVTOPTC700"	# A diplomat
		ai_chance = { factor = 30 }
		define_ruler = {
			mil = 1
			adm = 4
			dip = 1					
			random_gender = yes # Allows random gender for republics
		}
		if = {
			limit = { 
				has_faction = mr_traders 
			}
			add_faction_influence = {
				faction = mr_traders
				influence = 20
			}				
		}			
		if = {
			limit = { has_country_modifier = kpp_overcame_anti_teamwork_disaster }
			change_innovativeness = 1
		}
	}
	option = {
		name = "EVTOPTD700"	# A military man
		ai_chance = { factor = 30 }
		define_ruler = {
			mil = 1
			adm = 4
			dip = 1					
			random_gender = yes # Allows random gender for republics
		}
		if = {
			limit = { 
				has_faction = mr_aristocrats 
			}
			add_faction_influence = {
				faction = mr_aristocrats
				influence = 20
			}				
		}		
		if = {
			limit = { has_country_modifier = kpp_overcame_anti_teamwork_disaster }
			change_innovativeness = 1
		}
	}
	option = { # Nepotism choice, re-electing within dynasty
		name = "EVTOPTE700"
		trigger = {
			has_government_attribute = enables_nepotism
		}
		ai_chance = { factor = 10 }
		if = {
			limit = {
				has_country_flag = strengthened_signoria_flag
			}
			custom_tooltip = strengthened_signoria_election_tt
			clr_country_flag = strengthened_signoria_flag
		}
		else = {
			add_scaled_republican_tradition = -4
		}
		define_ruler = {
			min_age = 20
			max_age = 40
			name = "lastname"
			random_gender = yes # Allows random gender for republics
		}
		if = {
			limit = { 
				has_faction = mr_aristocrats 
			}
			add_faction_influence = {
				faction = mr_aristocrats
				influence = 10
			}				
		}
		if = {
			limit = { has_country_modifier = kpp_overcame_anti_teamwork_disaster }
			change_innovativeness = 2
		}
	}

	after = {
		hidden_effect = {
			set_variable = {
				which = election_term
				value = 1
			}
		}
		if = {
			limit = { has_government_attribute = th_has_kappa_rebels }
			country_event = {
				id = flavor_kpp.30
			}
		}
	}
}

# The Establishment of the Kappa Corps
country_event = {
	id = flavor_kpp.3
	title = flavor_kpp.3.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.3.desc
	is_triggered_only = yes

	#Welcome to the Corps!
	option = {
		name = flavor_kpp.3.a
		capital_scope = {
			marine_infantry = ROOT
			marine_infantry = ROOT
			marine_infantry = ROOT
			marine_infantry = ROOT
		}
		add_country_modifier = {
			name = kpp_the_kappa_conscription
			duration = -1
		}
		add_army_professionalism = 0.05

		ai_chance = {
			factor = 1
		}
	}
}

# Settlement of Guinea
country_event = {
	id = flavor_kpp.4
	title = flavor_kpp.4.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = {
		desc = flavor_kpp.4.desc.a
		trigger = {
			guinea_region = {
				is_empty = yes
				has_port = yes
			}
		}
	}
	desc = {
		desc = flavor_kpp.4.desc.b
		trigger = {
			guinea_region = {
				OR = {
					has_port = no
					is_empty = no
				}
				type = all
			}
		}
	}
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			if = {
				limit = {
					guinea_region = {
						is_empty = yes
						has_port = yes
					}
				}
				random_province = {
					limit = {
						region = guinea_region
						is_empty = yes
						has_port = yes
						NOT = { has_province_flag = kpp_province_target }
					}
					save_event_target_as = kpp_african_province_to_settle_1
					set_province_flag = kpp_province_target
				}
				random_province = {
					limit = {
						region = guinea_region
						is_empty = yes
						has_port = yes
						NOT = { has_province_flag = kpp_province_target }
					}
					save_event_target_as = kpp_african_province_to_settle_2
					set_province_flag = kpp_province_target
				}
				random_province = {
					limit = {
						region = guinea_region
						is_empty = yes
						has_port = yes
						NOT = { has_province_flag = kpp_province_target }
					}
					save_event_target_as = kpp_african_province_to_settle_3
					set_province_flag = kpp_province_target
				}
				random_province = {
					limit = {
						region = guinea_region
						is_empty = yes
						has_port = yes
						NOT = { has_province_flag = kpp_province_target }
					}
					save_event_target_as = kpp_african_province_to_settle_4
					set_province_flag = kpp_province_target
				}
				random_province = {
					limit = {
						region = guinea_region
						is_empty = yes
						has_port = yes
						NOT = { has_province_flag = kpp_province_target }
					}
					save_event_target_as = kpp_african_province_to_settle_5
					set_province_flag = kpp_province_target
				}
			}
		}
	}
	after = {
		every_province = {
			limit = {
				has_province_flag = kpp_province_target
			}
			clr_province_flag = kpp_province_target
		}
	}

	#Colonize province 1
	option = {
		name = flavor_kpp.4.a
		goto = kpp_african_province_to_settle_1
		trigger = {
			has_saved_event_target = kpp_african_province_to_settle_1
		}
		event_target:kpp_african_province_to_settle_1 = {
			th_colonize_province_for_country = {
				who = ROOT
			}
		}

		ai_chance = {
			factor = 1
		}
	}

	#Colonize province 2
	option = {
		name = flavor_kpp.4.b
		goto = kpp_african_province_to_settle_2
		trigger = {
			has_saved_event_target = kpp_african_province_to_settle_2
		}
		event_target:kpp_african_province_to_settle_2 = {
			th_colonize_province_for_country = {
				who = ROOT
			}
		}

		ai_chance = {
			factor = 1
		}
	}

	#Colonize province 3
	option = {
		name = flavor_kpp.4.c
		goto = kpp_african_province_to_settle_3
		trigger = {
			has_saved_event_target = kpp_african_province_to_settle_3
		}
		event_target:kpp_african_province_to_settle_3 = {
			th_colonize_province_for_country = {
				who = ROOT
			}
		}

		ai_chance = {
			factor = 1
		}
	}

	#Colonize province 4
	option = {
		name = flavor_kpp.4.d
		goto = kpp_african_province_to_settle_4
		trigger = {
			has_saved_event_target = kpp_african_province_to_settle_4
		}
		event_target:kpp_african_province_to_settle_4 = {
			th_colonize_province_for_country = {
				who = ROOT
			}
		}

		ai_chance = {
			factor = 1
		}
	}

	#Colonize province 5
	option = {
		name = flavor_kpp.4.e
		goto = kpp_african_province_to_settle_5
		trigger = {
			has_saved_event_target = kpp_african_province_to_settle_5
		}
		event_target:kpp_african_province_to_settle_5 = {
			th_colonize_province_for_country = {
				who = ROOT
			}
		}

		ai_chance = {
			factor = 1
		}
	}

	#Nothing to colonize...
	option = {
		name = flavor_kpp.4.f
		trigger = {
			guinea_region = {
				OR = {
					has_port = no
					is_empty = no
				}
				type = all
			}
		}
		guinea_region = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}

		ai_chance = {
			factor = 1
		}
	}
}

# The Tinker Federation
country_event = {
	id = flavor_kpp.5
	title = flavor_kpp.5.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.5.desc
	is_triggered_only = yes

	#A great day for the engineers, inventors and tinkers!
	option = {
		name = flavor_kpp.5.a
		add_government_reform = kpp_the_tinker_federation
		change_innovativeness = 4
		add_adm_power = 50
		add_dip_power = 50
		add_mil_power = 50

		ai_chance = {
			factor = 1
		}
	}
}

# Ivory in Gensokyo
country_event = {
	id = flavor_kpp.6
	title = flavor_kpp.6.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.6.desc
	is_triggered_only = yes
	major = yes
	#The Youkais will love Ivory
	option = {
		name = flavor_kpp.6.a
		change_price = {
			trade_goods = ivory
			key = KPP_GREAT_IVORY_TRADE
			value = 0.5
			duration = -1
		}
		add_mercantilism = 5
		add_years_of_income = 0.25

		ai_chance = {
			factor = 1
		}
	}
}

# The Kappa Coffee
country_event = {
	id = flavor_kpp.7
	title = flavor_kpp.7.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.7.desc
	is_triggered_only = yes
	major = yes
	#The Yamas will love the coffee
	option = {
		name = flavor_kpp.7.a
		change_price = {
			trade_goods = coffee
			key = KPP_COFFEE_OF_AFRICA
			value = 0.5
			duration = -1
		}
		add_mercantilism = 5
		add_years_of_income = 0.25

		ai_chance = {
			factor = 1
		}
	}
}

# Weaponized Australian Wildlife
country_event = {
	id = flavor_kpp.8
	title = flavor_kpp.8.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.8.desc
	is_triggered_only = yes

	#Mount the machine guns on the super spiders!
	option = {
		name = flavor_kpp.8.a
		change_innovativeness = 4
		add_republican_tradition = 10
		kpp_unlock_gadget = {
			gadget = weaponized_wildlife
		}
		kpp_apply_gadget = {
			gadget = weaponized_wildlife
			duration = 7300
		}

		ai_chance = {
			factor = 1
		}
	}
}

# Integration of Yumemi's technology
country_event = {
	id = flavor_kpp.9
	title = flavor_kpp.9.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.9.desc
	is_triggered_only = yes

	#Astounding!
	option = {
		name = flavor_kpp.9.a
		change_innovativeness = 4
		add_republican_tradition = 10
		kpp_unlock_gadget = {
			gadget = aerial_torpedo
		}
		kpp_apply_gadget = {
			gadget = aerial_torpedo
			duration = 7300
		}

		ai_chance = {
			factor = 1
		}
	}
}

# Integration of Rika's technology
country_event = {
	id = flavor_kpp.10
	title = flavor_kpp.10.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.10.desc
	is_triggered_only = yes

	#Astounding!
	option = {
		name = flavor_kpp.10.a
		change_innovativeness = 4
		add_republican_tradition = 10
		kpp_unlock_gadget = {
			gadget = kappa_tanks
		}
		kpp_apply_gadget = {
			gadget = kappa_tanks
			duration = 7300
		}

		ai_chance = {
			factor = 1
		}
	}
}

# Invention of the Kappa Cybernetics
country_event = {
	id = flavor_kpp.11
	title = flavor_kpp.11.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.11.desc
	is_triggered_only = yes

	#Astounding!
	option = {
		name = flavor_kpp.11.a
		change_innovativeness = 4
		add_republican_tradition = 10
		kpp_unlock_gadget = {
			gadget = kappa_cybernetics
		}
		kpp_apply_gadget = {
			gadget = kappa_cybernetics
			duration = 7300
		}

		ai_chance = {
			factor = 1
		}
	}
}

# The technology of the future
country_event = {
	id = flavor_kpp.12
	title = flavor_kpp.12.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.12.desc
	is_triggered_only = yes

	#Astounding!
	option = {
		name = flavor_kpp.12.a
		change_innovativeness = 4
		add_republican_tradition = 10
		kpp_unlock_gadget = {
			gadget = fly_sanpei_fight
		}
		kpp_apply_gadget = {
			gadget = fly_sanpei_fight
			duration = 7300
		}

		ai_chance = {
			factor = 1
		}
	}
}

# Creation of the Hisoutensoku
country_event = {
	id = flavor_kpp.13
	title = flavor_kpp.13.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.13.desc
	is_triggered_only = yes

	#You utter fool! Kappa science is the best in the world!
	option = {
		name = flavor_kpp.13.a
		change_innovativeness = 10
		add_prestige = 50
		kpp_unlock_gadget = {
			gadget = hisoutensoku
		}
		kpp_apply_gadget = {
			gadget = hisoutensoku
			duration = 7300
		}
		th_unlock_mercenary_company = {
			mercenary_company = merc_th_hisoutensoku
		}

		ai_chance = {
			factor = 1
		}
	}
}

#Random Innovativeness events

# Nitori gadget
country_event = {
	id = flavor_kpp.20
	title = flavor_kpp.20.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.20.desc
	is_triggered_only = yes
	trigger = {
		has_dlc = "Rule Britannia"
		has_government_attribute = th_passive_innovativeness
		NOT = { has_country_modifier = th_nitori_gadgets_modifier }
	}
	mean_time_to_happen = {
		days = 1
	}

	#
	option = {
		name = flavor_kpp.20.a
		change_innovativeness = 2
		add_country_modifier = {
			name = th_nitori_gadgets_modifier
			duration = 1825
		}

		ai_chance = {
			factor = 1
		}
	}
}

# Takane gadget
country_event = {
	id = flavor_kpp.21
	title = flavor_kpp.21.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.21.desc
	is_triggered_only = yes
	trigger = {
		has_dlc = "Rule Britannia"
		has_government_attribute = th_passive_innovativeness
		NOT = { has_country_modifier = th_takane_production_modifier }
	}
	mean_time_to_happen = {
		days = 1
	}

	#
	option = {
		name = flavor_kpp.21.a
		change_innovativeness = 2
		add_country_modifier = {
			name = th_takane_production_modifier
			duration = 1825
		}

		ai_chance = {
			factor = 1
		}
	}
}

# Yumemi's scientific breakthrough
country_event = {
	id = flavor_kpp.22
	title = flavor_kpp.22.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.22.desc
	is_triggered_only = yes
	trigger = {
		has_dlc = "Rule Britannia"
		has_government_attribute = th_passive_innovativeness
		NOT = { has_country_modifier = th_yumemi_robots_modifier }
	}
	mean_time_to_happen = {
		days = 1
	}

	#
	option = {
		name = flavor_kpp.22.a
		change_innovativeness = 2
		add_country_modifier = {
			name = th_yumemi_robots_modifier
			duration = 1825
		}

		ai_chance = {
			factor = 1
		}
	}
}

# Rika tank development
country_event = {
	id = flavor_kpp.23
	title = flavor_kpp.23.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.23.desc
	is_triggered_only = yes
	trigger = {
		has_dlc = "Rule Britannia"
		has_government_attribute = th_passive_innovativeness
		NOT = { has_country_modifier = th_rika_tanks_modifier }
	}
	mean_time_to_happen = {
		days = 1
	}

	#
	option = {
		name = flavor_kpp.23.a
		change_innovativeness = 2
		add_country_modifier = {
			name = th_rika_tanks_modifier
			duration = 1825
		}

		ai_chance = {
			factor = 1
		}
	}
}

#Kappa Rebellions on elections / new rulers

# Kappa Rebellion
country_event = {
	id = flavor_kpp.30
	title = flavor_kpp.30.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.30.desc
	is_triggered_only = yes
	trigger = {
		has_government_attribute = th_has_kappa_rebels
		NOT = { has_ruler_modifier = th_elected_kappa_tinker }
		NOT = { has_country_modifier = kpp_overcame_counter_movement_disaster }
		ai = no	#Too dificult for the AI too handle probably
	}
	goto = th_kappa_rebellion_province
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					is_overseas = no
				}
				save_event_target_as = th_kappa_rebellion_province
			}
		}
	}

	#Cursed
	option = {
		name = flavor_kpp.30.a
		event_target:th_kappa_rebellion_province = {
			tooltip = {
				spawn_rebels = {
					size = 1
					type = th_kappa_rebels
				}
			}
			hidden_effect = {
				random_list = {
					1 = {
						spawn_rebels = {
							size = 1
							type = th_kappa_rebels
						}
					}
					1 = {
						spawn_rebels = {
							size = 1
							type = th_kappa_rebels
							female = yes
						}
					}
				}
			}
		}

		ai_chance = {
			factor = 1
		}
	}
}

#Kappa Anti-Centralization events

# Start of the Reforms
country_event = {
	id = flavor_kpp.40
	title = flavor_kpp.40.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.40.desc
	is_triggered_only = yes

	#The reforms need to be done. Better be it quick and painful than too slow.
	option = {
		name = flavor_kpp.40.a
		custom_tooltip = flavor_kpp.40.a.tt
		set_country_flag = kpp_unlock_kappa_counter_movement_disaster_decision
		change_government_reform_progress = 100
		
		ai_chance = {
			factor = 0
		}
	}
}

# Kappa Counter Movement - Start
country_event = {
	id = flavor_kpp.41
	title = flavor_kpp.41.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.41.desc
	is_triggered_only = yes
	major = yes
	goto = th_kappa_rebellion_province
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					is_overseas = no
				}
				save_event_target_as = th_kappa_rebellion_province
				spawn_rebels = {
					type = th_kappa_rebels
					size = 1
					female = yes
				}
				change_controller = REB
			}
			set_country_flag = active_kappa_counter_movement_disaster
		}
	}

	#If you are not for the reforms then you are an enemy of the state!
	option = {
		name = flavor_kpp.41.a
		add_stability = -3
		add_republican_tradition = -5
		every_owned_province = {
			add_local_autonomy = 5
		}
		event_target:th_kappa_rebellion_province = {
			tooltip = {
				spawn_rebels = {
					type = th_kappa_rebels
					size = 1
				}
			}
		}
		
		ai_chance = {
			factor = 100
		}
	}
}

# Kappa Counter Movement - End
country_event = {
	id = flavor_kpp.42
	title = flavor_kpp.42.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.42.desc
	is_triggered_only = yes
	major = yes
	immediate = {
		hidden_effect = {
			set_country_flag = kpp_had_counter_movement_disaster
		}
	}

	#If you are not for the reforms then you are an enemy of the state!
	option = {
		name = flavor_kpp.42.a
		change_government_reform_progress = 200
		change_innovativeness = 10
		add_stability_or_adm_power = yes
		if = {
			limit = {
				NOT = { has_ruler_flag = touhou_original_ruler }
			}
			define_ruler = {
				name = "Nitori"
				dynasty = "Kawashiro"
				age = 20
				adm = 6
				dip = 6
				mil = 6
				female = yes
			}
			hidden_effect = {
				add_ruler_personality = immortal_personality
				set_ruler_flag = touhou_character_ruler
				set_ruler_flag = touhou_original_ruler
				set_variable = {
					which = election_term
					value = 1
				}
			}
			add_ruler_modifier = {
				name = th_elected_kappa_tinker
				duration = -1
			}
		}
		else = {
			add_ruler_modifier = {
				name = th_elected_kappa_tinker
				duration = -1
			}
			change_adm = 1
			change_dip = 1
			change_mil = 1
		}
		add_country_modifier = {
			name = kpp_overcame_counter_movement_disaster
			duration = -1
		}
		
		ai_chance = {
			factor = 100
		}
	}
}

# Anti Teamwork Coalition - Start
country_event = {
	id = flavor_kpp.43
	title = flavor_kpp.43.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.43.desc
	is_triggered_only = yes
	major = yes
	immediate = {
		hidden_effect = { set_country_flag = active_kappa_anti_teamwork_coalition_disaster }
	}

	#If you are not for the reforms then you are an enemy of the state!
	option = {
		name = flavor_kpp.43.a
		add_stability = -3
		add_years_of_income = -5
		
		ai_chance = {
			factor = 100
		}
	}
}

# Anti Teamwork Coalition - End
country_event = {
	id = flavor_kpp.44
	title = flavor_kpp.44.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.44.desc
	is_triggered_only = yes
	major = yes
	immediate = {
		hidden_effect = {
			set_country_flag = kpp_had_anti_teamwork_coalition_disaster
		}
	}

	#If you are not for the reforms then you are an enemy of the state!
	option = {
		name = flavor_kpp.44.a
		change_government_reform_progress = 200
		change_innovativeness = 10
		add_stability_or_adm_power = yes
		if = {
			limit = {
				NOT = { has_ruler_flag = touhou_original_ruler }
			}
			define_ruler = {
				name = "Nitori"
				dynasty = "Kawashiro"
				age = 20
				adm = 6
				dip = 6
				mil = 6
				female = yes
			}
			hidden_effect = {
				add_ruler_personality = immortal_personality
				set_ruler_flag = touhou_character_ruler
				set_ruler_flag = touhou_original_ruler
				set_variable = {
					which = election_term
					value = 1
				}
			}
			add_ruler_modifier = {
				name = th_elected_kappa_tinker
				duration = -1
			}
		}
		else = {
			add_ruler_modifier = {
				name = th_elected_kappa_tinker
				duration = -1
			}
			change_adm = 1
			change_dip = 1
			change_mil = 1
		}
		add_country_modifier = {
			name = kpp_overcame_anti_teamwork_disaster
			duration = -1
		}
		
		ai_chance = {
			factor = 100
		}
	}
}

# Kappa Guild Wars - Start
country_event = {
	id = flavor_kpp.45
	title = flavor_kpp.45.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.45.desc
	is_triggered_only = yes
	major = yes
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					is_overseas = no
				}
				save_event_target_as = th_super_capitalists_province
			}
			random_owned_province = {
				limit = {
					is_overseas = no
				}
				save_event_target_as = th_explosion_enjoyers_province
			}
			random_owned_province = {
				limit = {
					is_overseas = no
				}
				save_event_target_as = th_independent_marines_province
			}
			set_country_flag = active_kappa_guild_wars_disaster
		}
	}

	#Support the th_super_capitalists faction
	option = {
		name = flavor_kpp.45.a
		custom_tooltip = flavor_kpp.45.a.tt
		define_ruler = {
			adm = 2
			dynasty = "of the Super Capitalists"
			hide_skills = yes
			female = yes
			claim = 50
		}
		add_stability = -3
		set_ruler_flag = kpp_super_capitalists_in_power
		add_ruler_modifier = {
			name = kpp_super_capitalists_in_power_modifier
			duration = 1825
		}
		event_target:th_explosion_enjoyers_province = {
			spawn_rebels = {
				type = th_explosion_enjoyers
				size = 2
			}
		}
		event_target:th_independent_marines_province = {
			spawn_rebels = {
				type = th_independent_marines
				size = 2
			}
		}
		
		ai_chance = {
			factor = 100
		}
	}

	#Support the th_explosion_enjoyers faction
	option = {
		name = flavor_kpp.45.b
		custom_tooltip = flavor_kpp.45.b.tt
		define_ruler = {
			dip = 2
			dynasty = "Explosion-Enjoyers"
			hide_skills = yes
			female = yes
			claim = 50
		}
		add_stability = -3
		set_ruler_flag = kpp_explosion_enjoyers_in_power
		add_ruler_modifier = {
			name = kpp_explosion_enjoyers_in_power_modifier
			duration = 1825
		}
		event_target:th_super_capitalists_province = {
			spawn_rebels = {
				type = th_super_capitalists
				size = 2
			}
		}
		event_target:th_independent_marines_province = {
			spawn_rebels = {
				type = th_independent_marines
				size = 2
			}
		}
		
		ai_chance = {
			factor = 100
		}
	}

	#Support the th_independent_marines faction
	option = {
		name = flavor_kpp.45.c
		custom_tooltip = flavor_kpp.45.c.tt
		define_ruler = {
			mil = 2
			dynasty = "Kappamander"
			hide_skills = yes
			female = yes
			claim = 50
		}
		add_stability = -3
		set_ruler_flag = kpp_independent_marines_in_power
		add_ruler_modifier = {
			name = kpp_independent_marines_in_power_modifier
			duration = 1825
		}
		event_target:th_super_capitalists_province = {
			spawn_rebels = {
				type = th_super_capitalists
				size = 2
			}
		}
		event_target:th_explosion_enjoyers_province = {
			spawn_rebels = {
				type = th_explosion_enjoyers
				size = 2
			}
		}
		
		ai_chance = {
			factor = 100
		}
	}

	#If you are not for the reforms then you are an enemy of the state!
	option = {
		name = flavor_kpp.45.d
		add_stability = -6
		event_target:th_super_capitalists_province = {
			spawn_rebels = {
				type = th_super_capitalists
				size = 2
			}
		}
		event_target:th_explosion_enjoyers_province = {
			spawn_rebels = {
				type = th_explosion_enjoyers
				size = 2
			}
		}
		event_target:th_independent_marines_province = {
			spawn_rebels = {
				type = th_independent_marines
				size = 2
			}
		}
		
		ai_chance = {
			factor = 100
		}
	}
}

# Kappa Guild Wars - End
country_event = {
	id = flavor_kpp.46
	title = flavor_kpp.46.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.46.desc
	is_triggered_only = yes
	major = yes
	immediate = {
		hidden_effect = {
			set_country_flag = kpp_had_guild_wars_disaster
		}
	}

	#If you are not for the reforms then you are an enemy of the state!
	option = {
		name = flavor_kpp.46.a
		change_government_reform_progress = 200
		change_innovativeness = 10
		add_stability_or_adm_power = yes
		if = {
			limit = {
				NOT = { has_ruler_flag = touhou_original_ruler }
			}
			define_ruler = {
				name = "Nitori"
				dynasty = "Kawashiro"
				age = 20
				adm = 6
				dip = 6
				mil = 6
				female = yes
			}
			hidden_effect = {
				add_ruler_personality = immortal_personality
				set_ruler_flag = touhou_character_ruler
				set_ruler_flag = touhou_original_ruler
				set_variable = {
					which = election_term
					value = 1
				}
			}
			add_ruler_modifier = {
				name = th_elected_kappa_tinker
				duration = -1
			}
		}
		else = {
			add_ruler_modifier = {
				name = th_elected_kappa_tinker
				duration = -1
			}
			change_adm = 1
			change_dip = 1
			change_mil = 1
		}
		add_country_modifier = {
			name = kpp_overcame_guild_wars_disaster
			duration = -1
		}
		
		ai_chance = {
			factor = 100
		}
	}
}

#Random Disaster events - Kappa Counter Movement
# Province demands more autonomy!
country_event = {
	id = flavor_kpp.47
	title = flavor_kpp.47.t
	desc = flavor_kpp.47.desc
	picture = NITORIBOSS_eventPicture	#TODO
	trigger = {
		num_of_cities = 2
	}	
	is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = { is_capital = no }
				save_event_target_as = kpp_autonomy_province
			}
		}
	}
	goto = kpp_autonomy_province
	#Allow them some autonomy
	option = {
		name = flavor_kpp.47.a
		event_target:kpp_autonomy_province = {
			add_local_autonomy = 15
		}
		ai_chance = { factor = 10 }
	}
	#No
	option = {
		name = flavor_kpp.47.a
		event_target:kpp_autonomy_province = {
			spawn_rebels = {
				type = th_kappa_rebels
				size = 1
			}
		}
		ai_chance = { factor = 10 }
	}
}
# Question of Authority
country_event = {
	id = flavor_kpp.48
	title = flavor_kpp.48.t
	desc = flavor_kpp.48.desc
	picture = NITORIBOSS_eventPicture	#TODO
	trigger = {
		NOT = { has_ruler_modifier = th_elected_kappa_tinker }
	}	
	is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}	
	# Defend your position
	option = {
		name = flavor_kpp.48.a
		add_republican_tradition = -10
		ai_chance = { factor = 10 }
	}
	# Silence them
	option = {
		name = flavor_kpp.48.b
		add_yearly_manpower = -1
		ai_chance = { factor = 10 }
	}
}
# Overreaction from Conservative Kappas
country_event = {
	id = flavor_kpp.49
	title = flavor_kpp.49.t
	desc = flavor_kpp.49.desc
	picture = NITORIBOSS_eventPicture	#TODO
	trigger = {
		NOT = { stability = -3 }
	}	
	is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}
	option = {
		name = flavor_kpp.49.a
		add_stability = -1
		ai_chance = { factor = 10 }
	}
	option = {
		name = flavor_kpp.49.b
		add_republican_tradition = -10
		ai_chance = { factor = 10 }
	}
}

#Random Disaster events - Anti Teamwork Coalition
# Sabotage at factory
country_event = {
	id = flavor_kpp.50
	title = flavor_kpp.50.t
	desc = flavor_kpp.50.desc
	picture = NITORIBOSS_eventPicture	#TODO
	trigger = {
		num_of_cities = 2
		any_owned_province = {
			is_capital = no
			NOT = { has_province_modifier = kpp_factory_sabotage }
		}
	}	
	is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = { 
					is_capital = no
					NOT = { has_province_modifier = kpp_factory_sabotage }
				}
				save_event_target_as = kpp_autonomy_province
			}
		}
	}

	option = {	#Oh well
		name = flavor_kpp.50.a
		goto = kpp_autonomy_province
		event_target:kpp_autonomy_province = {
			add_province_modifier = {
				name = kpp_factory_sabotage
				duration = 730
			}
			add_devastation = 25
		}
		ai_chance = { factor = 10 }
	}

	option = {	#Repair the damage asap
		name = flavor_kpp.50.b
		add_years_of_income = -0.25
		ai_chance = { factor = 10 }
	}
}
# Plundering of the Treasury
country_event = {
	id = flavor_kpp.51
	title = flavor_kpp.51.t
	desc = flavor_kpp.51.desc
	picture = NITORIBOSS_eventPicture	#TODO
	is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}	
	option = {	#Print more money!
		name = flavor_kpp.51.a
		add_inflation = 2
		ai_chance = { factor = 10 }
	}
	option = {	#We will have to live with that
		name = flavor_kpp.51.b
		add_years_of_income = -0.5
		ai_chance = { factor = 10 }
	}
}
# Bribery amongst the state officials
country_event = {
	id = flavor_kpp.52
	title = flavor_kpp.52.t
	desc = flavor_kpp.52.desc
	picture = NITORIBOSS_eventPicture	#TODO
	is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}	
	option = {	#Ignore it
		name = flavor_kpp.52.a
		add_corruption = 3
		ai_chance = { factor = 10 }
	}
	option = {	#Expel the corrupt officials
		name = flavor_kpp.52.b
		add_stability = -1
		ai_chance = { factor = 10 }
	}
}

#Random Disaster events - Guild Wars
# The Super Capitalists try a coup
country_event = {
	id = flavor_kpp.53
	title = flavor_kpp.53.t
	desc = flavor_kpp.53.desc
	picture = NITORIBOSS_eventPicture	#TODO
	trigger = {
		NOT = { has_ruler_flag = kpp_super_capitalists_in_power }
	}	
	is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}	
	immediate = {
		add_corruption = 1
	}
	option = {	#Defend the government from th_super_capitalists
		name = flavor_kpp.53.a
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 4
				type = th_super_capitalists
			}
		}
		ai_chance = { factor = 10 }
	}
	option = {
		name = flavor_kpp.53.b
		define_ruler = {
			adm = 2
			dynasty = "of the Super Capitalists"
			hide_skills = yes
			female = yes
			claim = 50
		}
		add_ruler_modifier = {
			name = kpp_super_capitalists_in_power_modifier
			duration = 1825
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 1
				type = th_super_capitalists
			}
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 1
				type = th_super_capitalists
			}
		}
		ai_chance = { factor = 10 }
	}
	option = {	#Get Nitori in power! NOW!
		name = flavor_kpp.53.c
		trigger = {
			NOT = { has_ruler_flag = touhou_original_ruler }
		}
		if = {
			limit = { NOT = { has_ruler_flag = touhou_original_ruler } }
			define_ruler = {
				name = "Nitori"
				dynasty = "Kawashiro"
				age = 20
				adm = 6
				dip = 5
				mil = 3
				female = yes
			}
			hidden_effect = {
				add_ruler_personality = immortal_personality
				set_ruler_flag = touhou_character_ruler
				set_ruler_flag = touhou_original_ruler
				set_variable = {
					which = election_turn
					value = 1
				}
			}
		}
		else = {
			add_adm_power = 10
			add_dip_power = 10
			add_mil_power = 10
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_super_capitalists
			}
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_explosion_enjoyers
			}
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_independent_marines
			}
		}
		ai_chance = { factor = 10 }
	}
	option = {	#Get Nitori in power! NOW!
		name = flavor_kpp.53.d
		trigger = {
			has_ruler_flag = touhou_original_ruler
		}
		if = {
			limit = { NOT = { has_ruler_flag = touhou_original_ruler } }
			define_ruler = {
				name = "Nitori"
				dynasty = "Kawashiro"
				age = 20
				adm = 6
				dip = 5
				mil = 3
				female = yes
			}
			hidden_effect = {
				add_ruler_personality = immortal_personality
				set_ruler_flag = touhou_character_ruler
				set_ruler_flag = touhou_original_ruler
				set_variable = {
					which = election_turn
					value = 1
				}
			}
		}
		else = {
			add_adm_power = 10
			add_dip_power = 10
			add_mil_power = 10
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_super_capitalists
			}
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_explosion_enjoyers
			}
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_independent_marines
			}
		}
		ai_chance = { factor = 10 }
	}
}
# The Eplosion-Enjoyers strike
country_event = {
	id = flavor_kpp.54
	title = flavor_kpp.54.t
	desc = flavor_kpp.54.desc
	picture = NITORIBOSS_eventPicture	#TODO
	trigger = {
		NOT = { has_ruler_flag = kpp_explosion_enjoyers_in_power }
	}	
	is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}	
	immediate = {
		random_owned_province = {
			add_devastation = 50
		}
		random_owned_province = {
			add_devastation = 50
		}
	}
	option = {	#Defend the government from th_explosion_enjoyers
		name = flavor_kpp.54.a
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 4
				type = th_explosion_enjoyers
			}
		}
		ai_chance = { factor = 10 }
	}
	option = {
		name = flavor_kpp.54.b
		define_ruler = {
			dip = 2
			dynasty = "Explosion-Enjoyers"
			hide_skills = yes
			female = yes
			claim = 50
		}
		add_ruler_modifier = {
			name = kpp_explosion_enjoyers_in_power_modifier
			duration = 1825
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 1
				type = th_explosion_enjoyers
			}
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 1
				type = th_explosion_enjoyers
			}
		}
		ai_chance = { factor = 10 }
	}
	option = {	#Get Nitori in power! NOW!
		name = flavor_kpp.54.c
		trigger = {
			NOT = { has_ruler_flag = touhou_original_ruler }
		}
		if = {
			limit = { NOT = { has_ruler_flag = touhou_original_ruler } }
			define_ruler = {
				name = "Nitori"
				dynasty = "Kawashiro"
				age = 20
				adm = 6
				dip = 5
				mil = 3
				female = yes
			}
			hidden_effect = {
				add_ruler_personality = immortal_personality
				set_ruler_flag = touhou_character_ruler
				set_ruler_flag = touhou_original_ruler
				set_variable = {
					which = election_turn
					value = 1
				}
			}
		}
		else = {
			add_adm_power = 10
			add_dip_power = 10
			add_mil_power = 10
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_super_capitalists
			}
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_explosion_enjoyers
			}
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_independent_marines
			}
		}
		ai_chance = { factor = 10 }
	}
	option = {	#Get Nitori in power! NOW!
		name = flavor_kpp.54.d
		trigger = {
			has_ruler_flag = touhou_original_ruler
		}
		if = {
			limit = { NOT = { has_ruler_flag = touhou_original_ruler } }
			define_ruler = {
				name = "Nitori"
				dynasty = "Kawashiro"
				age = 20
				adm = 6
				dip = 5
				mil = 3
				female = yes
			}
			hidden_effect = {
				add_ruler_personality = immortal_personality
				set_ruler_flag = touhou_character_ruler
				set_ruler_flag = touhou_original_ruler
				set_variable = {
					which = election_turn
					value = 1
				}
			}
		}
		else = {
			add_adm_power = 10
			add_dip_power = 10
			add_mil_power = 10
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_super_capitalists
			}
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_explosion_enjoyers
			}
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_independent_marines
			}
		}
		ai_chance = { factor = 10 }
	}
}
# Force of Independent Marines rise up
country_event = {
	id = flavor_kpp.55
	title = flavor_kpp.55.t
	desc = flavor_kpp.55.desc
	picture = NITORIBOSS_eventPicture	#TODO
	trigger = {
		NOT = { has_ruler_flag = kpp_independent_marines_in_power }
	}	
	is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}	
	immediate = {
		add_stability = -1
	}
	option = {	#Defend the government from th_independent_marines
		name = flavor_kpp.55.a
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 4
				type = th_independent_marines
			}
		}
		ai_chance = { factor = 10 }
	}
	option = {
		name = flavor_kpp.55.b
		define_ruler = {
			mil = 2
			dynasty = "Kappamander"
			hide_skills = yes
			female = yes
			claim = 50
		}
		add_ruler_modifier = {
			name = kpp_independent_marines_in_power_modifier
			duration = 1825
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 1
				type = th_independent_marines
			}
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 1
				type = th_independent_marines
			}
		}
		ai_chance = { factor = 10 }
	}
	option = {	#Get Nitori in power! NOW!
		name = flavor_kpp.55.c
		trigger = {
			NOT = { has_ruler_flag = touhou_original_ruler }
		}
		if = {
			limit = { NOT = { has_ruler_flag = touhou_original_ruler } }
			define_ruler = {
				name = "Nitori"
				dynasty = "Kawashiro"
				age = 20
				adm = 6
				dip = 5
				mil = 3
				female = yes
			}
			hidden_effect = {
				add_ruler_personality = immortal_personality
				set_ruler_flag = touhou_character_ruler
				set_ruler_flag = touhou_original_ruler
				set_variable = {
					which = election_turn
					value = 1
				}
			}
		}
		else = {
			add_adm_power = 10
			add_dip_power = 10
			add_mil_power = 10
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_super_capitalists
			}
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_explosion_enjoyers
			}
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_independent_marines
			}
		}
		ai_chance = { factor = 10 }
	}
	option = {	#Get Nitori in power! NOW!
		name = flavor_kpp.55.d
		trigger = {
			has_ruler_flag = touhou_original_ruler
		}
		if = {
			limit = { NOT = { has_ruler_flag = touhou_original_ruler } }
			define_ruler = {
				name = "Nitori"
				dynasty = "Kawashiro"
				age = 20
				adm = 6
				dip = 5
				mil = 3
				female = yes
			}
			hidden_effect = {
				add_ruler_personality = immortal_personality
				set_ruler_flag = touhou_character_ruler
				set_ruler_flag = touhou_original_ruler
				set_variable = {
					which = election_turn
					value = 1
				}
			}
		}
		else = {
			add_adm_power = 10
			add_dip_power = 10
			add_mil_power = 10
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_super_capitalists
			}
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_explosion_enjoyers
			}
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				size = 2
				type = th_independent_marines
			}
		}
		ai_chance = { factor = 10 }
	}
}

#Special Election - Elect Nitori into office
country_event = {
	id = flavor_kpp.56
	title = flavor_kpp.56.t
	desc = flavor_kpp.56.desc
	picture = NITORIBOSS_eventPicture	#TODO
	trigger = {
	}	
	is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}	
	option = {
		name = flavor_kpp.56.a
		define_ruler = {
			name = "Nitori"
			dynasty = "Kawashiro"
			age = 20
			adm = 6
			dip = 6
			mil = 6
			female = yes
		}
		hidden_effect = {
			add_ruler_personality = immortal_personality
			set_ruler_flag = touhou_character_ruler
			set_ruler_flag = touhou_original_ruler
			set_variable = {
				which = election_term
				value = 1
			}
		}
		add_ruler_modifier = {
			name = th_elected_kappa_tinker
			duration = -1
		}
		ai_chance = { factor = 10 }
	}
}

# First Major Reform
country_event = {
	id = flavor_kpp.57
	title = flavor_kpp.57.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.57.desc
	is_triggered_only = yes

	#If you are not for the reforms then you are an enemy of the state!
	option = {
		name = flavor_kpp.57.a
		custom_tooltip = flavor_kpp.57.a.tt
		add_country_modifier = {
			name = kpp_first_major_reform
			duration = -1
		}
		hidden_effect = {
			change_variable = {
				which = max_election_term
				value = 1
			}
		}
		
		ai_chance = {
			factor = 1
		}
	}
}

# Second Major Reform
country_event = {
	id = flavor_kpp.58
	title = flavor_kpp.58.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.58.desc
	is_triggered_only = yes

	#If you are not for the reforms then you are an enemy of the state!
	option = {
		name = flavor_kpp.58.a
		custom_tooltip = flavor_kpp.58.a.tt
		add_country_modifier = {
			name = kpp_second_major_reform
			duration = -1
		}
		hidden_effect = {
			change_variable = {
				which = max_election_term
				value = 1
			}
		}
		
		ai_chance = {
			factor = 1
		}
	}
}

# Third Major Reform
country_event = {
	id = flavor_kpp.59
	title = flavor_kpp.59.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.59.desc
	is_triggered_only = yes

	#If you are not for the reforms then you are an enemy of the state!
	option = {
		name = flavor_kpp.59.a
		add_country_modifier = {
			name = kpp_third_major_reform
			duration = -1
		}
		hidden_effect = {
			change_variable = {
				which = max_election_term
				value = 1
			}
		}
		
		ai_chance = {
			factor = 1
		}
	}
}

#Absolute Tinker Republic events
# Establishment of the United Tinker Republic
country_event = {
	id = flavor_kpp.60
	title = flavor_kpp.60.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.60.desc
	is_triggered_only = yes

	#If you are not for the reforms then you are an enemy of the state!
	option = {
		name = flavor_kpp.60.a
		remove_country_modifier = th_elected_kappa_tinker
		add_government_reform = Gensokyan_kpp_united_kappa_republic
		add_republican_tradition = 100
		
		ai_chance = {
			factor = 1
		}
	}
}

# Tinker Contest!
country_event = {
	id = flavor_kpp.61
	title = flavor_kpp.61.t
	picture = NITORIBOSS_eventPicture	#TODO
	desc = flavor_kpp.61.desc
	
	is_triggered_only = yes
	
	trigger = {
		has_government_attribute = th_has_tinker_contests
	}
	immediate = {
		hidden_effect = {
			remove_country_modifier = th_administrative_tinker
			remove_country_modifier = th_diplomatic_tinker
			remove_country_modifier = th_military_tinker
			remove_country_modifier = th_allrounder_tinker
		}
	}

	option = {	#Choose the administrative tinker
		name = flavor_kpp.61.a
		add_ruler_modifier = {
			name = th_administrative_tinker
			duration = -1
		}
		add_scaled_republican_tradition = -15
		add_adm_power = 60
		change_innovativeness = 1
		ai_chance = { 
			factor = 1
		}
	}

	option = {	#Choose the diplomatic tinker
		name = flavor_kpp.61.b
		add_ruler_modifier = {
			name = th_diplomatic_tinker
			duration = -1
		}
		add_scaled_republican_tradition = -15
		add_dip_power = 60
		change_innovativeness = 1
		ai_chance = { 
			factor = 1
		}
	}

	option = {	#Choose the military tinker
		name = flavor_kpp.61.c
		add_ruler_modifier = {
			name = th_military_tinker
			duration = -1
		}
		add_scaled_republican_tradition = -15
		add_mil_power = 60
		change_innovativeness = 1
		ai_chance = { 
			factor = 1
		}
	}

	option = {	#Choose the allrounder tinker
		name = flavor_kpp.61.d
		add_ruler_modifier = {
			name = th_allrounder_tinker
			duration = -1
		}
		add_scaled_republican_tradition = -15
		add_adm_power = 20
		add_dip_power = 20
		add_mil_power = 20
		change_innovativeness = 1
		ai_chance = { 
			factor = 1
		}
	}

	option = {	#Let the public decide
		name = flavor_kpp.61.e
		random_list = {
			1 = {
				add_ruler_modifier = {
					name = th_administrative_tinker
					duration = -1
				}
				add_adm_power = 60
			}
			1 = {
				add_ruler_modifier = {
					name = th_diplomatic_tinker
					duration = -1
				}
				add_dip_power = 60
			}
			1 = {
				add_ruler_modifier = {
					name = th_military_tinker
					duration = -1
				}
				add_mil_power = 60
			}
			1 = {
				add_ruler_modifier = {
					name = th_allrounder_tinker
					duration = -1
				}
				add_adm_power = 20
				add_dip_power = 20
				add_mil_power = 20
			}
		}
		change_innovativeness = 1
		ai_chance = { 
			factor = 1
		}
	}

	option = {	#Participate yourself in it
		name = flavor_kpp.61.f
		add_scaled_republican_tradition = 5
		add_adm_power = 33
		add_dip_power = 33
		add_mil_power = 33
		change_innovativeness = 5
		ai_chance = { 
			factor = 1
		}
	}
}

# Election! - Death
country_event = {
	id = flavor_kpp.62
	title = flavor_kpp.62.t
	desc = flavor_kpp.62.desc
	picture = NITORIBOSS_eventPicture	#TODO
	
	is_triggered_only = yes
	
	trigger = {
		has_government_attribute = th_has_kappa_elections
	}
	
	#Elect Nitori
	option = {
		name = flavor_kpp.62.a
		ai_chance = { factor = 40 }
		define_ruler = {
			name = "Nitori"
			dynasty = "Kawashiro"
			age = 20
			adm = 6
			dip = 6
			mil = 6
			female = yes
		}
		hidden_effect = {
			add_ruler_personality = immortal_personality
			set_ruler_flag = touhou_character_ruler
			set_ruler_flag = touhou_original_ruler
			set_variable = {
				which = election_term
				value = 1
			}
		}
	}
}